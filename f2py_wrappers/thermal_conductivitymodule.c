/* File: thermal_conductivitymodule.c
 * This file is auto-generated with f2py (version:1.26.4).
 * f2py is a Fortran to Python Interface Generator (FPIG), Second Edition,
 * written by Pearu Peterson <pearu@cens.ioc.ee>.
 * Generation date: Fri Sep 12 13:28:40 2025
 * Do not edit this file directly unless you know what you are doing!!!
 */

#ifdef __cplusplus
extern "C" {
#endif

#ifndef PY_SSIZE_T_CLEAN
#define PY_SSIZE_T_CLEAN
#endif /* PY_SSIZE_T_CLEAN */

/* Unconditionally included */
#include <Python.h>
#include <numpy/npy_os.h>

/*********************** See f2py2e/cfuncs.py: includes ***********************/
#include "fortranobject.h"
#include <math.h>

/**************** See f2py2e/rules.py: mod_rules['modulebody'] ****************/
static PyObject *thermal_conductivity_error;
static PyObject *thermal_conductivity_module;

/*********************** See f2py2e/cfuncs.py: typedefs ***********************/
typedef struct {double r,i;} complex_double;

/****************** See f2py2e/cfuncs.py: typedefs_generated ******************/
/*need_typedefs_generated*/

/********************** See f2py2e/cfuncs.py: cppmacros **********************/

/* See fortranobject.h for definitions. The macros here are provided for BC. */
#define rank f2py_rank
#define shape f2py_shape
#define fshape f2py_shape
#define len f2py_len
#define flen f2py_flen
#define slen f2py_slen
#define size f2py_size


#define CHECKSCALAR(check,tcheck,name,show,var)\
    if (!(check)) {\
        char errstring[256];\
        sprintf(errstring, "%s: "show, "("tcheck") failed for "name, var);\
        PyErr_SetString(thermal_conductivity_error,errstring);\
        /*goto capi_fail;*/\
    } else 

#ifdef DEBUGCFUNCS
#define CFUNCSMESS(mess) fprintf(stderr,"debug-capi:"mess);
#define CFUNCSMESSPY(mess,obj) CFUNCSMESS(mess) \
    PyObject_Print((PyObject *)obj,stderr,Py_PRINT_RAW);\
    fprintf(stderr,"\n");
#else
#define CFUNCSMESS(mess)
#define CFUNCSMESSPY(mess,obj)
#endif


#ifndef max
#define max(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef min
#define min(a,b) ((a < b) ? (a) : (b))
#endif
#ifndef MAX
#define MAX(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef MIN
#define MIN(a,b) ((a < b) ? (a) : (b))
#endif


#define CHECKARRAY(check,tcheck,name) \
    if (!(check)) {\
        PyErr_SetString(thermal_conductivity_error,"("tcheck") failed for "name);\
        /*goto capi_fail;*/\
    } else 

#define pyobj_from_complex_double1(v) (PyComplex_FromDoubles(v.r,v.i))

#if defined(PREPEND_FORTRAN)
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F
#else
#define F_FUNC(f,F) _##f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F##_
#else
#define F_FUNC(f,F) _##f##_
#endif
#endif
#else
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F
#else
#define F_FUNC(f,F) f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F##_
#else
#define F_FUNC(f,F) f##_
#endif
#endif
#endif
#if defined(UNDERSCORE_G77)
#define F_FUNC_US(f,F) F_FUNC(f##_,F##_)
#else
#define F_FUNC_US(f,F) F_FUNC(f,F)
#endif


/************************ See f2py2e/cfuncs.py: cfuncs ************************/

static int
double_from_pyobj(double* v, PyObject *obj, const char *errmess)
{
    PyObject* tmp = NULL;
    if (PyFloat_Check(obj)) {
        *v = PyFloat_AsDouble(obj);
        return !(*v == -1.0 && PyErr_Occurred());
    }

    tmp = PyNumber_Float(obj);
    if (tmp) {
        *v = PyFloat_AsDouble(tmp);
        Py_DECREF(tmp);
        return !(*v == -1.0 && PyErr_Occurred());
    }

    if (PyComplex_Check(obj)) {
        PyErr_Clear();
        tmp = PyObject_GetAttrString(obj,"real");
    }
    else if (PyBytes_Check(obj) || PyUnicode_Check(obj)) {
        /*pass*/;
    }
    else if (PySequence_Check(obj)) {
        PyErr_Clear();
        tmp = PySequence_GetItem(obj, 0);
    }

    if (tmp) {
        if (double_from_pyobj(v,tmp,errmess)) {Py_DECREF(tmp); return 1;}
        Py_DECREF(tmp);
    }
    {
        PyObject* err = PyErr_Occurred();
        if (err==NULL) err = thermal_conductivity_error;
        PyErr_SetString(err,errmess);
    }
    return 0;
}


static int
int_from_pyobj(int* v, PyObject *obj, const char *errmess)
{
    PyObject* tmp = NULL;

    if (PyLong_Check(obj)) {
        *v = Npy__PyLong_AsInt(obj);
        return !(*v == -1 && PyErr_Occurred());
    }

    tmp = PyNumber_Long(obj);
    if (tmp) {
        *v = Npy__PyLong_AsInt(tmp);
        Py_DECREF(tmp);
        return !(*v == -1 && PyErr_Occurred());
    }

    if (PyComplex_Check(obj)) {
        PyErr_Clear();
        tmp = PyObject_GetAttrString(obj,"real");
    }
    else if (PyBytes_Check(obj) || PyUnicode_Check(obj)) {
        /*pass*/;
    }
    else if (PySequence_Check(obj)) {
        PyErr_Clear();
        tmp = PySequence_GetItem(obj, 0);
    }

    if (tmp) {
        if (int_from_pyobj(v, tmp, errmess)) {
            Py_DECREF(tmp);
            return 1;
        }
        Py_DECREF(tmp);
    }

    {
        PyObject* err = PyErr_Occurred();
        if (err == NULL) {
            err = thermal_conductivity_error;
        }
        PyErr_SetString(err, errmess);
    }
    return 0;
}


/********************* See f2py2e/cfuncs.py: userincludes *********************/
/*need_userincludes*/

/********************* See f2py2e/capi_rules.py: usercode *********************/


/* See f2py2e/rules.py */
/*eof externroutines*/

/******************** See f2py2e/capi_rules.py: usercode1 ********************/


/******************* See f2py2e/cb_rules.py: buildcallback *******************/
/*need_callbacks*/

/*********************** See f2py2e/rules.py: buildapi ***********************/

/**************************** calculate_lineshapes ****************************/
static char doc_f2py_rout_thermal_conductivity_get_lf_calculate_lineshapes[] = "\
lineshapes = calculate_lineshapes(irrqgrid,qgrid,weights,scatt_events,fc2,r2_2,fc3,r3_2,r3_3,rprim,pos,masses,smear,smear_id,t,gaussian,classical,energies,[ne,nirrqpt,nat,nfc2,nfc3,n_events])\n\nWrapper for ``calculate_lineshapes``.\
\n\nParameters\n----------\n"
"irrqgrid : input rank-2 array('d') with bounds (3,nirrqpt)\n"
"qgrid : input rank-2 array('d') with bounds (3,n_events)\n"
"weights : input rank-1 array('i') with bounds (n_events)\n"
"scatt_events : input rank-1 array('i') with bounds (nirrqpt)\n"
"fc2 : input rank-3 array('d') with bounds (nfc2,3 * nat,3 * nat)\n"
"r2_2 : input rank-2 array('d') with bounds (3,nfc2)\n"
"fc3 : input rank-4 array('d') with bounds (nfc3,3 * nat,3 * nat,3 * nat)\n"
"r3_2 : input rank-2 array('d') with bounds (3,nfc3)\n"
"r3_3 : input rank-2 array('d') with bounds (3,nfc3)\n"
"rprim : input rank-2 array('d') with bounds (3,3)\n"
"pos : input rank-2 array('d') with bounds (3,nat)\n"
"masses : input rank-1 array('d') with bounds (nat)\n"
"smear : input rank-2 array('d') with bounds (3 * nat,nirrqpt)\n"
"smear_id : input rank-2 array('d') with bounds (3 * nat,nirrqpt)\n"
"t : input float\n"
"gaussian : input int\n"
"classical : input int\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"\nOther Parameters\n----------------\n"
"ne : input int, optional\n    Default: shape(energies, 0)\n"
"nirrqpt : input int, optional\n    Default: shape(irrqgrid, 1)\n"
"nat : input int, optional\n    Default: shape(fc2, 1) / 3\n"
"nfc2 : input int, optional\n    Default: shape(fc2, 0)\n"
"nfc3 : input int, optional\n    Default: shape(fc3, 0)\n"
"n_events : input int, optional\n    Default: shape(qgrid, 1)\n"
"\nReturns\n-------\n"
"lineshapes : rank-3 array('d') with bounds (nirrqpt,3 * nat,ne)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_calculate_lineshapes(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,int*,double*,int*,int*,int*,int*,int*,int*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *irrqgrid = NULL;
    npy_intp irrqgrid_Dims[2] = {-1, -1};
    const int irrqgrid_Rank = 2;
    PyArrayObject *capi_irrqgrid_as_array = NULL;
    int capi_irrqgrid_intent = 0;
    PyObject *irrqgrid_capi = Py_None;
    double *qgrid = NULL;
    npy_intp qgrid_Dims[2] = {-1, -1};
    const int qgrid_Rank = 2;
    PyArrayObject *capi_qgrid_as_array = NULL;
    int capi_qgrid_intent = 0;
    PyObject *qgrid_capi = Py_None;
    int *weights = NULL;
    npy_intp weights_Dims[1] = {-1};
    const int weights_Rank = 1;
    PyArrayObject *capi_weights_as_array = NULL;
    int capi_weights_intent = 0;
    PyObject *weights_capi = Py_None;
    int *scatt_events = NULL;
    npy_intp scatt_events_Dims[1] = {-1};
    const int scatt_events_Rank = 1;
    PyArrayObject *capi_scatt_events_as_array = NULL;
    int capi_scatt_events_intent = 0;
    PyObject *scatt_events_capi = Py_None;
    double *fc2 = NULL;
    npy_intp fc2_Dims[3] = {-1, -1, -1};
    const int fc2_Rank = 3;
    PyArrayObject *capi_fc2_as_array = NULL;
    int capi_fc2_intent = 0;
    PyObject *fc2_capi = Py_None;
    double *r2_2 = NULL;
    npy_intp r2_2_Dims[2] = {-1, -1};
    const int r2_2_Rank = 2;
    PyArrayObject *capi_r2_2_as_array = NULL;
    int capi_r2_2_intent = 0;
    PyObject *r2_2_capi = Py_None;
    double *fc3 = NULL;
    npy_intp fc3_Dims[4] = {-1, -1, -1, -1};
    const int fc3_Rank = 4;
    PyArrayObject *capi_fc3_as_array = NULL;
    int capi_fc3_intent = 0;
    PyObject *fc3_capi = Py_None;
    double *r3_2 = NULL;
    npy_intp r3_2_Dims[2] = {-1, -1};
    const int r3_2_Rank = 2;
    PyArrayObject *capi_r3_2_as_array = NULL;
    int capi_r3_2_intent = 0;
    PyObject *r3_2_capi = Py_None;
    double *r3_3 = NULL;
    npy_intp r3_3_Dims[2] = {-1, -1};
    const int r3_3_Rank = 2;
    PyArrayObject *capi_r3_3_as_array = NULL;
    int capi_r3_3_intent = 0;
    PyObject *r3_3_capi = Py_None;
    double *rprim = NULL;
    npy_intp rprim_Dims[2] = {-1, -1};
    const int rprim_Rank = 2;
    PyArrayObject *capi_rprim_as_array = NULL;
    int capi_rprim_intent = 0;
    PyObject *rprim_capi = Py_None;
    double *pos = NULL;
    npy_intp pos_Dims[2] = {-1, -1};
    const int pos_Rank = 2;
    PyArrayObject *capi_pos_as_array = NULL;
    int capi_pos_intent = 0;
    PyObject *pos_capi = Py_None;
    double *masses = NULL;
    npy_intp masses_Dims[1] = {-1};
    const int masses_Rank = 1;
    PyArrayObject *capi_masses_as_array = NULL;
    int capi_masses_intent = 0;
    PyObject *masses_capi = Py_None;
    double *smear = NULL;
    npy_intp smear_Dims[2] = {-1, -1};
    const int smear_Rank = 2;
    PyArrayObject *capi_smear_as_array = NULL;
    int capi_smear_intent = 0;
    PyObject *smear_capi = Py_None;
    double *smear_id = NULL;
    npy_intp smear_id_Dims[2] = {-1, -1};
    const int smear_id_Rank = 2;
    PyArrayObject *capi_smear_id_as_array = NULL;
    int capi_smear_id_intent = 0;
    PyObject *smear_id_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    int classical = 0;
    PyObject *classical_capi = Py_None;
    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    int nirrqpt = 0;
    PyObject *nirrqpt_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int nfc2 = 0;
    PyObject *nfc2_capi = Py_None;
    int nfc3 = 0;
    PyObject *nfc3_capi = Py_None;
    int n_events = 0;
    PyObject *n_events_capi = Py_None;
    double *lineshapes = NULL;
    npy_intp lineshapes_Dims[3] = {-1, -1, -1};
    const int lineshapes_Rank = 3;
    PyArrayObject *capi_lineshapes_as_array = NULL;
    int capi_lineshapes_intent = 0;
    static char *capi_kwlist[] = {"irrqgrid","qgrid","weights","scatt_events","fc2","r2_2","fc3","r3_2","r3_3","rprim","pos","masses","smear","smear_id","t","gaussian","classical","energies","ne","nirrqpt","nat","nfc2","nfc3","n_events",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOOOOOOOOOO|OOOOOO:thermal_conductivity.get_lf.calculate_lineshapes",\
        capi_kwlist,&irrqgrid_capi,&qgrid_capi,&weights_capi,&scatt_events_capi,&fc2_capi,&r2_2_capi,&fc3_capi,&r3_2_capi,&r3_3_capi,&rprim_capi,&pos_capi,&masses_capi,&smear_capi,&smear_id_capi,&t_capi,&gaussian_capi,&classical_capi,&energies_capi,&ne_capi,&nirrqpt_capi,&nat_capi,&nfc2_capi,&nfc3_capi,&n_events_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable irrqgrid */
    irrqgrid_Dims[0]=3;
    capi_irrqgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 1st argument `irrqgrid`";
    capi_irrqgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,irrqgrid_Dims,irrqgrid_Rank,  capi_irrqgrid_intent,irrqgrid_capi,capi_errmess);
    if (capi_irrqgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        irrqgrid = (double *)(PyArray_DATA(capi_irrqgrid_as_array));

    /* Processing variable qgrid */
    qgrid_Dims[0]=3;
    capi_qgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 2nd argument `qgrid`";
    capi_qgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qgrid_Dims,qgrid_Rank,  capi_qgrid_intent,qgrid_capi,capi_errmess);
    if (capi_qgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qgrid = (double *)(PyArray_DATA(capi_qgrid_as_array));

    /* Processing variable fc2 */
    ;
    capi_fc2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 5th argument `fc2`";
    capi_fc2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc2_Dims,fc2_Rank,  capi_fc2_intent,fc2_capi,capi_errmess);
    if (capi_fc2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc2 = (double *)(PyArray_DATA(capi_fc2_as_array));

    /* Processing variable rprim */
    rprim_Dims[0]=3,rprim_Dims[1]=3;
    capi_rprim_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 10th argument `rprim`";
    capi_rprim_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rprim_Dims,rprim_Rank,  capi_rprim_intent,rprim_capi,capi_errmess);
    if (capi_rprim_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rprim = (double *)(PyArray_DATA(capi_rprim_as_array));

    /* Processing variable energies */
    ;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 18th argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.get_lf.calculate_lineshapes() 15th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable classical */
        classical = (int)PyObject_IsTrue(classical_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable nirrqpt */
    if (nirrqpt_capi == Py_None) nirrqpt = shape(irrqgrid, 1); else
        f2py_success = int_from_pyobj(&nirrqpt,nirrqpt_capi,"thermal_conductivity.get_lf.calculate_lineshapes() 2nd keyword (nirrqpt) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(irrqgrid, 1) == nirrqpt,"shape(irrqgrid, 1) == nirrqpt","2nd keyword nirrqpt","calculate_lineshapes:nirrqpt=%d",nirrqpt) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(fc2, 1) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.get_lf.calculate_lineshapes() 3rd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 1) == 3 * nat,"shape(fc2, 1) == 3 * nat","3rd keyword nat","calculate_lineshapes:nat=%d",nat) {
    /* Processing variable nfc2 */
    if (nfc2_capi == Py_None) nfc2 = shape(fc2, 0); else
        f2py_success = int_from_pyobj(&nfc2,nfc2_capi,"thermal_conductivity.get_lf.calculate_lineshapes() 4th keyword (nfc2) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 0) == nfc2,"shape(fc2, 0) == nfc2","4th keyword nfc2","calculate_lineshapes:nfc2=%d",nfc2) {
    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(energies, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.get_lf.calculate_lineshapes() 1st keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(energies, 0) == ne,"shape(energies, 0) == ne","1st keyword ne","calculate_lineshapes:ne=%d",ne) {
    /* Processing variable n_events */
    if (n_events_capi == Py_None) n_events = shape(qgrid, 1); else
        f2py_success = int_from_pyobj(&n_events,n_events_capi,"thermal_conductivity.get_lf.calculate_lineshapes() 6th keyword (n_events) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(qgrid, 1) == n_events,"shape(qgrid, 1) == n_events","6th keyword n_events","calculate_lineshapes:n_events=%d",n_events) {
    /* Processing variable weights */
    weights_Dims[0]=n_events;
    capi_weights_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 3rd argument `weights`";
    capi_weights_as_array = ndarray_from_pyobj(  NPY_INT,1,weights_Dims,weights_Rank,  capi_weights_intent,weights_capi,capi_errmess);
    if (capi_weights_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        weights = (int *)(PyArray_DATA(capi_weights_as_array));

    /* Processing variable scatt_events */
    scatt_events_Dims[0]=nirrqpt;
    capi_scatt_events_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 4th argument `scatt_events`";
    capi_scatt_events_as_array = ndarray_from_pyobj(  NPY_INT,1,scatt_events_Dims,scatt_events_Rank,  capi_scatt_events_intent,scatt_events_capi,capi_errmess);
    if (capi_scatt_events_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        scatt_events = (int *)(PyArray_DATA(capi_scatt_events_as_array));

    /* Processing variable fc3 */
    fc3_Dims[1]=3 * nat,fc3_Dims[2]=3 * nat,fc3_Dims[3]=3 * nat;
    capi_fc3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 7th argument `fc3`";
    capi_fc3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc3_Dims,fc3_Rank,  capi_fc3_intent,fc3_capi,capi_errmess);
    if (capi_fc3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc3 = (double *)(PyArray_DATA(capi_fc3_as_array));

    /* Processing variable r2_2 */
    r2_2_Dims[0]=3,r2_2_Dims[1]=nfc2;
    capi_r2_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 6th argument `r2_2`";
    capi_r2_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_2_Dims,r2_2_Rank,  capi_r2_2_intent,r2_2_capi,capi_errmess);
    if (capi_r2_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2_2 = (double *)(PyArray_DATA(capi_r2_2_as_array));

    /* Processing variable pos */
    pos_Dims[0]=3,pos_Dims[1]=nat;
    capi_pos_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 11st argument `pos`";
    capi_pos_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,pos_Dims,pos_Rank,  capi_pos_intent,pos_capi,capi_errmess);
    if (capi_pos_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pos = (double *)(PyArray_DATA(capi_pos_as_array));

    /* Processing variable masses */
    masses_Dims[0]=nat;
    capi_masses_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 12nd argument `masses`";
    capi_masses_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,masses_Dims,masses_Rank,  capi_masses_intent,masses_capi,capi_errmess);
    if (capi_masses_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        masses = (double *)(PyArray_DATA(capi_masses_as_array));

    /* Processing variable smear */
    smear_Dims[0]=3 * nat,smear_Dims[1]=nirrqpt;
    capi_smear_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 13rd argument `smear`";
    capi_smear_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_Dims,smear_Rank,  capi_smear_intent,smear_capi,capi_errmess);
    if (capi_smear_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear = (double *)(PyArray_DATA(capi_smear_as_array));

    /* Processing variable smear_id */
    smear_id_Dims[0]=3 * nat,smear_id_Dims[1]=nirrqpt;
    capi_smear_id_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 14th argument `smear_id`";
    capi_smear_id_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_id_Dims,smear_id_Rank,  capi_smear_id_intent,smear_id_capi,capi_errmess);
    if (capi_smear_id_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear_id = (double *)(PyArray_DATA(capi_smear_id_as_array));

    /* Processing variable lineshapes */
    lineshapes_Dims[0]=nirrqpt,lineshapes_Dims[1]=3 * nat,lineshapes_Dims[2]=ne;
    capi_lineshapes_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the hidden `lineshapes`";
    capi_lineshapes_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,lineshapes_Dims,lineshapes_Rank,  capi_lineshapes_intent,Py_None,capi_errmess);
    if (capi_lineshapes_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        lineshapes = (double *)(PyArray_DATA(capi_lineshapes_as_array));

    /* Processing variable nfc3 */
    if (nfc3_capi == Py_None) nfc3 = shape(fc3, 0); else
        f2py_success = int_from_pyobj(&nfc3,nfc3_capi,"thermal_conductivity.get_lf.calculate_lineshapes() 5th keyword (nfc3) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc3, 0) == nfc3,"shape(fc3, 0) == nfc3","5th keyword nfc3","calculate_lineshapes:nfc3=%d",nfc3) {
    /* Processing variable r3_2 */
    r3_2_Dims[0]=3,r3_2_Dims[1]=nfc3;
    capi_r3_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 8th argument `r3_2`";
    capi_r3_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_2_Dims,r3_2_Rank,  capi_r3_2_intent,r3_2_capi,capi_errmess);
    if (capi_r3_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_2 = (double *)(PyArray_DATA(capi_r3_2_as_array));

    /* Processing variable r3_3 */
    r3_3_Dims[0]=3,r3_3_Dims[1]=nfc3;
    capi_r3_3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes: failed to create array from the 9th argument `r3_3`";
    capi_r3_3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_3_Dims,r3_3_Rank,  capi_r3_3_intent,r3_3_capi,capi_errmess);
    if (capi_r3_3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_3 = (double *)(PyArray_DATA(capi_r3_3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(irrqgrid,qgrid,weights,scatt_events,fc2,r2_2,fc3,r3_2,r3_3,rprim,pos,masses,smear,smear_id,&t,&gaussian,&classical,energies,&ne,&nirrqpt,&nat,&nfc2,&nfc3,&n_events,lineshapes);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_lineshapes_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_r3_3_as_array!=r3_3_capi) {
        Py_XDECREF(capi_r3_3_as_array); }
    }  /* if (capi_r3_3_as_array == NULL) ... else of r3_3 */
    /* End of cleaning variable r3_3 */
    if((PyObject *)capi_r3_2_as_array!=r3_2_capi) {
        Py_XDECREF(capi_r3_2_as_array); }
    }  /* if (capi_r3_2_as_array == NULL) ... else of r3_2 */
    /* End of cleaning variable r3_2 */
    } /*CHECKSCALAR(shape(fc3, 0) == nfc3)*/
    } /*if (f2py_success) of nfc3*/
    /* End of cleaning variable nfc3 */
    }  /* if (capi_lineshapes_as_array == NULL) ... else of lineshapes */
    /* End of cleaning variable lineshapes */
    if((PyObject *)capi_smear_id_as_array!=smear_id_capi) {
        Py_XDECREF(capi_smear_id_as_array); }
    }  /* if (capi_smear_id_as_array == NULL) ... else of smear_id */
    /* End of cleaning variable smear_id */
    if((PyObject *)capi_smear_as_array!=smear_capi) {
        Py_XDECREF(capi_smear_as_array); }
    }  /* if (capi_smear_as_array == NULL) ... else of smear */
    /* End of cleaning variable smear */
    if((PyObject *)capi_masses_as_array!=masses_capi) {
        Py_XDECREF(capi_masses_as_array); }
    }  /* if (capi_masses_as_array == NULL) ... else of masses */
    /* End of cleaning variable masses */
    if((PyObject *)capi_pos_as_array!=pos_capi) {
        Py_XDECREF(capi_pos_as_array); }
    }  /* if (capi_pos_as_array == NULL) ... else of pos */
    /* End of cleaning variable pos */
    if((PyObject *)capi_r2_2_as_array!=r2_2_capi) {
        Py_XDECREF(capi_r2_2_as_array); }
    }  /* if (capi_r2_2_as_array == NULL) ... else of r2_2 */
    /* End of cleaning variable r2_2 */
    if((PyObject *)capi_fc3_as_array!=fc3_capi) {
        Py_XDECREF(capi_fc3_as_array); }
    }  /* if (capi_fc3_as_array == NULL) ... else of fc3 */
    /* End of cleaning variable fc3 */
    if((PyObject *)capi_scatt_events_as_array!=scatt_events_capi) {
        Py_XDECREF(capi_scatt_events_as_array); }
    }  /* if (capi_scatt_events_as_array == NULL) ... else of scatt_events */
    /* End of cleaning variable scatt_events */
    if((PyObject *)capi_weights_as_array!=weights_capi) {
        Py_XDECREF(capi_weights_as_array); }
    }  /* if (capi_weights_as_array == NULL) ... else of weights */
    /* End of cleaning variable weights */
    } /*CHECKSCALAR(shape(qgrid, 1) == n_events)*/
    } /*if (f2py_success) of n_events*/
    /* End of cleaning variable n_events */
    } /*CHECKSCALAR(shape(energies, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    } /*CHECKSCALAR(shape(fc2, 0) == nfc2)*/
    } /*if (f2py_success) of nfc2*/
    /* End of cleaning variable nfc2 */
    } /*CHECKSCALAR(shape(fc2, 1) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(irrqgrid, 1) == nirrqpt)*/
    } /*if (f2py_success) of nirrqpt*/
    /* End of cleaning variable nirrqpt */
    } /*if (f2py_success) of classical*/
    /* End of cleaning variable classical */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
    if((PyObject *)capi_rprim_as_array!=rprim_capi) {
        Py_XDECREF(capi_rprim_as_array); }
    }  /* if (capi_rprim_as_array == NULL) ... else of rprim */
    /* End of cleaning variable rprim */
    if((PyObject *)capi_fc2_as_array!=fc2_capi) {
        Py_XDECREF(capi_fc2_as_array); }
    }  /* if (capi_fc2_as_array == NULL) ... else of fc2 */
    /* End of cleaning variable fc2 */
    if((PyObject *)capi_qgrid_as_array!=qgrid_capi) {
        Py_XDECREF(capi_qgrid_as_array); }
    }  /* if (capi_qgrid_as_array == NULL) ... else of qgrid */
    /* End of cleaning variable qgrid */
    if((PyObject *)capi_irrqgrid_as_array!=irrqgrid_capi) {
        Py_XDECREF(capi_irrqgrid_as_array); }
    }  /* if (capi_irrqgrid_as_array == NULL) ... else of irrqgrid */
    /* End of cleaning variable irrqgrid */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************ end of calculate_lineshapes ************************/

/********************** calculate_lineshapes_mode_mixing **********************/
static char doc_f2py_rout_thermal_conductivity_get_lf_calculate_lineshapes_mode_mixing[] = "\
lineshapes = calculate_lineshapes_mode_mixing(irrqgrid,qgrid,weights,scatt_events,fc2,r2_2,fc3,r3_2,r3_3,rprim,pos,masses,smear,smear_id,t,gaussian,classical,energies,[ne,nirrqpt,nat,nfc2,nfc3,n_events])\n\nWrapper for ``calculate_lineshapes_mode_mixing``.\
\n\nParameters\n----------\n"
"irrqgrid : input rank-2 array('d') with bounds (3,nirrqpt)\n"
"qgrid : input rank-2 array('d') with bounds (3,n_events)\n"
"weights : input rank-1 array('i') with bounds (n_events)\n"
"scatt_events : input rank-1 array('i') with bounds (nirrqpt)\n"
"fc2 : input rank-3 array('d') with bounds (nfc2,3 * nat,3 * nat)\n"
"r2_2 : input rank-2 array('d') with bounds (3,nfc2)\n"
"fc3 : input rank-4 array('d') with bounds (nfc3,3 * nat,3 * nat,3 * nat)\n"
"r3_2 : input rank-2 array('d') with bounds (3,nfc3)\n"
"r3_3 : input rank-2 array('d') with bounds (3,nfc3)\n"
"rprim : input rank-2 array('d') with bounds (3,3)\n"
"pos : input rank-2 array('d') with bounds (3,nat)\n"
"masses : input rank-1 array('d') with bounds (nat)\n"
"smear : input rank-2 array('d') with bounds (3 * nat,nirrqpt)\n"
"smear_id : input rank-2 array('d') with bounds (3 * nat,nirrqpt)\n"
"t : input float\n"
"gaussian : input int\n"
"classical : input int\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"\nOther Parameters\n----------------\n"
"ne : input int, optional\n    Default: shape(energies, 0)\n"
"nirrqpt : input int, optional\n    Default: shape(irrqgrid, 1)\n"
"nat : input int, optional\n    Default: shape(fc2, 1) / 3\n"
"nfc2 : input int, optional\n    Default: shape(fc2, 0)\n"
"nfc3 : input int, optional\n    Default: shape(fc3, 0)\n"
"n_events : input int, optional\n    Default: shape(qgrid, 1)\n"
"\nReturns\n-------\n"
"lineshapes : rank-4 array('D') with bounds (nirrqpt,3 * nat,3 * nat,ne)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_calculate_lineshapes_mode_mixing(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,int*,double*,int*,int*,int*,int*,int*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *irrqgrid = NULL;
    npy_intp irrqgrid_Dims[2] = {-1, -1};
    const int irrqgrid_Rank = 2;
    PyArrayObject *capi_irrqgrid_as_array = NULL;
    int capi_irrqgrid_intent = 0;
    PyObject *irrqgrid_capi = Py_None;
    double *qgrid = NULL;
    npy_intp qgrid_Dims[2] = {-1, -1};
    const int qgrid_Rank = 2;
    PyArrayObject *capi_qgrid_as_array = NULL;
    int capi_qgrid_intent = 0;
    PyObject *qgrid_capi = Py_None;
    int *weights = NULL;
    npy_intp weights_Dims[1] = {-1};
    const int weights_Rank = 1;
    PyArrayObject *capi_weights_as_array = NULL;
    int capi_weights_intent = 0;
    PyObject *weights_capi = Py_None;
    int *scatt_events = NULL;
    npy_intp scatt_events_Dims[1] = {-1};
    const int scatt_events_Rank = 1;
    PyArrayObject *capi_scatt_events_as_array = NULL;
    int capi_scatt_events_intent = 0;
    PyObject *scatt_events_capi = Py_None;
    double *fc2 = NULL;
    npy_intp fc2_Dims[3] = {-1, -1, -1};
    const int fc2_Rank = 3;
    PyArrayObject *capi_fc2_as_array = NULL;
    int capi_fc2_intent = 0;
    PyObject *fc2_capi = Py_None;
    double *r2_2 = NULL;
    npy_intp r2_2_Dims[2] = {-1, -1};
    const int r2_2_Rank = 2;
    PyArrayObject *capi_r2_2_as_array = NULL;
    int capi_r2_2_intent = 0;
    PyObject *r2_2_capi = Py_None;
    double *fc3 = NULL;
    npy_intp fc3_Dims[4] = {-1, -1, -1, -1};
    const int fc3_Rank = 4;
    PyArrayObject *capi_fc3_as_array = NULL;
    int capi_fc3_intent = 0;
    PyObject *fc3_capi = Py_None;
    double *r3_2 = NULL;
    npy_intp r3_2_Dims[2] = {-1, -1};
    const int r3_2_Rank = 2;
    PyArrayObject *capi_r3_2_as_array = NULL;
    int capi_r3_2_intent = 0;
    PyObject *r3_2_capi = Py_None;
    double *r3_3 = NULL;
    npy_intp r3_3_Dims[2] = {-1, -1};
    const int r3_3_Rank = 2;
    PyArrayObject *capi_r3_3_as_array = NULL;
    int capi_r3_3_intent = 0;
    PyObject *r3_3_capi = Py_None;
    double *rprim = NULL;
    npy_intp rprim_Dims[2] = {-1, -1};
    const int rprim_Rank = 2;
    PyArrayObject *capi_rprim_as_array = NULL;
    int capi_rprim_intent = 0;
    PyObject *rprim_capi = Py_None;
    double *pos = NULL;
    npy_intp pos_Dims[2] = {-1, -1};
    const int pos_Rank = 2;
    PyArrayObject *capi_pos_as_array = NULL;
    int capi_pos_intent = 0;
    PyObject *pos_capi = Py_None;
    double *masses = NULL;
    npy_intp masses_Dims[1] = {-1};
    const int masses_Rank = 1;
    PyArrayObject *capi_masses_as_array = NULL;
    int capi_masses_intent = 0;
    PyObject *masses_capi = Py_None;
    double *smear = NULL;
    npy_intp smear_Dims[2] = {-1, -1};
    const int smear_Rank = 2;
    PyArrayObject *capi_smear_as_array = NULL;
    int capi_smear_intent = 0;
    PyObject *smear_capi = Py_None;
    double *smear_id = NULL;
    npy_intp smear_id_Dims[2] = {-1, -1};
    const int smear_id_Rank = 2;
    PyArrayObject *capi_smear_id_as_array = NULL;
    int capi_smear_id_intent = 0;
    PyObject *smear_id_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    int classical = 0;
    PyObject *classical_capi = Py_None;
    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    int nirrqpt = 0;
    PyObject *nirrqpt_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int nfc2 = 0;
    PyObject *nfc2_capi = Py_None;
    int nfc3 = 0;
    PyObject *nfc3_capi = Py_None;
    int n_events = 0;
    PyObject *n_events_capi = Py_None;
    complex_double *lineshapes = NULL;
    npy_intp lineshapes_Dims[4] = {-1, -1, -1, -1};
    const int lineshapes_Rank = 4;
    PyArrayObject *capi_lineshapes_as_array = NULL;
    int capi_lineshapes_intent = 0;
    static char *capi_kwlist[] = {"irrqgrid","qgrid","weights","scatt_events","fc2","r2_2","fc3","r3_2","r3_3","rprim","pos","masses","smear","smear_id","t","gaussian","classical","energies","ne","nirrqpt","nat","nfc2","nfc3","n_events",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOOOOOOOOOO|OOOOOO:thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing",\
        capi_kwlist,&irrqgrid_capi,&qgrid_capi,&weights_capi,&scatt_events_capi,&fc2_capi,&r2_2_capi,&fc3_capi,&r3_2_capi,&r3_3_capi,&rprim_capi,&pos_capi,&masses_capi,&smear_capi,&smear_id_capi,&t_capi,&gaussian_capi,&classical_capi,&energies_capi,&ne_capi,&nirrqpt_capi,&nat_capi,&nfc2_capi,&nfc3_capi,&n_events_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable irrqgrid */
    irrqgrid_Dims[0]=3;
    capi_irrqgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 1st argument `irrqgrid`";
    capi_irrqgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,irrqgrid_Dims,irrqgrid_Rank,  capi_irrqgrid_intent,irrqgrid_capi,capi_errmess);
    if (capi_irrqgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        irrqgrid = (double *)(PyArray_DATA(capi_irrqgrid_as_array));

    /* Processing variable qgrid */
    qgrid_Dims[0]=3;
    capi_qgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 2nd argument `qgrid`";
    capi_qgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qgrid_Dims,qgrid_Rank,  capi_qgrid_intent,qgrid_capi,capi_errmess);
    if (capi_qgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qgrid = (double *)(PyArray_DATA(capi_qgrid_as_array));

    /* Processing variable fc2 */
    ;
    capi_fc2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 5th argument `fc2`";
    capi_fc2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc2_Dims,fc2_Rank,  capi_fc2_intent,fc2_capi,capi_errmess);
    if (capi_fc2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc2 = (double *)(PyArray_DATA(capi_fc2_as_array));

    /* Processing variable rprim */
    rprim_Dims[0]=3,rprim_Dims[1]=3;
    capi_rprim_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 10th argument `rprim`";
    capi_rprim_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rprim_Dims,rprim_Rank,  capi_rprim_intent,rprim_capi,capi_errmess);
    if (capi_rprim_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rprim = (double *)(PyArray_DATA(capi_rprim_as_array));

    /* Processing variable energies */
    ;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 18th argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing() 15th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable classical */
        classical = (int)PyObject_IsTrue(classical_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable nirrqpt */
    if (nirrqpt_capi == Py_None) nirrqpt = shape(irrqgrid, 1); else
        f2py_success = int_from_pyobj(&nirrqpt,nirrqpt_capi,"thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing() 2nd keyword (nirrqpt) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(irrqgrid, 1) == nirrqpt,"shape(irrqgrid, 1) == nirrqpt","2nd keyword nirrqpt","calculate_lineshapes_mode_mixing:nirrqpt=%d",nirrqpt) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(fc2, 1) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing() 3rd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 1) == 3 * nat,"shape(fc2, 1) == 3 * nat","3rd keyword nat","calculate_lineshapes_mode_mixing:nat=%d",nat) {
    /* Processing variable nfc2 */
    if (nfc2_capi == Py_None) nfc2 = shape(fc2, 0); else
        f2py_success = int_from_pyobj(&nfc2,nfc2_capi,"thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing() 4th keyword (nfc2) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 0) == nfc2,"shape(fc2, 0) == nfc2","4th keyword nfc2","calculate_lineshapes_mode_mixing:nfc2=%d",nfc2) {
    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(energies, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing() 1st keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(energies, 0) == ne,"shape(energies, 0) == ne","1st keyword ne","calculate_lineshapes_mode_mixing:ne=%d",ne) {
    /* Processing variable n_events */
    if (n_events_capi == Py_None) n_events = shape(qgrid, 1); else
        f2py_success = int_from_pyobj(&n_events,n_events_capi,"thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing() 6th keyword (n_events) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(qgrid, 1) == n_events,"shape(qgrid, 1) == n_events","6th keyword n_events","calculate_lineshapes_mode_mixing:n_events=%d",n_events) {
    /* Processing variable weights */
    weights_Dims[0]=n_events;
    capi_weights_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 3rd argument `weights`";
    capi_weights_as_array = ndarray_from_pyobj(  NPY_INT,1,weights_Dims,weights_Rank,  capi_weights_intent,weights_capi,capi_errmess);
    if (capi_weights_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        weights = (int *)(PyArray_DATA(capi_weights_as_array));

    /* Processing variable scatt_events */
    scatt_events_Dims[0]=nirrqpt;
    capi_scatt_events_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 4th argument `scatt_events`";
    capi_scatt_events_as_array = ndarray_from_pyobj(  NPY_INT,1,scatt_events_Dims,scatt_events_Rank,  capi_scatt_events_intent,scatt_events_capi,capi_errmess);
    if (capi_scatt_events_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        scatt_events = (int *)(PyArray_DATA(capi_scatt_events_as_array));

    /* Processing variable fc3 */
    fc3_Dims[1]=3 * nat,fc3_Dims[2]=3 * nat,fc3_Dims[3]=3 * nat;
    capi_fc3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 7th argument `fc3`";
    capi_fc3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc3_Dims,fc3_Rank,  capi_fc3_intent,fc3_capi,capi_errmess);
    if (capi_fc3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc3 = (double *)(PyArray_DATA(capi_fc3_as_array));

    /* Processing variable r2_2 */
    r2_2_Dims[0]=3,r2_2_Dims[1]=nfc2;
    capi_r2_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 6th argument `r2_2`";
    capi_r2_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_2_Dims,r2_2_Rank,  capi_r2_2_intent,r2_2_capi,capi_errmess);
    if (capi_r2_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2_2 = (double *)(PyArray_DATA(capi_r2_2_as_array));

    /* Processing variable pos */
    pos_Dims[0]=3,pos_Dims[1]=nat;
    capi_pos_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 11st argument `pos`";
    capi_pos_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,pos_Dims,pos_Rank,  capi_pos_intent,pos_capi,capi_errmess);
    if (capi_pos_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pos = (double *)(PyArray_DATA(capi_pos_as_array));

    /* Processing variable masses */
    masses_Dims[0]=nat;
    capi_masses_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 12nd argument `masses`";
    capi_masses_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,masses_Dims,masses_Rank,  capi_masses_intent,masses_capi,capi_errmess);
    if (capi_masses_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        masses = (double *)(PyArray_DATA(capi_masses_as_array));

    /* Processing variable smear */
    smear_Dims[0]=3 * nat,smear_Dims[1]=nirrqpt;
    capi_smear_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 13rd argument `smear`";
    capi_smear_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_Dims,smear_Rank,  capi_smear_intent,smear_capi,capi_errmess);
    if (capi_smear_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear = (double *)(PyArray_DATA(capi_smear_as_array));

    /* Processing variable smear_id */
    smear_id_Dims[0]=3 * nat,smear_id_Dims[1]=nirrqpt;
    capi_smear_id_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 14th argument `smear_id`";
    capi_smear_id_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_id_Dims,smear_id_Rank,  capi_smear_id_intent,smear_id_capi,capi_errmess);
    if (capi_smear_id_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear_id = (double *)(PyArray_DATA(capi_smear_id_as_array));

    /* Processing variable lineshapes */
    lineshapes_Dims[0]=nirrqpt,lineshapes_Dims[1]=3 * nat,lineshapes_Dims[2]=3 * nat,lineshapes_Dims[3]=ne;
    capi_lineshapes_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the hidden `lineshapes`";
    capi_lineshapes_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,lineshapes_Dims,lineshapes_Rank,  capi_lineshapes_intent,Py_None,capi_errmess);
    if (capi_lineshapes_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        lineshapes = (complex_double *)(PyArray_DATA(capi_lineshapes_as_array));

    /* Processing variable nfc3 */
    if (nfc3_capi == Py_None) nfc3 = shape(fc3, 0); else
        f2py_success = int_from_pyobj(&nfc3,nfc3_capi,"thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing() 5th keyword (nfc3) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc3, 0) == nfc3,"shape(fc3, 0) == nfc3","5th keyword nfc3","calculate_lineshapes_mode_mixing:nfc3=%d",nfc3) {
    /* Processing variable r3_2 */
    r3_2_Dims[0]=3,r3_2_Dims[1]=nfc3;
    capi_r3_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 8th argument `r3_2`";
    capi_r3_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_2_Dims,r3_2_Rank,  capi_r3_2_intent,r3_2_capi,capi_errmess);
    if (capi_r3_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_2 = (double *)(PyArray_DATA(capi_r3_2_as_array));

    /* Processing variable r3_3 */
    r3_3_Dims[0]=3,r3_3_Dims[1]=nfc3;
    capi_r3_3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_mode_mixing: failed to create array from the 9th argument `r3_3`";
    capi_r3_3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_3_Dims,r3_3_Rank,  capi_r3_3_intent,r3_3_capi,capi_errmess);
    if (capi_r3_3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_3 = (double *)(PyArray_DATA(capi_r3_3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(irrqgrid,qgrid,weights,scatt_events,fc2,r2_2,fc3,r3_2,r3_3,rprim,pos,masses,smear,smear_id,&t,&gaussian,&classical,energies,&ne,&nirrqpt,&nat,&nfc2,&nfc3,&n_events,lineshapes);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_lineshapes_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_r3_3_as_array!=r3_3_capi) {
        Py_XDECREF(capi_r3_3_as_array); }
    }  /* if (capi_r3_3_as_array == NULL) ... else of r3_3 */
    /* End of cleaning variable r3_3 */
    if((PyObject *)capi_r3_2_as_array!=r3_2_capi) {
        Py_XDECREF(capi_r3_2_as_array); }
    }  /* if (capi_r3_2_as_array == NULL) ... else of r3_2 */
    /* End of cleaning variable r3_2 */
    } /*CHECKSCALAR(shape(fc3, 0) == nfc3)*/
    } /*if (f2py_success) of nfc3*/
    /* End of cleaning variable nfc3 */
    }  /* if (capi_lineshapes_as_array == NULL) ... else of lineshapes */
    /* End of cleaning variable lineshapes */
    if((PyObject *)capi_smear_id_as_array!=smear_id_capi) {
        Py_XDECREF(capi_smear_id_as_array); }
    }  /* if (capi_smear_id_as_array == NULL) ... else of smear_id */
    /* End of cleaning variable smear_id */
    if((PyObject *)capi_smear_as_array!=smear_capi) {
        Py_XDECREF(capi_smear_as_array); }
    }  /* if (capi_smear_as_array == NULL) ... else of smear */
    /* End of cleaning variable smear */
    if((PyObject *)capi_masses_as_array!=masses_capi) {
        Py_XDECREF(capi_masses_as_array); }
    }  /* if (capi_masses_as_array == NULL) ... else of masses */
    /* End of cleaning variable masses */
    if((PyObject *)capi_pos_as_array!=pos_capi) {
        Py_XDECREF(capi_pos_as_array); }
    }  /* if (capi_pos_as_array == NULL) ... else of pos */
    /* End of cleaning variable pos */
    if((PyObject *)capi_r2_2_as_array!=r2_2_capi) {
        Py_XDECREF(capi_r2_2_as_array); }
    }  /* if (capi_r2_2_as_array == NULL) ... else of r2_2 */
    /* End of cleaning variable r2_2 */
    if((PyObject *)capi_fc3_as_array!=fc3_capi) {
        Py_XDECREF(capi_fc3_as_array); }
    }  /* if (capi_fc3_as_array == NULL) ... else of fc3 */
    /* End of cleaning variable fc3 */
    if((PyObject *)capi_scatt_events_as_array!=scatt_events_capi) {
        Py_XDECREF(capi_scatt_events_as_array); }
    }  /* if (capi_scatt_events_as_array == NULL) ... else of scatt_events */
    /* End of cleaning variable scatt_events */
    if((PyObject *)capi_weights_as_array!=weights_capi) {
        Py_XDECREF(capi_weights_as_array); }
    }  /* if (capi_weights_as_array == NULL) ... else of weights */
    /* End of cleaning variable weights */
    } /*CHECKSCALAR(shape(qgrid, 1) == n_events)*/
    } /*if (f2py_success) of n_events*/
    /* End of cleaning variable n_events */
    } /*CHECKSCALAR(shape(energies, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    } /*CHECKSCALAR(shape(fc2, 0) == nfc2)*/
    } /*if (f2py_success) of nfc2*/
    /* End of cleaning variable nfc2 */
    } /*CHECKSCALAR(shape(fc2, 1) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(irrqgrid, 1) == nirrqpt)*/
    } /*if (f2py_success) of nirrqpt*/
    /* End of cleaning variable nirrqpt */
    } /*if (f2py_success) of classical*/
    /* End of cleaning variable classical */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
    if((PyObject *)capi_rprim_as_array!=rprim_capi) {
        Py_XDECREF(capi_rprim_as_array); }
    }  /* if (capi_rprim_as_array == NULL) ... else of rprim */
    /* End of cleaning variable rprim */
    if((PyObject *)capi_fc2_as_array!=fc2_capi) {
        Py_XDECREF(capi_fc2_as_array); }
    }  /* if (capi_fc2_as_array == NULL) ... else of fc2 */
    /* End of cleaning variable fc2 */
    if((PyObject *)capi_qgrid_as_array!=qgrid_capi) {
        Py_XDECREF(capi_qgrid_as_array); }
    }  /* if (capi_qgrid_as_array == NULL) ... else of qgrid */
    /* End of cleaning variable qgrid */
    if((PyObject *)capi_irrqgrid_as_array!=irrqgrid_capi) {
        Py_XDECREF(capi_irrqgrid_as_array); }
    }  /* if (capi_irrqgrid_as_array == NULL) ... else of irrqgrid */
    /* End of cleaning variable irrqgrid */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/****************** end of calculate_lineshapes_mode_mixing ******************/

/*********************** calculate_lineshapes_cartesian ***********************/
static char doc_f2py_rout_thermal_conductivity_get_lf_calculate_lineshapes_cartesian[] = "\
lineshapes = calculate_lineshapes_cartesian(irrqgrid,qgrid,weights,scatt_events,fc2,r2_2,fc3,r3_2,r3_3,rprim,pos,masses,smear,smear_id,t,gaussian,classical,energies,[ne,nirrqpt,nat,nfc2,nfc3,n_events])\n\nWrapper for ``calculate_lineshapes_cartesian``.\
\n\nParameters\n----------\n"
"irrqgrid : input rank-2 array('d') with bounds (3,nirrqpt)\n"
"qgrid : input rank-2 array('d') with bounds (3,n_events)\n"
"weights : input rank-1 array('i') with bounds (n_events)\n"
"scatt_events : input rank-1 array('i') with bounds (nirrqpt)\n"
"fc2 : input rank-3 array('d') with bounds (nfc2,3 * nat,3 * nat)\n"
"r2_2 : input rank-2 array('d') with bounds (3,nfc2)\n"
"fc3 : input rank-4 array('d') with bounds (nfc3,3 * nat,3 * nat,3 * nat)\n"
"r3_2 : input rank-2 array('d') with bounds (3,nfc3)\n"
"r3_3 : input rank-2 array('d') with bounds (3,nfc3)\n"
"rprim : input rank-2 array('d') with bounds (3,3)\n"
"pos : input rank-2 array('d') with bounds (3,nat)\n"
"masses : input rank-1 array('d') with bounds (nat)\n"
"smear : input rank-2 array('d') with bounds (3 * nat,nirrqpt)\n"
"smear_id : input rank-2 array('d') with bounds (3 * nat,nirrqpt)\n"
"t : input float\n"
"gaussian : input int\n"
"classical : input int\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"\nOther Parameters\n----------------\n"
"ne : input int, optional\n    Default: shape(energies, 0)\n"
"nirrqpt : input int, optional\n    Default: shape(irrqgrid, 1)\n"
"nat : input int, optional\n    Default: shape(fc2, 1) / 3\n"
"nfc2 : input int, optional\n    Default: shape(fc2, 0)\n"
"nfc3 : input int, optional\n    Default: shape(fc3, 0)\n"
"n_events : input int, optional\n    Default: shape(qgrid, 1)\n"
"\nReturns\n-------\n"
"lineshapes : rank-4 array('D') with bounds (nirrqpt,3 * nat,3 * nat,ne)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_calculate_lineshapes_cartesian(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,int*,double*,int*,int*,int*,int*,int*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *irrqgrid = NULL;
    npy_intp irrqgrid_Dims[2] = {-1, -1};
    const int irrqgrid_Rank = 2;
    PyArrayObject *capi_irrqgrid_as_array = NULL;
    int capi_irrqgrid_intent = 0;
    PyObject *irrqgrid_capi = Py_None;
    double *qgrid = NULL;
    npy_intp qgrid_Dims[2] = {-1, -1};
    const int qgrid_Rank = 2;
    PyArrayObject *capi_qgrid_as_array = NULL;
    int capi_qgrid_intent = 0;
    PyObject *qgrid_capi = Py_None;
    int *weights = NULL;
    npy_intp weights_Dims[1] = {-1};
    const int weights_Rank = 1;
    PyArrayObject *capi_weights_as_array = NULL;
    int capi_weights_intent = 0;
    PyObject *weights_capi = Py_None;
    int *scatt_events = NULL;
    npy_intp scatt_events_Dims[1] = {-1};
    const int scatt_events_Rank = 1;
    PyArrayObject *capi_scatt_events_as_array = NULL;
    int capi_scatt_events_intent = 0;
    PyObject *scatt_events_capi = Py_None;
    double *fc2 = NULL;
    npy_intp fc2_Dims[3] = {-1, -1, -1};
    const int fc2_Rank = 3;
    PyArrayObject *capi_fc2_as_array = NULL;
    int capi_fc2_intent = 0;
    PyObject *fc2_capi = Py_None;
    double *r2_2 = NULL;
    npy_intp r2_2_Dims[2] = {-1, -1};
    const int r2_2_Rank = 2;
    PyArrayObject *capi_r2_2_as_array = NULL;
    int capi_r2_2_intent = 0;
    PyObject *r2_2_capi = Py_None;
    double *fc3 = NULL;
    npy_intp fc3_Dims[4] = {-1, -1, -1, -1};
    const int fc3_Rank = 4;
    PyArrayObject *capi_fc3_as_array = NULL;
    int capi_fc3_intent = 0;
    PyObject *fc3_capi = Py_None;
    double *r3_2 = NULL;
    npy_intp r3_2_Dims[2] = {-1, -1};
    const int r3_2_Rank = 2;
    PyArrayObject *capi_r3_2_as_array = NULL;
    int capi_r3_2_intent = 0;
    PyObject *r3_2_capi = Py_None;
    double *r3_3 = NULL;
    npy_intp r3_3_Dims[2] = {-1, -1};
    const int r3_3_Rank = 2;
    PyArrayObject *capi_r3_3_as_array = NULL;
    int capi_r3_3_intent = 0;
    PyObject *r3_3_capi = Py_None;
    double *rprim = NULL;
    npy_intp rprim_Dims[2] = {-1, -1};
    const int rprim_Rank = 2;
    PyArrayObject *capi_rprim_as_array = NULL;
    int capi_rprim_intent = 0;
    PyObject *rprim_capi = Py_None;
    double *pos = NULL;
    npy_intp pos_Dims[2] = {-1, -1};
    const int pos_Rank = 2;
    PyArrayObject *capi_pos_as_array = NULL;
    int capi_pos_intent = 0;
    PyObject *pos_capi = Py_None;
    double *masses = NULL;
    npy_intp masses_Dims[1] = {-1};
    const int masses_Rank = 1;
    PyArrayObject *capi_masses_as_array = NULL;
    int capi_masses_intent = 0;
    PyObject *masses_capi = Py_None;
    double *smear = NULL;
    npy_intp smear_Dims[2] = {-1, -1};
    const int smear_Rank = 2;
    PyArrayObject *capi_smear_as_array = NULL;
    int capi_smear_intent = 0;
    PyObject *smear_capi = Py_None;
    double *smear_id = NULL;
    npy_intp smear_id_Dims[2] = {-1, -1};
    const int smear_id_Rank = 2;
    PyArrayObject *capi_smear_id_as_array = NULL;
    int capi_smear_id_intent = 0;
    PyObject *smear_id_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    int classical = 0;
    PyObject *classical_capi = Py_None;
    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    int nirrqpt = 0;
    PyObject *nirrqpt_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int nfc2 = 0;
    PyObject *nfc2_capi = Py_None;
    int nfc3 = 0;
    PyObject *nfc3_capi = Py_None;
    int n_events = 0;
    PyObject *n_events_capi = Py_None;
    complex_double *lineshapes = NULL;
    npy_intp lineshapes_Dims[4] = {-1, -1, -1, -1};
    const int lineshapes_Rank = 4;
    PyArrayObject *capi_lineshapes_as_array = NULL;
    int capi_lineshapes_intent = 0;
    static char *capi_kwlist[] = {"irrqgrid","qgrid","weights","scatt_events","fc2","r2_2","fc3","r3_2","r3_3","rprim","pos","masses","smear","smear_id","t","gaussian","classical","energies","ne","nirrqpt","nat","nfc2","nfc3","n_events",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOOOOOOOOOO|OOOOOO:thermal_conductivity.get_lf.calculate_lineshapes_cartesian",\
        capi_kwlist,&irrqgrid_capi,&qgrid_capi,&weights_capi,&scatt_events_capi,&fc2_capi,&r2_2_capi,&fc3_capi,&r3_2_capi,&r3_3_capi,&rprim_capi,&pos_capi,&masses_capi,&smear_capi,&smear_id_capi,&t_capi,&gaussian_capi,&classical_capi,&energies_capi,&ne_capi,&nirrqpt_capi,&nat_capi,&nfc2_capi,&nfc3_capi,&n_events_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable irrqgrid */
    irrqgrid_Dims[0]=3;
    capi_irrqgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 1st argument `irrqgrid`";
    capi_irrqgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,irrqgrid_Dims,irrqgrid_Rank,  capi_irrqgrid_intent,irrqgrid_capi,capi_errmess);
    if (capi_irrqgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        irrqgrid = (double *)(PyArray_DATA(capi_irrqgrid_as_array));

    /* Processing variable qgrid */
    qgrid_Dims[0]=3;
    capi_qgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 2nd argument `qgrid`";
    capi_qgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qgrid_Dims,qgrid_Rank,  capi_qgrid_intent,qgrid_capi,capi_errmess);
    if (capi_qgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qgrid = (double *)(PyArray_DATA(capi_qgrid_as_array));

    /* Processing variable fc2 */
    ;
    capi_fc2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 5th argument `fc2`";
    capi_fc2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc2_Dims,fc2_Rank,  capi_fc2_intent,fc2_capi,capi_errmess);
    if (capi_fc2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc2 = (double *)(PyArray_DATA(capi_fc2_as_array));

    /* Processing variable rprim */
    rprim_Dims[0]=3,rprim_Dims[1]=3;
    capi_rprim_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 10th argument `rprim`";
    capi_rprim_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rprim_Dims,rprim_Rank,  capi_rprim_intent,rprim_capi,capi_errmess);
    if (capi_rprim_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rprim = (double *)(PyArray_DATA(capi_rprim_as_array));

    /* Processing variable energies */
    ;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 18th argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.get_lf.calculate_lineshapes_cartesian() 15th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable classical */
        classical = (int)PyObject_IsTrue(classical_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable nirrqpt */
    if (nirrqpt_capi == Py_None) nirrqpt = shape(irrqgrid, 1); else
        f2py_success = int_from_pyobj(&nirrqpt,nirrqpt_capi,"thermal_conductivity.get_lf.calculate_lineshapes_cartesian() 2nd keyword (nirrqpt) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(irrqgrid, 1) == nirrqpt,"shape(irrqgrid, 1) == nirrqpt","2nd keyword nirrqpt","calculate_lineshapes_cartesian:nirrqpt=%d",nirrqpt) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(fc2, 1) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.get_lf.calculate_lineshapes_cartesian() 3rd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 1) == 3 * nat,"shape(fc2, 1) == 3 * nat","3rd keyword nat","calculate_lineshapes_cartesian:nat=%d",nat) {
    /* Processing variable nfc2 */
    if (nfc2_capi == Py_None) nfc2 = shape(fc2, 0); else
        f2py_success = int_from_pyobj(&nfc2,nfc2_capi,"thermal_conductivity.get_lf.calculate_lineshapes_cartesian() 4th keyword (nfc2) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 0) == nfc2,"shape(fc2, 0) == nfc2","4th keyword nfc2","calculate_lineshapes_cartesian:nfc2=%d",nfc2) {
    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(energies, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.get_lf.calculate_lineshapes_cartesian() 1st keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(energies, 0) == ne,"shape(energies, 0) == ne","1st keyword ne","calculate_lineshapes_cartesian:ne=%d",ne) {
    /* Processing variable n_events */
    if (n_events_capi == Py_None) n_events = shape(qgrid, 1); else
        f2py_success = int_from_pyobj(&n_events,n_events_capi,"thermal_conductivity.get_lf.calculate_lineshapes_cartesian() 6th keyword (n_events) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(qgrid, 1) == n_events,"shape(qgrid, 1) == n_events","6th keyword n_events","calculate_lineshapes_cartesian:n_events=%d",n_events) {
    /* Processing variable weights */
    weights_Dims[0]=n_events;
    capi_weights_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 3rd argument `weights`";
    capi_weights_as_array = ndarray_from_pyobj(  NPY_INT,1,weights_Dims,weights_Rank,  capi_weights_intent,weights_capi,capi_errmess);
    if (capi_weights_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        weights = (int *)(PyArray_DATA(capi_weights_as_array));

    /* Processing variable scatt_events */
    scatt_events_Dims[0]=nirrqpt;
    capi_scatt_events_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 4th argument `scatt_events`";
    capi_scatt_events_as_array = ndarray_from_pyobj(  NPY_INT,1,scatt_events_Dims,scatt_events_Rank,  capi_scatt_events_intent,scatt_events_capi,capi_errmess);
    if (capi_scatt_events_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        scatt_events = (int *)(PyArray_DATA(capi_scatt_events_as_array));

    /* Processing variable fc3 */
    fc3_Dims[1]=3 * nat,fc3_Dims[2]=3 * nat,fc3_Dims[3]=3 * nat;
    capi_fc3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 7th argument `fc3`";
    capi_fc3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc3_Dims,fc3_Rank,  capi_fc3_intent,fc3_capi,capi_errmess);
    if (capi_fc3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc3 = (double *)(PyArray_DATA(capi_fc3_as_array));

    /* Processing variable r2_2 */
    r2_2_Dims[0]=3,r2_2_Dims[1]=nfc2;
    capi_r2_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 6th argument `r2_2`";
    capi_r2_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_2_Dims,r2_2_Rank,  capi_r2_2_intent,r2_2_capi,capi_errmess);
    if (capi_r2_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2_2 = (double *)(PyArray_DATA(capi_r2_2_as_array));

    /* Processing variable pos */
    pos_Dims[0]=3,pos_Dims[1]=nat;
    capi_pos_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 11st argument `pos`";
    capi_pos_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,pos_Dims,pos_Rank,  capi_pos_intent,pos_capi,capi_errmess);
    if (capi_pos_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pos = (double *)(PyArray_DATA(capi_pos_as_array));

    /* Processing variable masses */
    masses_Dims[0]=nat;
    capi_masses_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 12nd argument `masses`";
    capi_masses_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,masses_Dims,masses_Rank,  capi_masses_intent,masses_capi,capi_errmess);
    if (capi_masses_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        masses = (double *)(PyArray_DATA(capi_masses_as_array));

    /* Processing variable smear */
    smear_Dims[0]=3 * nat,smear_Dims[1]=nirrqpt;
    capi_smear_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 13rd argument `smear`";
    capi_smear_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_Dims,smear_Rank,  capi_smear_intent,smear_capi,capi_errmess);
    if (capi_smear_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear = (double *)(PyArray_DATA(capi_smear_as_array));

    /* Processing variable smear_id */
    smear_id_Dims[0]=3 * nat,smear_id_Dims[1]=nirrqpt;
    capi_smear_id_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 14th argument `smear_id`";
    capi_smear_id_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_id_Dims,smear_id_Rank,  capi_smear_id_intent,smear_id_capi,capi_errmess);
    if (capi_smear_id_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear_id = (double *)(PyArray_DATA(capi_smear_id_as_array));

    /* Processing variable lineshapes */
    lineshapes_Dims[0]=nirrqpt,lineshapes_Dims[1]=3 * nat,lineshapes_Dims[2]=3 * nat,lineshapes_Dims[3]=ne;
    capi_lineshapes_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the hidden `lineshapes`";
    capi_lineshapes_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,lineshapes_Dims,lineshapes_Rank,  capi_lineshapes_intent,Py_None,capi_errmess);
    if (capi_lineshapes_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        lineshapes = (complex_double *)(PyArray_DATA(capi_lineshapes_as_array));

    /* Processing variable nfc3 */
    if (nfc3_capi == Py_None) nfc3 = shape(fc3, 0); else
        f2py_success = int_from_pyobj(&nfc3,nfc3_capi,"thermal_conductivity.get_lf.calculate_lineshapes_cartesian() 5th keyword (nfc3) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc3, 0) == nfc3,"shape(fc3, 0) == nfc3","5th keyword nfc3","calculate_lineshapes_cartesian:nfc3=%d",nfc3) {
    /* Processing variable r3_2 */
    r3_2_Dims[0]=3,r3_2_Dims[1]=nfc3;
    capi_r3_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 8th argument `r3_2`";
    capi_r3_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_2_Dims,r3_2_Rank,  capi_r3_2_intent,r3_2_capi,capi_errmess);
    if (capi_r3_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_2 = (double *)(PyArray_DATA(capi_r3_2_as_array));

    /* Processing variable r3_3 */
    r3_3_Dims[0]=3,r3_3_Dims[1]=nfc3;
    capi_r3_3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lineshapes_cartesian: failed to create array from the 9th argument `r3_3`";
    capi_r3_3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_3_Dims,r3_3_Rank,  capi_r3_3_intent,r3_3_capi,capi_errmess);
    if (capi_r3_3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_3 = (double *)(PyArray_DATA(capi_r3_3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(irrqgrid,qgrid,weights,scatt_events,fc2,r2_2,fc3,r3_2,r3_3,rprim,pos,masses,smear,smear_id,&t,&gaussian,&classical,energies,&ne,&nirrqpt,&nat,&nfc2,&nfc3,&n_events,lineshapes);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_lineshapes_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_r3_3_as_array!=r3_3_capi) {
        Py_XDECREF(capi_r3_3_as_array); }
    }  /* if (capi_r3_3_as_array == NULL) ... else of r3_3 */
    /* End of cleaning variable r3_3 */
    if((PyObject *)capi_r3_2_as_array!=r3_2_capi) {
        Py_XDECREF(capi_r3_2_as_array); }
    }  /* if (capi_r3_2_as_array == NULL) ... else of r3_2 */
    /* End of cleaning variable r3_2 */
    } /*CHECKSCALAR(shape(fc3, 0) == nfc3)*/
    } /*if (f2py_success) of nfc3*/
    /* End of cleaning variable nfc3 */
    }  /* if (capi_lineshapes_as_array == NULL) ... else of lineshapes */
    /* End of cleaning variable lineshapes */
    if((PyObject *)capi_smear_id_as_array!=smear_id_capi) {
        Py_XDECREF(capi_smear_id_as_array); }
    }  /* if (capi_smear_id_as_array == NULL) ... else of smear_id */
    /* End of cleaning variable smear_id */
    if((PyObject *)capi_smear_as_array!=smear_capi) {
        Py_XDECREF(capi_smear_as_array); }
    }  /* if (capi_smear_as_array == NULL) ... else of smear */
    /* End of cleaning variable smear */
    if((PyObject *)capi_masses_as_array!=masses_capi) {
        Py_XDECREF(capi_masses_as_array); }
    }  /* if (capi_masses_as_array == NULL) ... else of masses */
    /* End of cleaning variable masses */
    if((PyObject *)capi_pos_as_array!=pos_capi) {
        Py_XDECREF(capi_pos_as_array); }
    }  /* if (capi_pos_as_array == NULL) ... else of pos */
    /* End of cleaning variable pos */
    if((PyObject *)capi_r2_2_as_array!=r2_2_capi) {
        Py_XDECREF(capi_r2_2_as_array); }
    }  /* if (capi_r2_2_as_array == NULL) ... else of r2_2 */
    /* End of cleaning variable r2_2 */
    if((PyObject *)capi_fc3_as_array!=fc3_capi) {
        Py_XDECREF(capi_fc3_as_array); }
    }  /* if (capi_fc3_as_array == NULL) ... else of fc3 */
    /* End of cleaning variable fc3 */
    if((PyObject *)capi_scatt_events_as_array!=scatt_events_capi) {
        Py_XDECREF(capi_scatt_events_as_array); }
    }  /* if (capi_scatt_events_as_array == NULL) ... else of scatt_events */
    /* End of cleaning variable scatt_events */
    if((PyObject *)capi_weights_as_array!=weights_capi) {
        Py_XDECREF(capi_weights_as_array); }
    }  /* if (capi_weights_as_array == NULL) ... else of weights */
    /* End of cleaning variable weights */
    } /*CHECKSCALAR(shape(qgrid, 1) == n_events)*/
    } /*if (f2py_success) of n_events*/
    /* End of cleaning variable n_events */
    } /*CHECKSCALAR(shape(energies, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    } /*CHECKSCALAR(shape(fc2, 0) == nfc2)*/
    } /*if (f2py_success) of nfc2*/
    /* End of cleaning variable nfc2 */
    } /*CHECKSCALAR(shape(fc2, 1) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(irrqgrid, 1) == nirrqpt)*/
    } /*if (f2py_success) of nirrqpt*/
    /* End of cleaning variable nirrqpt */
    } /*if (f2py_success) of classical*/
    /* End of cleaning variable classical */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
    if((PyObject *)capi_rprim_as_array!=rprim_capi) {
        Py_XDECREF(capi_rprim_as_array); }
    }  /* if (capi_rprim_as_array == NULL) ... else of rprim */
    /* End of cleaning variable rprim */
    if((PyObject *)capi_fc2_as_array!=fc2_capi) {
        Py_XDECREF(capi_fc2_as_array); }
    }  /* if (capi_fc2_as_array == NULL) ... else of fc2 */
    /* End of cleaning variable fc2 */
    if((PyObject *)capi_qgrid_as_array!=qgrid_capi) {
        Py_XDECREF(capi_qgrid_as_array); }
    }  /* if (capi_qgrid_as_array == NULL) ... else of qgrid */
    /* End of cleaning variable qgrid */
    if((PyObject *)capi_irrqgrid_as_array!=irrqgrid_capi) {
        Py_XDECREF(capi_irrqgrid_as_array); }
    }  /* if (capi_irrqgrid_as_array == NULL) ... else of irrqgrid */
    /* End of cleaning variable irrqgrid */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************* end of calculate_lineshapes_cartesian *******************/

/******************** calculate_lifetimes_selfconsistently ********************/
static char doc_f2py_rout_thermal_conductivity_get_lf_calculate_lifetimes_selfconsistently[] = "\
selfengs = calculate_lifetimes_selfconsistently(irrqgrid,qgrid,weights,scatt_events,fc2,r2_2,fc3,r3_2,r3_3,rprim,pos,masses,smear,smear_id,t,gaussian,classical,energies,[ne,nirrqpt,nat,nfc2,nfc3,n_events])\n\nWrapper for ``calculate_lifetimes_selfconsistently``.\
\n\nParameters\n----------\n"
"irrqgrid : input rank-2 array('d') with bounds (3,nirrqpt)\n"
"qgrid : input rank-2 array('d') with bounds (3,n_events)\n"
"weights : input rank-1 array('i') with bounds (n_events)\n"
"scatt_events : input rank-1 array('i') with bounds (nirrqpt)\n"
"fc2 : input rank-3 array('d') with bounds (nfc2,3 * nat,3 * nat)\n"
"r2_2 : input rank-2 array('d') with bounds (3,nfc2)\n"
"fc3 : input rank-4 array('d') with bounds (nfc3,3 * nat,3 * nat,3 * nat)\n"
"r3_2 : input rank-2 array('d') with bounds (3,nfc3)\n"
"r3_3 : input rank-2 array('d') with bounds (3,nfc3)\n"
"rprim : input rank-2 array('d') with bounds (3,3)\n"
"pos : input rank-2 array('d') with bounds (3,nat)\n"
"masses : input rank-1 array('d') with bounds (nat)\n"
"smear : input rank-2 array('d') with bounds (3 * nat,nirrqpt)\n"
"smear_id : input rank-2 array('d') with bounds (3 * nat,nirrqpt)\n"
"t : input float\n"
"gaussian : input int\n"
"classical : input int\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"\nOther Parameters\n----------------\n"
"ne : input int, optional\n    Default: shape(energies, 0)\n"
"nirrqpt : input int, optional\n    Default: shape(irrqgrid, 1)\n"
"nat : input int, optional\n    Default: shape(fc2, 1) / 3\n"
"nfc2 : input int, optional\n    Default: shape(fc2, 0)\n"
"nfc3 : input int, optional\n    Default: shape(fc3, 0)\n"
"n_events : input int, optional\n    Default: shape(qgrid, 1)\n"
"\nReturns\n-------\n"
"selfengs : rank-2 array('D') with bounds (nirrqpt,3 * nat)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_calculate_lifetimes_selfconsistently(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,int*,double*,int*,int*,int*,int*,int*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *irrqgrid = NULL;
    npy_intp irrqgrid_Dims[2] = {-1, -1};
    const int irrqgrid_Rank = 2;
    PyArrayObject *capi_irrqgrid_as_array = NULL;
    int capi_irrqgrid_intent = 0;
    PyObject *irrqgrid_capi = Py_None;
    double *qgrid = NULL;
    npy_intp qgrid_Dims[2] = {-1, -1};
    const int qgrid_Rank = 2;
    PyArrayObject *capi_qgrid_as_array = NULL;
    int capi_qgrid_intent = 0;
    PyObject *qgrid_capi = Py_None;
    int *weights = NULL;
    npy_intp weights_Dims[1] = {-1};
    const int weights_Rank = 1;
    PyArrayObject *capi_weights_as_array = NULL;
    int capi_weights_intent = 0;
    PyObject *weights_capi = Py_None;
    int *scatt_events = NULL;
    npy_intp scatt_events_Dims[1] = {-1};
    const int scatt_events_Rank = 1;
    PyArrayObject *capi_scatt_events_as_array = NULL;
    int capi_scatt_events_intent = 0;
    PyObject *scatt_events_capi = Py_None;
    double *fc2 = NULL;
    npy_intp fc2_Dims[3] = {-1, -1, -1};
    const int fc2_Rank = 3;
    PyArrayObject *capi_fc2_as_array = NULL;
    int capi_fc2_intent = 0;
    PyObject *fc2_capi = Py_None;
    double *r2_2 = NULL;
    npy_intp r2_2_Dims[2] = {-1, -1};
    const int r2_2_Rank = 2;
    PyArrayObject *capi_r2_2_as_array = NULL;
    int capi_r2_2_intent = 0;
    PyObject *r2_2_capi = Py_None;
    double *fc3 = NULL;
    npy_intp fc3_Dims[4] = {-1, -1, -1, -1};
    const int fc3_Rank = 4;
    PyArrayObject *capi_fc3_as_array = NULL;
    int capi_fc3_intent = 0;
    PyObject *fc3_capi = Py_None;
    double *r3_2 = NULL;
    npy_intp r3_2_Dims[2] = {-1, -1};
    const int r3_2_Rank = 2;
    PyArrayObject *capi_r3_2_as_array = NULL;
    int capi_r3_2_intent = 0;
    PyObject *r3_2_capi = Py_None;
    double *r3_3 = NULL;
    npy_intp r3_3_Dims[2] = {-1, -1};
    const int r3_3_Rank = 2;
    PyArrayObject *capi_r3_3_as_array = NULL;
    int capi_r3_3_intent = 0;
    PyObject *r3_3_capi = Py_None;
    double *rprim = NULL;
    npy_intp rprim_Dims[2] = {-1, -1};
    const int rprim_Rank = 2;
    PyArrayObject *capi_rprim_as_array = NULL;
    int capi_rprim_intent = 0;
    PyObject *rprim_capi = Py_None;
    double *pos = NULL;
    npy_intp pos_Dims[2] = {-1, -1};
    const int pos_Rank = 2;
    PyArrayObject *capi_pos_as_array = NULL;
    int capi_pos_intent = 0;
    PyObject *pos_capi = Py_None;
    double *masses = NULL;
    npy_intp masses_Dims[1] = {-1};
    const int masses_Rank = 1;
    PyArrayObject *capi_masses_as_array = NULL;
    int capi_masses_intent = 0;
    PyObject *masses_capi = Py_None;
    double *smear = NULL;
    npy_intp smear_Dims[2] = {-1, -1};
    const int smear_Rank = 2;
    PyArrayObject *capi_smear_as_array = NULL;
    int capi_smear_intent = 0;
    PyObject *smear_capi = Py_None;
    double *smear_id = NULL;
    npy_intp smear_id_Dims[2] = {-1, -1};
    const int smear_id_Rank = 2;
    PyArrayObject *capi_smear_id_as_array = NULL;
    int capi_smear_id_intent = 0;
    PyObject *smear_id_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    int classical = 0;
    PyObject *classical_capi = Py_None;
    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    int nirrqpt = 0;
    PyObject *nirrqpt_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int nfc2 = 0;
    PyObject *nfc2_capi = Py_None;
    int nfc3 = 0;
    PyObject *nfc3_capi = Py_None;
    int n_events = 0;
    PyObject *n_events_capi = Py_None;
    complex_double *selfengs = NULL;
    npy_intp selfengs_Dims[2] = {-1, -1};
    const int selfengs_Rank = 2;
    PyArrayObject *capi_selfengs_as_array = NULL;
    int capi_selfengs_intent = 0;
    static char *capi_kwlist[] = {"irrqgrid","qgrid","weights","scatt_events","fc2","r2_2","fc3","r3_2","r3_3","rprim","pos","masses","smear","smear_id","t","gaussian","classical","energies","ne","nirrqpt","nat","nfc2","nfc3","n_events",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOOOOOOOOOO|OOOOOO:thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently",\
        capi_kwlist,&irrqgrid_capi,&qgrid_capi,&weights_capi,&scatt_events_capi,&fc2_capi,&r2_2_capi,&fc3_capi,&r3_2_capi,&r3_3_capi,&rprim_capi,&pos_capi,&masses_capi,&smear_capi,&smear_id_capi,&t_capi,&gaussian_capi,&classical_capi,&energies_capi,&ne_capi,&nirrqpt_capi,&nat_capi,&nfc2_capi,&nfc3_capi,&n_events_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable irrqgrid */
    irrqgrid_Dims[0]=3;
    capi_irrqgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 1st argument `irrqgrid`";
    capi_irrqgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,irrqgrid_Dims,irrqgrid_Rank,  capi_irrqgrid_intent,irrqgrid_capi,capi_errmess);
    if (capi_irrqgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        irrqgrid = (double *)(PyArray_DATA(capi_irrqgrid_as_array));

    /* Processing variable qgrid */
    qgrid_Dims[0]=3;
    capi_qgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 2nd argument `qgrid`";
    capi_qgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qgrid_Dims,qgrid_Rank,  capi_qgrid_intent,qgrid_capi,capi_errmess);
    if (capi_qgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qgrid = (double *)(PyArray_DATA(capi_qgrid_as_array));

    /* Processing variable fc2 */
    ;
    capi_fc2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 5th argument `fc2`";
    capi_fc2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc2_Dims,fc2_Rank,  capi_fc2_intent,fc2_capi,capi_errmess);
    if (capi_fc2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc2 = (double *)(PyArray_DATA(capi_fc2_as_array));

    /* Processing variable rprim */
    rprim_Dims[0]=3,rprim_Dims[1]=3;
    capi_rprim_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 10th argument `rprim`";
    capi_rprim_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rprim_Dims,rprim_Rank,  capi_rprim_intent,rprim_capi,capi_errmess);
    if (capi_rprim_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rprim = (double *)(PyArray_DATA(capi_rprim_as_array));

    /* Processing variable energies */
    ;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 18th argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently() 15th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable classical */
        classical = (int)PyObject_IsTrue(classical_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable nirrqpt */
    if (nirrqpt_capi == Py_None) nirrqpt = shape(irrqgrid, 1); else
        f2py_success = int_from_pyobj(&nirrqpt,nirrqpt_capi,"thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently() 2nd keyword (nirrqpt) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(irrqgrid, 1) == nirrqpt,"shape(irrqgrid, 1) == nirrqpt","2nd keyword nirrqpt","calculate_lifetimes_selfconsistently:nirrqpt=%d",nirrqpt) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(fc2, 1) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently() 3rd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 1) == 3 * nat,"shape(fc2, 1) == 3 * nat","3rd keyword nat","calculate_lifetimes_selfconsistently:nat=%d",nat) {
    /* Processing variable nfc2 */
    if (nfc2_capi == Py_None) nfc2 = shape(fc2, 0); else
        f2py_success = int_from_pyobj(&nfc2,nfc2_capi,"thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently() 4th keyword (nfc2) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 0) == nfc2,"shape(fc2, 0) == nfc2","4th keyword nfc2","calculate_lifetimes_selfconsistently:nfc2=%d",nfc2) {
    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(energies, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently() 1st keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(energies, 0) == ne,"shape(energies, 0) == ne","1st keyword ne","calculate_lifetimes_selfconsistently:ne=%d",ne) {
    /* Processing variable n_events */
    if (n_events_capi == Py_None) n_events = shape(qgrid, 1); else
        f2py_success = int_from_pyobj(&n_events,n_events_capi,"thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently() 6th keyword (n_events) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(qgrid, 1) == n_events,"shape(qgrid, 1) == n_events","6th keyword n_events","calculate_lifetimes_selfconsistently:n_events=%d",n_events) {
    /* Processing variable weights */
    weights_Dims[0]=n_events;
    capi_weights_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 3rd argument `weights`";
    capi_weights_as_array = ndarray_from_pyobj(  NPY_INT,1,weights_Dims,weights_Rank,  capi_weights_intent,weights_capi,capi_errmess);
    if (capi_weights_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        weights = (int *)(PyArray_DATA(capi_weights_as_array));

    /* Processing variable scatt_events */
    scatt_events_Dims[0]=nirrqpt;
    capi_scatt_events_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 4th argument `scatt_events`";
    capi_scatt_events_as_array = ndarray_from_pyobj(  NPY_INT,1,scatt_events_Dims,scatt_events_Rank,  capi_scatt_events_intent,scatt_events_capi,capi_errmess);
    if (capi_scatt_events_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        scatt_events = (int *)(PyArray_DATA(capi_scatt_events_as_array));

    /* Processing variable fc3 */
    fc3_Dims[1]=3 * nat,fc3_Dims[2]=3 * nat,fc3_Dims[3]=3 * nat;
    capi_fc3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 7th argument `fc3`";
    capi_fc3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc3_Dims,fc3_Rank,  capi_fc3_intent,fc3_capi,capi_errmess);
    if (capi_fc3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc3 = (double *)(PyArray_DATA(capi_fc3_as_array));

    /* Processing variable r2_2 */
    r2_2_Dims[0]=3,r2_2_Dims[1]=nfc2;
    capi_r2_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 6th argument `r2_2`";
    capi_r2_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_2_Dims,r2_2_Rank,  capi_r2_2_intent,r2_2_capi,capi_errmess);
    if (capi_r2_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2_2 = (double *)(PyArray_DATA(capi_r2_2_as_array));

    /* Processing variable pos */
    pos_Dims[0]=3,pos_Dims[1]=nat;
    capi_pos_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 11st argument `pos`";
    capi_pos_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,pos_Dims,pos_Rank,  capi_pos_intent,pos_capi,capi_errmess);
    if (capi_pos_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pos = (double *)(PyArray_DATA(capi_pos_as_array));

    /* Processing variable masses */
    masses_Dims[0]=nat;
    capi_masses_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 12nd argument `masses`";
    capi_masses_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,masses_Dims,masses_Rank,  capi_masses_intent,masses_capi,capi_errmess);
    if (capi_masses_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        masses = (double *)(PyArray_DATA(capi_masses_as_array));

    /* Processing variable smear */
    smear_Dims[0]=3 * nat,smear_Dims[1]=nirrqpt;
    capi_smear_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 13rd argument `smear`";
    capi_smear_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_Dims,smear_Rank,  capi_smear_intent,smear_capi,capi_errmess);
    if (capi_smear_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear = (double *)(PyArray_DATA(capi_smear_as_array));

    /* Processing variable smear_id */
    smear_id_Dims[0]=3 * nat,smear_id_Dims[1]=nirrqpt;
    capi_smear_id_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 14th argument `smear_id`";
    capi_smear_id_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_id_Dims,smear_id_Rank,  capi_smear_id_intent,smear_id_capi,capi_errmess);
    if (capi_smear_id_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear_id = (double *)(PyArray_DATA(capi_smear_id_as_array));

    /* Processing variable selfengs */
    selfengs_Dims[0]=nirrqpt,selfengs_Dims[1]=3 * nat;
    capi_selfengs_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the hidden `selfengs`";
    capi_selfengs_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,selfengs_Dims,selfengs_Rank,  capi_selfengs_intent,Py_None,capi_errmess);
    if (capi_selfengs_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        selfengs = (complex_double *)(PyArray_DATA(capi_selfengs_as_array));

    /* Processing variable nfc3 */
    if (nfc3_capi == Py_None) nfc3 = shape(fc3, 0); else
        f2py_success = int_from_pyobj(&nfc3,nfc3_capi,"thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently() 5th keyword (nfc3) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc3, 0) == nfc3,"shape(fc3, 0) == nfc3","5th keyword nfc3","calculate_lifetimes_selfconsistently:nfc3=%d",nfc3) {
    /* Processing variable r3_2 */
    r3_2_Dims[0]=3,r3_2_Dims[1]=nfc3;
    capi_r3_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 8th argument `r3_2`";
    capi_r3_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_2_Dims,r3_2_Rank,  capi_r3_2_intent,r3_2_capi,capi_errmess);
    if (capi_r3_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_2 = (double *)(PyArray_DATA(capi_r3_2_as_array));

    /* Processing variable r3_3 */
    r3_3_Dims[0]=3,r3_3_Dims[1]=nfc3;
    capi_r3_3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_selfconsistently: failed to create array from the 9th argument `r3_3`";
    capi_r3_3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_3_Dims,r3_3_Rank,  capi_r3_3_intent,r3_3_capi,capi_errmess);
    if (capi_r3_3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_3 = (double *)(PyArray_DATA(capi_r3_3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(irrqgrid,qgrid,weights,scatt_events,fc2,r2_2,fc3,r3_2,r3_3,rprim,pos,masses,smear,smear_id,&t,&gaussian,&classical,energies,&ne,&nirrqpt,&nat,&nfc2,&nfc3,&n_events,selfengs);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_selfengs_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_r3_3_as_array!=r3_3_capi) {
        Py_XDECREF(capi_r3_3_as_array); }
    }  /* if (capi_r3_3_as_array == NULL) ... else of r3_3 */
    /* End of cleaning variable r3_3 */
    if((PyObject *)capi_r3_2_as_array!=r3_2_capi) {
        Py_XDECREF(capi_r3_2_as_array); }
    }  /* if (capi_r3_2_as_array == NULL) ... else of r3_2 */
    /* End of cleaning variable r3_2 */
    } /*CHECKSCALAR(shape(fc3, 0) == nfc3)*/
    } /*if (f2py_success) of nfc3*/
    /* End of cleaning variable nfc3 */
    }  /* if (capi_selfengs_as_array == NULL) ... else of selfengs */
    /* End of cleaning variable selfengs */
    if((PyObject *)capi_smear_id_as_array!=smear_id_capi) {
        Py_XDECREF(capi_smear_id_as_array); }
    }  /* if (capi_smear_id_as_array == NULL) ... else of smear_id */
    /* End of cleaning variable smear_id */
    if((PyObject *)capi_smear_as_array!=smear_capi) {
        Py_XDECREF(capi_smear_as_array); }
    }  /* if (capi_smear_as_array == NULL) ... else of smear */
    /* End of cleaning variable smear */
    if((PyObject *)capi_masses_as_array!=masses_capi) {
        Py_XDECREF(capi_masses_as_array); }
    }  /* if (capi_masses_as_array == NULL) ... else of masses */
    /* End of cleaning variable masses */
    if((PyObject *)capi_pos_as_array!=pos_capi) {
        Py_XDECREF(capi_pos_as_array); }
    }  /* if (capi_pos_as_array == NULL) ... else of pos */
    /* End of cleaning variable pos */
    if((PyObject *)capi_r2_2_as_array!=r2_2_capi) {
        Py_XDECREF(capi_r2_2_as_array); }
    }  /* if (capi_r2_2_as_array == NULL) ... else of r2_2 */
    /* End of cleaning variable r2_2 */
    if((PyObject *)capi_fc3_as_array!=fc3_capi) {
        Py_XDECREF(capi_fc3_as_array); }
    }  /* if (capi_fc3_as_array == NULL) ... else of fc3 */
    /* End of cleaning variable fc3 */
    if((PyObject *)capi_scatt_events_as_array!=scatt_events_capi) {
        Py_XDECREF(capi_scatt_events_as_array); }
    }  /* if (capi_scatt_events_as_array == NULL) ... else of scatt_events */
    /* End of cleaning variable scatt_events */
    if((PyObject *)capi_weights_as_array!=weights_capi) {
        Py_XDECREF(capi_weights_as_array); }
    }  /* if (capi_weights_as_array == NULL) ... else of weights */
    /* End of cleaning variable weights */
    } /*CHECKSCALAR(shape(qgrid, 1) == n_events)*/
    } /*if (f2py_success) of n_events*/
    /* End of cleaning variable n_events */
    } /*CHECKSCALAR(shape(energies, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    } /*CHECKSCALAR(shape(fc2, 0) == nfc2)*/
    } /*if (f2py_success) of nfc2*/
    /* End of cleaning variable nfc2 */
    } /*CHECKSCALAR(shape(fc2, 1) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(irrqgrid, 1) == nirrqpt)*/
    } /*if (f2py_success) of nirrqpt*/
    /* End of cleaning variable nirrqpt */
    } /*if (f2py_success) of classical*/
    /* End of cleaning variable classical */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
    if((PyObject *)capi_rprim_as_array!=rprim_capi) {
        Py_XDECREF(capi_rprim_as_array); }
    }  /* if (capi_rprim_as_array == NULL) ... else of rprim */
    /* End of cleaning variable rprim */
    if((PyObject *)capi_fc2_as_array!=fc2_capi) {
        Py_XDECREF(capi_fc2_as_array); }
    }  /* if (capi_fc2_as_array == NULL) ... else of fc2 */
    /* End of cleaning variable fc2 */
    if((PyObject *)capi_qgrid_as_array!=qgrid_capi) {
        Py_XDECREF(capi_qgrid_as_array); }
    }  /* if (capi_qgrid_as_array == NULL) ... else of qgrid */
    /* End of cleaning variable qgrid */
    if((PyObject *)capi_irrqgrid_as_array!=irrqgrid_capi) {
        Py_XDECREF(capi_irrqgrid_as_array); }
    }  /* if (capi_irrqgrid_as_array == NULL) ... else of irrqgrid */
    /* End of cleaning variable irrqgrid */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************** end of calculate_lifetimes_selfconsistently ****************/

/*********************** solve_selfconsistent_equation ***********************/
static char doc_f2py_rout_thermal_conductivity_get_lf_solve_selfconsistent_equation[] = "\
solve_selfconsistent_equation(w_q,self_energy,energies,tau,omega,[ne,nband])\n\nWrapper for ``solve_selfconsistent_equation``.\
\n\nParameters\n----------\n"
"w_q : input rank-1 array('d') with bounds (nband)\n"
"self_energy : input rank-2 array('D') with bounds (ne,nband)\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"tau : in/output rank-1 array('d') with bounds (nband)\n"
"omega : in/output rank-1 array('d') with bounds (nband)\n"
"\nOther Parameters\n----------------\n"
"ne : input int, optional\n    Default: shape(self_energy, 0)\n"
"nband : input int, optional\n    Default: shape(w_q, 0)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_solve_selfconsistent_equation(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,double*,complex_double*,double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int ne = 0;
    PyObject *ne_capi = Py_None;
    int nband = 0;
    PyObject *nband_capi = Py_None;
    double *w_q = NULL;
    npy_intp w_q_Dims[1] = {-1};
    const int w_q_Rank = 1;
    PyArrayObject *capi_w_q_as_array = NULL;
    int capi_w_q_intent = 0;
    PyObject *w_q_capi = Py_None;
    complex_double *self_energy = NULL;
    npy_intp self_energy_Dims[2] = {-1, -1};
    const int self_energy_Rank = 2;
    PyArrayObject *capi_self_energy_as_array = NULL;
    int capi_self_energy_intent = 0;
    PyObject *self_energy_capi = Py_None;
    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    double *tau = NULL;
    npy_intp tau_Dims[1] = {-1};
    const int tau_Rank = 1;
    PyArrayObject *capi_tau_as_array = NULL;
    int capi_tau_intent = 0;
    PyObject *tau_capi = Py_None;
    double *omega = NULL;
    npy_intp omega_Dims[1] = {-1};
    const int omega_Rank = 1;
    PyArrayObject *capi_omega_as_array = NULL;
    int capi_omega_intent = 0;
    PyObject *omega_capi = Py_None;
    static char *capi_kwlist[] = {"w_q","self_energy","energies","tau","omega","ne","nband",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOO|OO:thermal_conductivity.get_lf.solve_selfconsistent_equation",\
        capi_kwlist,&w_q_capi,&self_energy_capi,&energies_capi,&tau_capi,&omega_capi,&ne_capi,&nband_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable w_q */
    ;
    capi_w_q_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.solve_selfconsistent_equation: failed to create array from the 1st argument `w_q`";
    capi_w_q_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,w_q_Dims,w_q_Rank,  capi_w_q_intent,w_q_capi,capi_errmess);
    if (capi_w_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        w_q = (double *)(PyArray_DATA(capi_w_q_as_array));

    /* Processing variable nband */
    if (nband_capi == Py_None) nband = shape(w_q, 0); else
        f2py_success = int_from_pyobj(&nband,nband_capi,"thermal_conductivity.get_lf.solve_selfconsistent_equation() 2nd keyword (nband) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(w_q, 0) == nband,"shape(w_q, 0) == nband","2nd keyword nband","solve_selfconsistent_equation:nband=%d",nband) {
    /* Processing variable self_energy */
    self_energy_Dims[1]=nband;
    capi_self_energy_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.solve_selfconsistent_equation: failed to create array from the 2nd argument `self_energy`";
    capi_self_energy_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,self_energy_Dims,self_energy_Rank,  capi_self_energy_intent,self_energy_capi,capi_errmess);
    if (capi_self_energy_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        self_energy = (complex_double *)(PyArray_DATA(capi_self_energy_as_array));

    /* Processing variable tau */
    tau_Dims[0]=nband;
    capi_tau_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.solve_selfconsistent_equation: failed to create array from the 4th argument `tau`";
    capi_tau_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,tau_Dims,tau_Rank,  capi_tau_intent,tau_capi,capi_errmess);
    if (capi_tau_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        tau = (double *)(PyArray_DATA(capi_tau_as_array));

    /* Processing variable omega */
    omega_Dims[0]=nband;
    capi_omega_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.solve_selfconsistent_equation: failed to create array from the 5th argument `omega`";
    capi_omega_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,omega_Dims,omega_Rank,  capi_omega_intent,omega_capi,capi_errmess);
    if (capi_omega_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        omega = (double *)(PyArray_DATA(capi_omega_as_array));

    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(self_energy, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.get_lf.solve_selfconsistent_equation() 1st keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(self_energy, 0) == ne,"shape(self_energy, 0) == ne","1st keyword ne","solve_selfconsistent_equation:ne=%d",ne) {
    /* Processing variable energies */
    energies_Dims[0]=ne;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.solve_selfconsistent_equation: failed to create array from the 3rd argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&ne,&nband,w_q,self_energy,energies,tau,omega);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
    } /*CHECKSCALAR(shape(self_energy, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    if((PyObject *)capi_omega_as_array!=omega_capi) {
        Py_XDECREF(capi_omega_as_array); }
    }  /* if (capi_omega_as_array == NULL) ... else of omega */
    /* End of cleaning variable omega */
    if((PyObject *)capi_tau_as_array!=tau_capi) {
        Py_XDECREF(capi_tau_as_array); }
    }  /* if (capi_tau_as_array == NULL) ... else of tau */
    /* End of cleaning variable tau */
    if((PyObject *)capi_self_energy_as_array!=self_energy_capi) {
        Py_XDECREF(capi_self_energy_as_array); }
    }  /* if (capi_self_energy_as_array == NULL) ... else of self_energy */
    /* End of cleaning variable self_energy */
    } /*CHECKSCALAR(shape(w_q, 0) == nband)*/
    } /*if (f2py_success) of nband*/
    /* End of cleaning variable nband */
    if((PyObject *)capi_w_q_as_array!=w_q_capi) {
        Py_XDECREF(capi_w_q_as_array); }
    }  /* if (capi_w_q_as_array == NULL) ... else of w_q */
    /* End of cleaning variable w_q */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************** end of solve_selfconsistent_equation ********************/

/*********************** calculate_correlation_function ***********************/
static char doc_f2py_rout_thermal_conductivity_get_lf_calculate_correlation_function[] = "\
calculate_correlation_function(energies,w_q,self_energy,lineshape,[nat,ne])\n\nWrapper for ``calculate_correlation_function``.\
\n\nParameters\n----------\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"w_q : input rank-1 array('d') with bounds (3 * nat)\n"
"self_energy : input rank-2 array('D') with bounds (ne,3 * nat)\n"
"lineshape : in/output rank-2 array('d') with bounds (ne,3 * nat)\n"
"\nOther Parameters\n----------------\n"
"nat : input int, optional\n    Default: shape(w_q, 0) / 3\n"
"ne : input int, optional\n    Default: shape(energies, 0)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_calculate_correlation_function(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,complex_double*,int*,int*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    double *w_q = NULL;
    npy_intp w_q_Dims[1] = {-1};
    const int w_q_Rank = 1;
    PyArrayObject *capi_w_q_as_array = NULL;
    int capi_w_q_intent = 0;
    PyObject *w_q_capi = Py_None;
    complex_double *self_energy = NULL;
    npy_intp self_energy_Dims[2] = {-1, -1};
    const int self_energy_Rank = 2;
    PyArrayObject *capi_self_energy_as_array = NULL;
    int capi_self_energy_intent = 0;
    PyObject *self_energy_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    double *lineshape = NULL;
    npy_intp lineshape_Dims[2] = {-1, -1};
    const int lineshape_Rank = 2;
    PyArrayObject *capi_lineshape_as_array = NULL;
    int capi_lineshape_intent = 0;
    PyObject *lineshape_capi = Py_None;
    static char *capi_kwlist[] = {"energies","w_q","self_energy","lineshape","nat","ne",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOO|OO:thermal_conductivity.get_lf.calculate_correlation_function",\
        capi_kwlist,&energies_capi,&w_q_capi,&self_energy_capi,&lineshape_capi,&nat_capi,&ne_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable w_q */
    ;
    capi_w_q_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_correlation_function: failed to create array from the 2nd argument `w_q`";
    capi_w_q_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,w_q_Dims,w_q_Rank,  capi_w_q_intent,w_q_capi,capi_errmess);
    if (capi_w_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        w_q = (double *)(PyArray_DATA(capi_w_q_as_array));

    /* Processing variable energies */
    ;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_correlation_function: failed to create array from the 1st argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(w_q, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.get_lf.calculate_correlation_function() 1st keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(w_q, 0) == 3 * nat,"shape(w_q, 0) == 3 * nat","1st keyword nat","calculate_correlation_function:nat=%d",nat) {
    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(energies, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.get_lf.calculate_correlation_function() 2nd keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(energies, 0) == ne,"shape(energies, 0) == ne","2nd keyword ne","calculate_correlation_function:ne=%d",ne) {
    /* Processing variable self_energy */
    self_energy_Dims[0]=ne,self_energy_Dims[1]=3 * nat;
    capi_self_energy_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_correlation_function: failed to create array from the 3rd argument `self_energy`";
    capi_self_energy_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,self_energy_Dims,self_energy_Rank,  capi_self_energy_intent,self_energy_capi,capi_errmess);
    if (capi_self_energy_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        self_energy = (complex_double *)(PyArray_DATA(capi_self_energy_as_array));

    /* Processing variable lineshape */
    lineshape_Dims[0]=ne,lineshape_Dims[1]=3 * nat;
    capi_lineshape_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_correlation_function: failed to create array from the 4th argument `lineshape`";
    capi_lineshape_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,lineshape_Dims,lineshape_Rank,  capi_lineshape_intent,lineshape_capi,capi_errmess);
    if (capi_lineshape_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        lineshape = (double *)(PyArray_DATA(capi_lineshape_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(energies,w_q,self_energy,&nat,&ne,lineshape);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_lineshape_as_array!=lineshape_capi) {
        Py_XDECREF(capi_lineshape_as_array); }
    }  /* if (capi_lineshape_as_array == NULL) ... else of lineshape */
    /* End of cleaning variable lineshape */
    if((PyObject *)capi_self_energy_as_array!=self_energy_capi) {
        Py_XDECREF(capi_self_energy_as_array); }
    }  /* if (capi_self_energy_as_array == NULL) ... else of self_energy */
    /* End of cleaning variable self_energy */
    } /*CHECKSCALAR(shape(energies, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    } /*CHECKSCALAR(shape(w_q, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
    if((PyObject *)capi_w_q_as_array!=w_q_capi) {
        Py_XDECREF(capi_w_q_as_array); }
    }  /* if (capi_w_q_as_array == NULL) ... else of w_q */
    /* End of cleaning variable w_q */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************* end of calculate_correlation_function *******************/

/********************** calculate_lifetimes_perturbative **********************/
static char doc_f2py_rout_thermal_conductivity_get_lf_calculate_lifetimes_perturbative[] = "\
self_energies = calculate_lifetimes_perturbative(irrqgrid,qgrid,weights,scatt_events,fc2,r2_2,fc3,r3_2,r3_3,rprim,pos,masses,smear,t,gaussian,classical,[nirrqpt,nat,nfc2,nfc3,n_events])\n\nWrapper for ``calculate_lifetimes_perturbative``.\
\n\nParameters\n----------\n"
"irrqgrid : input rank-2 array('d') with bounds (3,nirrqpt)\n"
"qgrid : input rank-2 array('d') with bounds (3,n_events)\n"
"weights : input rank-1 array('i') with bounds (n_events)\n"
"scatt_events : input rank-1 array('i') with bounds (nirrqpt)\n"
"fc2 : input rank-3 array('d') with bounds (nfc2,3 * nat,3 * nat)\n"
"r2_2 : input rank-2 array('d') with bounds (3,nfc2)\n"
"fc3 : input rank-4 array('d') with bounds (nfc3,3 * nat,3 * nat,3 * nat)\n"
"r3_2 : input rank-2 array('d') with bounds (3,nfc3)\n"
"r3_3 : input rank-2 array('d') with bounds (3,nfc3)\n"
"rprim : input rank-2 array('d') with bounds (3,3)\n"
"pos : input rank-2 array('d') with bounds (3,nat)\n"
"masses : input rank-1 array('d') with bounds (nat)\n"
"smear : input rank-2 array('d') with bounds (3 * nat,nirrqpt)\n"
"t : input float\n"
"gaussian : input int\n"
"classical : input int\n"
"\nOther Parameters\n----------------\n"
"nirrqpt : input int, optional\n    Default: shape(irrqgrid, 1)\n"
"nat : input int, optional\n    Default: shape(fc2, 1) / 3\n"
"nfc2 : input int, optional\n    Default: shape(fc2, 0)\n"
"nfc3 : input int, optional\n    Default: shape(fc3, 0)\n"
"n_events : input int, optional\n    Default: shape(qgrid, 1)\n"
"\nReturns\n-------\n"
"self_energies : rank-2 array('D') with bounds (nirrqpt,3 * nat)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_calculate_lifetimes_perturbative(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,int*,int*,int*,int*,int*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *irrqgrid = NULL;
    npy_intp irrqgrid_Dims[2] = {-1, -1};
    const int irrqgrid_Rank = 2;
    PyArrayObject *capi_irrqgrid_as_array = NULL;
    int capi_irrqgrid_intent = 0;
    PyObject *irrqgrid_capi = Py_None;
    double *qgrid = NULL;
    npy_intp qgrid_Dims[2] = {-1, -1};
    const int qgrid_Rank = 2;
    PyArrayObject *capi_qgrid_as_array = NULL;
    int capi_qgrid_intent = 0;
    PyObject *qgrid_capi = Py_None;
    int *weights = NULL;
    npy_intp weights_Dims[1] = {-1};
    const int weights_Rank = 1;
    PyArrayObject *capi_weights_as_array = NULL;
    int capi_weights_intent = 0;
    PyObject *weights_capi = Py_None;
    int *scatt_events = NULL;
    npy_intp scatt_events_Dims[1] = {-1};
    const int scatt_events_Rank = 1;
    PyArrayObject *capi_scatt_events_as_array = NULL;
    int capi_scatt_events_intent = 0;
    PyObject *scatt_events_capi = Py_None;
    double *fc2 = NULL;
    npy_intp fc2_Dims[3] = {-1, -1, -1};
    const int fc2_Rank = 3;
    PyArrayObject *capi_fc2_as_array = NULL;
    int capi_fc2_intent = 0;
    PyObject *fc2_capi = Py_None;
    double *r2_2 = NULL;
    npy_intp r2_2_Dims[2] = {-1, -1};
    const int r2_2_Rank = 2;
    PyArrayObject *capi_r2_2_as_array = NULL;
    int capi_r2_2_intent = 0;
    PyObject *r2_2_capi = Py_None;
    double *fc3 = NULL;
    npy_intp fc3_Dims[4] = {-1, -1, -1, -1};
    const int fc3_Rank = 4;
    PyArrayObject *capi_fc3_as_array = NULL;
    int capi_fc3_intent = 0;
    PyObject *fc3_capi = Py_None;
    double *r3_2 = NULL;
    npy_intp r3_2_Dims[2] = {-1, -1};
    const int r3_2_Rank = 2;
    PyArrayObject *capi_r3_2_as_array = NULL;
    int capi_r3_2_intent = 0;
    PyObject *r3_2_capi = Py_None;
    double *r3_3 = NULL;
    npy_intp r3_3_Dims[2] = {-1, -1};
    const int r3_3_Rank = 2;
    PyArrayObject *capi_r3_3_as_array = NULL;
    int capi_r3_3_intent = 0;
    PyObject *r3_3_capi = Py_None;
    double *rprim = NULL;
    npy_intp rprim_Dims[2] = {-1, -1};
    const int rprim_Rank = 2;
    PyArrayObject *capi_rprim_as_array = NULL;
    int capi_rprim_intent = 0;
    PyObject *rprim_capi = Py_None;
    double *pos = NULL;
    npy_intp pos_Dims[2] = {-1, -1};
    const int pos_Rank = 2;
    PyArrayObject *capi_pos_as_array = NULL;
    int capi_pos_intent = 0;
    PyObject *pos_capi = Py_None;
    double *masses = NULL;
    npy_intp masses_Dims[1] = {-1};
    const int masses_Rank = 1;
    PyArrayObject *capi_masses_as_array = NULL;
    int capi_masses_intent = 0;
    PyObject *masses_capi = Py_None;
    double *smear = NULL;
    npy_intp smear_Dims[2] = {-1, -1};
    const int smear_Rank = 2;
    PyArrayObject *capi_smear_as_array = NULL;
    int capi_smear_intent = 0;
    PyObject *smear_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    int classical = 0;
    PyObject *classical_capi = Py_None;
    int nirrqpt = 0;
    PyObject *nirrqpt_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int nfc2 = 0;
    PyObject *nfc2_capi = Py_None;
    int nfc3 = 0;
    PyObject *nfc3_capi = Py_None;
    int n_events = 0;
    PyObject *n_events_capi = Py_None;
    complex_double *self_energies = NULL;
    npy_intp self_energies_Dims[2] = {-1, -1};
    const int self_energies_Rank = 2;
    PyArrayObject *capi_self_energies_as_array = NULL;
    int capi_self_energies_intent = 0;
    static char *capi_kwlist[] = {"irrqgrid","qgrid","weights","scatt_events","fc2","r2_2","fc3","r3_2","r3_3","rprim","pos","masses","smear","t","gaussian","classical","nirrqpt","nat","nfc2","nfc3","n_events",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOOOOOOOO|OOOOO:thermal_conductivity.get_lf.calculate_lifetimes_perturbative",\
        capi_kwlist,&irrqgrid_capi,&qgrid_capi,&weights_capi,&scatt_events_capi,&fc2_capi,&r2_2_capi,&fc3_capi,&r3_2_capi,&r3_3_capi,&rprim_capi,&pos_capi,&masses_capi,&smear_capi,&t_capi,&gaussian_capi,&classical_capi,&nirrqpt_capi,&nat_capi,&nfc2_capi,&nfc3_capi,&n_events_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable irrqgrid */
    irrqgrid_Dims[0]=3;
    capi_irrqgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 1st argument `irrqgrid`";
    capi_irrqgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,irrqgrid_Dims,irrqgrid_Rank,  capi_irrqgrid_intent,irrqgrid_capi,capi_errmess);
    if (capi_irrqgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        irrqgrid = (double *)(PyArray_DATA(capi_irrqgrid_as_array));

    /* Processing variable qgrid */
    qgrid_Dims[0]=3;
    capi_qgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 2nd argument `qgrid`";
    capi_qgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qgrid_Dims,qgrid_Rank,  capi_qgrid_intent,qgrid_capi,capi_errmess);
    if (capi_qgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qgrid = (double *)(PyArray_DATA(capi_qgrid_as_array));

    /* Processing variable fc2 */
    ;
    capi_fc2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 5th argument `fc2`";
    capi_fc2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc2_Dims,fc2_Rank,  capi_fc2_intent,fc2_capi,capi_errmess);
    if (capi_fc2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc2 = (double *)(PyArray_DATA(capi_fc2_as_array));

    /* Processing variable rprim */
    rprim_Dims[0]=3,rprim_Dims[1]=3;
    capi_rprim_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 10th argument `rprim`";
    capi_rprim_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rprim_Dims,rprim_Rank,  capi_rprim_intent,rprim_capi,capi_errmess);
    if (capi_rprim_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rprim = (double *)(PyArray_DATA(capi_rprim_as_array));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.get_lf.calculate_lifetimes_perturbative() 14th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable classical */
        classical = (int)PyObject_IsTrue(classical_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable nirrqpt */
    if (nirrqpt_capi == Py_None) nirrqpt = shape(irrqgrid, 1); else
        f2py_success = int_from_pyobj(&nirrqpt,nirrqpt_capi,"thermal_conductivity.get_lf.calculate_lifetimes_perturbative() 1st keyword (nirrqpt) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(irrqgrid, 1) == nirrqpt,"shape(irrqgrid, 1) == nirrqpt","1st keyword nirrqpt","calculate_lifetimes_perturbative:nirrqpt=%d",nirrqpt) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(fc2, 1) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.get_lf.calculate_lifetimes_perturbative() 2nd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 1) == 3 * nat,"shape(fc2, 1) == 3 * nat","2nd keyword nat","calculate_lifetimes_perturbative:nat=%d",nat) {
    /* Processing variable nfc2 */
    if (nfc2_capi == Py_None) nfc2 = shape(fc2, 0); else
        f2py_success = int_from_pyobj(&nfc2,nfc2_capi,"thermal_conductivity.get_lf.calculate_lifetimes_perturbative() 3rd keyword (nfc2) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 0) == nfc2,"shape(fc2, 0) == nfc2","3rd keyword nfc2","calculate_lifetimes_perturbative:nfc2=%d",nfc2) {
    /* Processing variable n_events */
    if (n_events_capi == Py_None) n_events = shape(qgrid, 1); else
        f2py_success = int_from_pyobj(&n_events,n_events_capi,"thermal_conductivity.get_lf.calculate_lifetimes_perturbative() 5th keyword (n_events) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(qgrid, 1) == n_events,"shape(qgrid, 1) == n_events","5th keyword n_events","calculate_lifetimes_perturbative:n_events=%d",n_events) {
    /* Processing variable weights */
    weights_Dims[0]=n_events;
    capi_weights_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 3rd argument `weights`";
    capi_weights_as_array = ndarray_from_pyobj(  NPY_INT,1,weights_Dims,weights_Rank,  capi_weights_intent,weights_capi,capi_errmess);
    if (capi_weights_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        weights = (int *)(PyArray_DATA(capi_weights_as_array));

    /* Processing variable scatt_events */
    scatt_events_Dims[0]=nirrqpt;
    capi_scatt_events_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 4th argument `scatt_events`";
    capi_scatt_events_as_array = ndarray_from_pyobj(  NPY_INT,1,scatt_events_Dims,scatt_events_Rank,  capi_scatt_events_intent,scatt_events_capi,capi_errmess);
    if (capi_scatt_events_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        scatt_events = (int *)(PyArray_DATA(capi_scatt_events_as_array));

    /* Processing variable fc3 */
    fc3_Dims[1]=3 * nat,fc3_Dims[2]=3 * nat,fc3_Dims[3]=3 * nat;
    capi_fc3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 7th argument `fc3`";
    capi_fc3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc3_Dims,fc3_Rank,  capi_fc3_intent,fc3_capi,capi_errmess);
    if (capi_fc3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc3 = (double *)(PyArray_DATA(capi_fc3_as_array));

    /* Processing variable r2_2 */
    r2_2_Dims[0]=3,r2_2_Dims[1]=nfc2;
    capi_r2_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 6th argument `r2_2`";
    capi_r2_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_2_Dims,r2_2_Rank,  capi_r2_2_intent,r2_2_capi,capi_errmess);
    if (capi_r2_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2_2 = (double *)(PyArray_DATA(capi_r2_2_as_array));

    /* Processing variable pos */
    pos_Dims[0]=3,pos_Dims[1]=nat;
    capi_pos_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 11st argument `pos`";
    capi_pos_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,pos_Dims,pos_Rank,  capi_pos_intent,pos_capi,capi_errmess);
    if (capi_pos_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pos = (double *)(PyArray_DATA(capi_pos_as_array));

    /* Processing variable masses */
    masses_Dims[0]=nat;
    capi_masses_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 12nd argument `masses`";
    capi_masses_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,masses_Dims,masses_Rank,  capi_masses_intent,masses_capi,capi_errmess);
    if (capi_masses_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        masses = (double *)(PyArray_DATA(capi_masses_as_array));

    /* Processing variable smear */
    smear_Dims[0]=3 * nat,smear_Dims[1]=nirrqpt;
    capi_smear_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 13rd argument `smear`";
    capi_smear_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_Dims,smear_Rank,  capi_smear_intent,smear_capi,capi_errmess);
    if (capi_smear_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear = (double *)(PyArray_DATA(capi_smear_as_array));

    /* Processing variable self_energies */
    self_energies_Dims[0]=nirrqpt,self_energies_Dims[1]=3 * nat;
    capi_self_energies_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the hidden `self_energies`";
    capi_self_energies_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,self_energies_Dims,self_energies_Rank,  capi_self_energies_intent,Py_None,capi_errmess);
    if (capi_self_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        self_energies = (complex_double *)(PyArray_DATA(capi_self_energies_as_array));

    /* Processing variable nfc3 */
    if (nfc3_capi == Py_None) nfc3 = shape(fc3, 0); else
        f2py_success = int_from_pyobj(&nfc3,nfc3_capi,"thermal_conductivity.get_lf.calculate_lifetimes_perturbative() 4th keyword (nfc3) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc3, 0) == nfc3,"shape(fc3, 0) == nfc3","4th keyword nfc3","calculate_lifetimes_perturbative:nfc3=%d",nfc3) {
    /* Processing variable r3_2 */
    r3_2_Dims[0]=3,r3_2_Dims[1]=nfc3;
    capi_r3_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 8th argument `r3_2`";
    capi_r3_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_2_Dims,r3_2_Rank,  capi_r3_2_intent,r3_2_capi,capi_errmess);
    if (capi_r3_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_2 = (double *)(PyArray_DATA(capi_r3_2_as_array));

    /* Processing variable r3_3 */
    r3_3_Dims[0]=3,r3_3_Dims[1]=nfc3;
    capi_r3_3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes_perturbative: failed to create array from the 9th argument `r3_3`";
    capi_r3_3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_3_Dims,r3_3_Rank,  capi_r3_3_intent,r3_3_capi,capi_errmess);
    if (capi_r3_3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_3 = (double *)(PyArray_DATA(capi_r3_3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(irrqgrid,qgrid,weights,scatt_events,fc2,r2_2,fc3,r3_2,r3_3,rprim,pos,masses,smear,&t,&gaussian,&classical,&nirrqpt,&nat,&nfc2,&nfc3,&n_events,self_energies);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_self_energies_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_r3_3_as_array!=r3_3_capi) {
        Py_XDECREF(capi_r3_3_as_array); }
    }  /* if (capi_r3_3_as_array == NULL) ... else of r3_3 */
    /* End of cleaning variable r3_3 */
    if((PyObject *)capi_r3_2_as_array!=r3_2_capi) {
        Py_XDECREF(capi_r3_2_as_array); }
    }  /* if (capi_r3_2_as_array == NULL) ... else of r3_2 */
    /* End of cleaning variable r3_2 */
    } /*CHECKSCALAR(shape(fc3, 0) == nfc3)*/
    } /*if (f2py_success) of nfc3*/
    /* End of cleaning variable nfc3 */
    }  /* if (capi_self_energies_as_array == NULL) ... else of self_energies */
    /* End of cleaning variable self_energies */
    if((PyObject *)capi_smear_as_array!=smear_capi) {
        Py_XDECREF(capi_smear_as_array); }
    }  /* if (capi_smear_as_array == NULL) ... else of smear */
    /* End of cleaning variable smear */
    if((PyObject *)capi_masses_as_array!=masses_capi) {
        Py_XDECREF(capi_masses_as_array); }
    }  /* if (capi_masses_as_array == NULL) ... else of masses */
    /* End of cleaning variable masses */
    if((PyObject *)capi_pos_as_array!=pos_capi) {
        Py_XDECREF(capi_pos_as_array); }
    }  /* if (capi_pos_as_array == NULL) ... else of pos */
    /* End of cleaning variable pos */
    if((PyObject *)capi_r2_2_as_array!=r2_2_capi) {
        Py_XDECREF(capi_r2_2_as_array); }
    }  /* if (capi_r2_2_as_array == NULL) ... else of r2_2 */
    /* End of cleaning variable r2_2 */
    if((PyObject *)capi_fc3_as_array!=fc3_capi) {
        Py_XDECREF(capi_fc3_as_array); }
    }  /* if (capi_fc3_as_array == NULL) ... else of fc3 */
    /* End of cleaning variable fc3 */
    if((PyObject *)capi_scatt_events_as_array!=scatt_events_capi) {
        Py_XDECREF(capi_scatt_events_as_array); }
    }  /* if (capi_scatt_events_as_array == NULL) ... else of scatt_events */
    /* End of cleaning variable scatt_events */
    if((PyObject *)capi_weights_as_array!=weights_capi) {
        Py_XDECREF(capi_weights_as_array); }
    }  /* if (capi_weights_as_array == NULL) ... else of weights */
    /* End of cleaning variable weights */
    } /*CHECKSCALAR(shape(qgrid, 1) == n_events)*/
    } /*if (f2py_success) of n_events*/
    /* End of cleaning variable n_events */
    } /*CHECKSCALAR(shape(fc2, 0) == nfc2)*/
    } /*if (f2py_success) of nfc2*/
    /* End of cleaning variable nfc2 */
    } /*CHECKSCALAR(shape(fc2, 1) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(irrqgrid, 1) == nirrqpt)*/
    } /*if (f2py_success) of nirrqpt*/
    /* End of cleaning variable nirrqpt */
    } /*if (f2py_success) of classical*/
    /* End of cleaning variable classical */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_rprim_as_array!=rprim_capi) {
        Py_XDECREF(capi_rprim_as_array); }
    }  /* if (capi_rprim_as_array == NULL) ... else of rprim */
    /* End of cleaning variable rprim */
    if((PyObject *)capi_fc2_as_array!=fc2_capi) {
        Py_XDECREF(capi_fc2_as_array); }
    }  /* if (capi_fc2_as_array == NULL) ... else of fc2 */
    /* End of cleaning variable fc2 */
    if((PyObject *)capi_qgrid_as_array!=qgrid_capi) {
        Py_XDECREF(capi_qgrid_as_array); }
    }  /* if (capi_qgrid_as_array == NULL) ... else of qgrid */
    /* End of cleaning variable qgrid */
    if((PyObject *)capi_irrqgrid_as_array!=irrqgrid_capi) {
        Py_XDECREF(capi_irrqgrid_as_array); }
    }  /* if (capi_irrqgrid_as_array == NULL) ... else of irrqgrid */
    /* End of cleaning variable irrqgrid */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/****************** end of calculate_lifetimes_perturbative ******************/

/**************************** calculate_lifetimes ****************************/
static char doc_f2py_rout_thermal_conductivity_get_lf_calculate_lifetimes[] = "\
self_energies = calculate_lifetimes(irrqgrid,qgrid,weights,scatt_events,fc2,r2_2,fc3,r3_2,r3_3,rprim,pos,masses,smear,t,gaussian,classical,[nirrqpt,nat,nfc2,nfc3,n_events])\n\nWrapper for ``calculate_lifetimes``.\
\n\nParameters\n----------\n"
"irrqgrid : input rank-2 array('d') with bounds (3,nirrqpt)\n"
"qgrid : input rank-2 array('d') with bounds (3,n_events)\n"
"weights : input rank-1 array('i') with bounds (n_events)\n"
"scatt_events : input rank-1 array('i') with bounds (nirrqpt)\n"
"fc2 : input rank-3 array('d') with bounds (nfc2,3 * nat,3 * nat)\n"
"r2_2 : input rank-2 array('d') with bounds (3,nfc2)\n"
"fc3 : input rank-4 array('d') with bounds (nfc3,3 * nat,3 * nat,3 * nat)\n"
"r3_2 : input rank-2 array('d') with bounds (3,nfc3)\n"
"r3_3 : input rank-2 array('d') with bounds (3,nfc3)\n"
"rprim : input rank-2 array('d') with bounds (3,3)\n"
"pos : input rank-2 array('d') with bounds (3,nat)\n"
"masses : input rank-1 array('d') with bounds (nat)\n"
"smear : input rank-2 array('d') with bounds (3 * nat,nirrqpt)\n"
"t : input float\n"
"gaussian : input int\n"
"classical : input int\n"
"\nOther Parameters\n----------------\n"
"nirrqpt : input int, optional\n    Default: shape(irrqgrid, 1)\n"
"nat : input int, optional\n    Default: shape(fc2, 1) / 3\n"
"nfc2 : input int, optional\n    Default: shape(fc2, 0)\n"
"nfc3 : input int, optional\n    Default: shape(fc3, 0)\n"
"n_events : input int, optional\n    Default: shape(qgrid, 1)\n"
"\nReturns\n-------\n"
"self_energies : rank-2 array('D') with bounds (nirrqpt,3 * nat)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_calculate_lifetimes(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,int*,int*,int*,int*,int*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *irrqgrid = NULL;
    npy_intp irrqgrid_Dims[2] = {-1, -1};
    const int irrqgrid_Rank = 2;
    PyArrayObject *capi_irrqgrid_as_array = NULL;
    int capi_irrqgrid_intent = 0;
    PyObject *irrqgrid_capi = Py_None;
    double *qgrid = NULL;
    npy_intp qgrid_Dims[2] = {-1, -1};
    const int qgrid_Rank = 2;
    PyArrayObject *capi_qgrid_as_array = NULL;
    int capi_qgrid_intent = 0;
    PyObject *qgrid_capi = Py_None;
    int *weights = NULL;
    npy_intp weights_Dims[1] = {-1};
    const int weights_Rank = 1;
    PyArrayObject *capi_weights_as_array = NULL;
    int capi_weights_intent = 0;
    PyObject *weights_capi = Py_None;
    int *scatt_events = NULL;
    npy_intp scatt_events_Dims[1] = {-1};
    const int scatt_events_Rank = 1;
    PyArrayObject *capi_scatt_events_as_array = NULL;
    int capi_scatt_events_intent = 0;
    PyObject *scatt_events_capi = Py_None;
    double *fc2 = NULL;
    npy_intp fc2_Dims[3] = {-1, -1, -1};
    const int fc2_Rank = 3;
    PyArrayObject *capi_fc2_as_array = NULL;
    int capi_fc2_intent = 0;
    PyObject *fc2_capi = Py_None;
    double *r2_2 = NULL;
    npy_intp r2_2_Dims[2] = {-1, -1};
    const int r2_2_Rank = 2;
    PyArrayObject *capi_r2_2_as_array = NULL;
    int capi_r2_2_intent = 0;
    PyObject *r2_2_capi = Py_None;
    double *fc3 = NULL;
    npy_intp fc3_Dims[4] = {-1, -1, -1, -1};
    const int fc3_Rank = 4;
    PyArrayObject *capi_fc3_as_array = NULL;
    int capi_fc3_intent = 0;
    PyObject *fc3_capi = Py_None;
    double *r3_2 = NULL;
    npy_intp r3_2_Dims[2] = {-1, -1};
    const int r3_2_Rank = 2;
    PyArrayObject *capi_r3_2_as_array = NULL;
    int capi_r3_2_intent = 0;
    PyObject *r3_2_capi = Py_None;
    double *r3_3 = NULL;
    npy_intp r3_3_Dims[2] = {-1, -1};
    const int r3_3_Rank = 2;
    PyArrayObject *capi_r3_3_as_array = NULL;
    int capi_r3_3_intent = 0;
    PyObject *r3_3_capi = Py_None;
    double *rprim = NULL;
    npy_intp rprim_Dims[2] = {-1, -1};
    const int rprim_Rank = 2;
    PyArrayObject *capi_rprim_as_array = NULL;
    int capi_rprim_intent = 0;
    PyObject *rprim_capi = Py_None;
    double *pos = NULL;
    npy_intp pos_Dims[2] = {-1, -1};
    const int pos_Rank = 2;
    PyArrayObject *capi_pos_as_array = NULL;
    int capi_pos_intent = 0;
    PyObject *pos_capi = Py_None;
    double *masses = NULL;
    npy_intp masses_Dims[1] = {-1};
    const int masses_Rank = 1;
    PyArrayObject *capi_masses_as_array = NULL;
    int capi_masses_intent = 0;
    PyObject *masses_capi = Py_None;
    double *smear = NULL;
    npy_intp smear_Dims[2] = {-1, -1};
    const int smear_Rank = 2;
    PyArrayObject *capi_smear_as_array = NULL;
    int capi_smear_intent = 0;
    PyObject *smear_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    int classical = 0;
    PyObject *classical_capi = Py_None;
    int nirrqpt = 0;
    PyObject *nirrqpt_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int nfc2 = 0;
    PyObject *nfc2_capi = Py_None;
    int nfc3 = 0;
    PyObject *nfc3_capi = Py_None;
    int n_events = 0;
    PyObject *n_events_capi = Py_None;
    complex_double *self_energies = NULL;
    npy_intp self_energies_Dims[2] = {-1, -1};
    const int self_energies_Rank = 2;
    PyArrayObject *capi_self_energies_as_array = NULL;
    int capi_self_energies_intent = 0;
    static char *capi_kwlist[] = {"irrqgrid","qgrid","weights","scatt_events","fc2","r2_2","fc3","r3_2","r3_3","rprim","pos","masses","smear","t","gaussian","classical","nirrqpt","nat","nfc2","nfc3","n_events",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOOOOOOOO|OOOOO:thermal_conductivity.get_lf.calculate_lifetimes",\
        capi_kwlist,&irrqgrid_capi,&qgrid_capi,&weights_capi,&scatt_events_capi,&fc2_capi,&r2_2_capi,&fc3_capi,&r3_2_capi,&r3_3_capi,&rprim_capi,&pos_capi,&masses_capi,&smear_capi,&t_capi,&gaussian_capi,&classical_capi,&nirrqpt_capi,&nat_capi,&nfc2_capi,&nfc3_capi,&n_events_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable irrqgrid */
    irrqgrid_Dims[0]=3;
    capi_irrqgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 1st argument `irrqgrid`";
    capi_irrqgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,irrqgrid_Dims,irrqgrid_Rank,  capi_irrqgrid_intent,irrqgrid_capi,capi_errmess);
    if (capi_irrqgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        irrqgrid = (double *)(PyArray_DATA(capi_irrqgrid_as_array));

    /* Processing variable qgrid */
    qgrid_Dims[0]=3;
    capi_qgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 2nd argument `qgrid`";
    capi_qgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qgrid_Dims,qgrid_Rank,  capi_qgrid_intent,qgrid_capi,capi_errmess);
    if (capi_qgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qgrid = (double *)(PyArray_DATA(capi_qgrid_as_array));

    /* Processing variable fc2 */
    ;
    capi_fc2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 5th argument `fc2`";
    capi_fc2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc2_Dims,fc2_Rank,  capi_fc2_intent,fc2_capi,capi_errmess);
    if (capi_fc2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc2 = (double *)(PyArray_DATA(capi_fc2_as_array));

    /* Processing variable rprim */
    rprim_Dims[0]=3,rprim_Dims[1]=3;
    capi_rprim_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 10th argument `rprim`";
    capi_rprim_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rprim_Dims,rprim_Rank,  capi_rprim_intent,rprim_capi,capi_errmess);
    if (capi_rprim_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rprim = (double *)(PyArray_DATA(capi_rprim_as_array));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.get_lf.calculate_lifetimes() 14th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable classical */
        classical = (int)PyObject_IsTrue(classical_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable nirrqpt */
    if (nirrqpt_capi == Py_None) nirrqpt = shape(irrqgrid, 1); else
        f2py_success = int_from_pyobj(&nirrqpt,nirrqpt_capi,"thermal_conductivity.get_lf.calculate_lifetimes() 1st keyword (nirrqpt) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(irrqgrid, 1) == nirrqpt,"shape(irrqgrid, 1) == nirrqpt","1st keyword nirrqpt","calculate_lifetimes:nirrqpt=%d",nirrqpt) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(fc2, 1) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.get_lf.calculate_lifetimes() 2nd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 1) == 3 * nat,"shape(fc2, 1) == 3 * nat","2nd keyword nat","calculate_lifetimes:nat=%d",nat) {
    /* Processing variable nfc2 */
    if (nfc2_capi == Py_None) nfc2 = shape(fc2, 0); else
        f2py_success = int_from_pyobj(&nfc2,nfc2_capi,"thermal_conductivity.get_lf.calculate_lifetimes() 3rd keyword (nfc2) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 0) == nfc2,"shape(fc2, 0) == nfc2","3rd keyword nfc2","calculate_lifetimes:nfc2=%d",nfc2) {
    /* Processing variable n_events */
    if (n_events_capi == Py_None) n_events = shape(qgrid, 1); else
        f2py_success = int_from_pyobj(&n_events,n_events_capi,"thermal_conductivity.get_lf.calculate_lifetimes() 5th keyword (n_events) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(qgrid, 1) == n_events,"shape(qgrid, 1) == n_events","5th keyword n_events","calculate_lifetimes:n_events=%d",n_events) {
    /* Processing variable weights */
    weights_Dims[0]=n_events;
    capi_weights_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 3rd argument `weights`";
    capi_weights_as_array = ndarray_from_pyobj(  NPY_INT,1,weights_Dims,weights_Rank,  capi_weights_intent,weights_capi,capi_errmess);
    if (capi_weights_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        weights = (int *)(PyArray_DATA(capi_weights_as_array));

    /* Processing variable scatt_events */
    scatt_events_Dims[0]=nirrqpt;
    capi_scatt_events_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 4th argument `scatt_events`";
    capi_scatt_events_as_array = ndarray_from_pyobj(  NPY_INT,1,scatt_events_Dims,scatt_events_Rank,  capi_scatt_events_intent,scatt_events_capi,capi_errmess);
    if (capi_scatt_events_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        scatt_events = (int *)(PyArray_DATA(capi_scatt_events_as_array));

    /* Processing variable fc3 */
    fc3_Dims[1]=3 * nat,fc3_Dims[2]=3 * nat,fc3_Dims[3]=3 * nat;
    capi_fc3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 7th argument `fc3`";
    capi_fc3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc3_Dims,fc3_Rank,  capi_fc3_intent,fc3_capi,capi_errmess);
    if (capi_fc3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc3 = (double *)(PyArray_DATA(capi_fc3_as_array));

    /* Processing variable r2_2 */
    r2_2_Dims[0]=3,r2_2_Dims[1]=nfc2;
    capi_r2_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 6th argument `r2_2`";
    capi_r2_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_2_Dims,r2_2_Rank,  capi_r2_2_intent,r2_2_capi,capi_errmess);
    if (capi_r2_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2_2 = (double *)(PyArray_DATA(capi_r2_2_as_array));

    /* Processing variable pos */
    pos_Dims[0]=3,pos_Dims[1]=nat;
    capi_pos_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 11st argument `pos`";
    capi_pos_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,pos_Dims,pos_Rank,  capi_pos_intent,pos_capi,capi_errmess);
    if (capi_pos_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pos = (double *)(PyArray_DATA(capi_pos_as_array));

    /* Processing variable masses */
    masses_Dims[0]=nat;
    capi_masses_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 12nd argument `masses`";
    capi_masses_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,masses_Dims,masses_Rank,  capi_masses_intent,masses_capi,capi_errmess);
    if (capi_masses_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        masses = (double *)(PyArray_DATA(capi_masses_as_array));

    /* Processing variable smear */
    smear_Dims[0]=3 * nat,smear_Dims[1]=nirrqpt;
    capi_smear_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 13rd argument `smear`";
    capi_smear_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_Dims,smear_Rank,  capi_smear_intent,smear_capi,capi_errmess);
    if (capi_smear_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear = (double *)(PyArray_DATA(capi_smear_as_array));

    /* Processing variable self_energies */
    self_energies_Dims[0]=nirrqpt,self_energies_Dims[1]=3 * nat;
    capi_self_energies_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the hidden `self_energies`";
    capi_self_energies_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,self_energies_Dims,self_energies_Rank,  capi_self_energies_intent,Py_None,capi_errmess);
    if (capi_self_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        self_energies = (complex_double *)(PyArray_DATA(capi_self_energies_as_array));

    /* Processing variable nfc3 */
    if (nfc3_capi == Py_None) nfc3 = shape(fc3, 0); else
        f2py_success = int_from_pyobj(&nfc3,nfc3_capi,"thermal_conductivity.get_lf.calculate_lifetimes() 4th keyword (nfc3) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc3, 0) == nfc3,"shape(fc3, 0) == nfc3","4th keyword nfc3","calculate_lifetimes:nfc3=%d",nfc3) {
    /* Processing variable r3_2 */
    r3_2_Dims[0]=3,r3_2_Dims[1]=nfc3;
    capi_r3_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 8th argument `r3_2`";
    capi_r3_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_2_Dims,r3_2_Rank,  capi_r3_2_intent,r3_2_capi,capi_errmess);
    if (capi_r3_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_2 = (double *)(PyArray_DATA(capi_r3_2_as_array));

    /* Processing variable r3_3 */
    r3_3_Dims[0]=3,r3_3_Dims[1]=nfc3;
    capi_r3_3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_lifetimes: failed to create array from the 9th argument `r3_3`";
    capi_r3_3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_3_Dims,r3_3_Rank,  capi_r3_3_intent,r3_3_capi,capi_errmess);
    if (capi_r3_3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_3 = (double *)(PyArray_DATA(capi_r3_3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(irrqgrid,qgrid,weights,scatt_events,fc2,r2_2,fc3,r3_2,r3_3,rprim,pos,masses,smear,&t,&gaussian,&classical,&nirrqpt,&nat,&nfc2,&nfc3,&n_events,self_energies);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_self_energies_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_r3_3_as_array!=r3_3_capi) {
        Py_XDECREF(capi_r3_3_as_array); }
    }  /* if (capi_r3_3_as_array == NULL) ... else of r3_3 */
    /* End of cleaning variable r3_3 */
    if((PyObject *)capi_r3_2_as_array!=r3_2_capi) {
        Py_XDECREF(capi_r3_2_as_array); }
    }  /* if (capi_r3_2_as_array == NULL) ... else of r3_2 */
    /* End of cleaning variable r3_2 */
    } /*CHECKSCALAR(shape(fc3, 0) == nfc3)*/
    } /*if (f2py_success) of nfc3*/
    /* End of cleaning variable nfc3 */
    }  /* if (capi_self_energies_as_array == NULL) ... else of self_energies */
    /* End of cleaning variable self_energies */
    if((PyObject *)capi_smear_as_array!=smear_capi) {
        Py_XDECREF(capi_smear_as_array); }
    }  /* if (capi_smear_as_array == NULL) ... else of smear */
    /* End of cleaning variable smear */
    if((PyObject *)capi_masses_as_array!=masses_capi) {
        Py_XDECREF(capi_masses_as_array); }
    }  /* if (capi_masses_as_array == NULL) ... else of masses */
    /* End of cleaning variable masses */
    if((PyObject *)capi_pos_as_array!=pos_capi) {
        Py_XDECREF(capi_pos_as_array); }
    }  /* if (capi_pos_as_array == NULL) ... else of pos */
    /* End of cleaning variable pos */
    if((PyObject *)capi_r2_2_as_array!=r2_2_capi) {
        Py_XDECREF(capi_r2_2_as_array); }
    }  /* if (capi_r2_2_as_array == NULL) ... else of r2_2 */
    /* End of cleaning variable r2_2 */
    if((PyObject *)capi_fc3_as_array!=fc3_capi) {
        Py_XDECREF(capi_fc3_as_array); }
    }  /* if (capi_fc3_as_array == NULL) ... else of fc3 */
    /* End of cleaning variable fc3 */
    if((PyObject *)capi_scatt_events_as_array!=scatt_events_capi) {
        Py_XDECREF(capi_scatt_events_as_array); }
    }  /* if (capi_scatt_events_as_array == NULL) ... else of scatt_events */
    /* End of cleaning variable scatt_events */
    if((PyObject *)capi_weights_as_array!=weights_capi) {
        Py_XDECREF(capi_weights_as_array); }
    }  /* if (capi_weights_as_array == NULL) ... else of weights */
    /* End of cleaning variable weights */
    } /*CHECKSCALAR(shape(qgrid, 1) == n_events)*/
    } /*if (f2py_success) of n_events*/
    /* End of cleaning variable n_events */
    } /*CHECKSCALAR(shape(fc2, 0) == nfc2)*/
    } /*if (f2py_success) of nfc2*/
    /* End of cleaning variable nfc2 */
    } /*CHECKSCALAR(shape(fc2, 1) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(irrqgrid, 1) == nirrqpt)*/
    } /*if (f2py_success) of nirrqpt*/
    /* End of cleaning variable nirrqpt */
    } /*if (f2py_success) of classical*/
    /* End of cleaning variable classical */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_rprim_as_array!=rprim_capi) {
        Py_XDECREF(capi_rprim_as_array); }
    }  /* if (capi_rprim_as_array == NULL) ... else of rprim */
    /* End of cleaning variable rprim */
    if((PyObject *)capi_fc2_as_array!=fc2_capi) {
        Py_XDECREF(capi_fc2_as_array); }
    }  /* if (capi_fc2_as_array == NULL) ... else of fc2 */
    /* End of cleaning variable fc2 */
    if((PyObject *)capi_qgrid_as_array!=qgrid_capi) {
        Py_XDECREF(capi_qgrid_as_array); }
    }  /* if (capi_qgrid_as_array == NULL) ... else of qgrid */
    /* End of cleaning variable qgrid */
    if((PyObject *)capi_irrqgrid_as_array!=irrqgrid_capi) {
        Py_XDECREF(capi_irrqgrid_as_array); }
    }  /* if (capi_irrqgrid_as_array == NULL) ... else of irrqgrid */
    /* End of cleaning variable irrqgrid */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************* end of calculate_lifetimes *************************/

/************************** calculate_self_energy_la **************************/
static char doc_f2py_rout_thermal_conductivity_get_lf_calculate_self_energy_la[] = "\
self_energy = calculate_self_energy_la(w_q,qpt,pols_q,is_q_gamma,qgrid,weights,fc2,fc3,r2_2,r3_2,r3_3,pos,kprim,masses,smear,t,parallelize,gaussian,classical,[nqpt,nat,nfc2,nfc3])\n\nWrapper for ``calculate_self_energy_la``.\
\n\nParameters\n----------\n"
"w_q : input rank-1 array('d') with bounds (3 * nat)\n"
"qpt : input rank-1 array('d') with bounds (3)\n"
"pols_q : input rank-2 array('D') with bounds (3 * nat,3 * nat)\n"
"is_q_gamma : input int\n"
"qgrid : input rank-2 array('d') with bounds (3,nqpt)\n"
"weights : input rank-1 array('i') with bounds (nqpt)\n"
"fc2 : input rank-3 array('d') with bounds (nfc2,3 * nat,3 * nat)\n"
"fc3 : input rank-4 array('d') with bounds (nfc3,3 * nat,3 * nat,3 * nat)\n"
"r2_2 : input rank-2 array('d') with bounds (3,nfc2)\n"
"r3_2 : input rank-2 array('d') with bounds (3,nfc3)\n"
"r3_3 : input rank-2 array('d') with bounds (3,nfc3)\n"
"pos : input rank-2 array('d') with bounds (3,nat)\n"
"kprim : input rank-2 array('d') with bounds (3,3)\n"
"masses : input rank-1 array('d') with bounds (nat)\n"
"smear : input rank-1 array('d') with bounds (3 * nat)\n"
"t : input float\n"
"parallelize : input int\n"
"gaussian : input int\n"
"classical : input int\n"
"\nOther Parameters\n----------------\n"
"nqpt : input int, optional\n    Default: shape(qgrid, 1)\n"
"nat : input int, optional\n    Default: shape(w_q, 0) / 3\n"
"nfc2 : input int, optional\n    Default: shape(fc2, 0)\n"
"nfc3 : input int, optional\n    Default: shape(fc3, 0)\n"
"\nReturns\n-------\n"
"self_energy : rank-1 array('D') with bounds (3 * nat)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_calculate_self_energy_la(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,complex_double*,int*,int*,int*,int*,int*,double*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,int*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *w_q = NULL;
    npy_intp w_q_Dims[1] = {-1};
    const int w_q_Rank = 1;
    PyArrayObject *capi_w_q_as_array = NULL;
    int capi_w_q_intent = 0;
    PyObject *w_q_capi = Py_None;
    double *qpt = NULL;
    npy_intp qpt_Dims[1] = {-1};
    const int qpt_Rank = 1;
    PyArrayObject *capi_qpt_as_array = NULL;
    int capi_qpt_intent = 0;
    PyObject *qpt_capi = Py_None;
    complex_double *pols_q = NULL;
    npy_intp pols_q_Dims[2] = {-1, -1};
    const int pols_q_Rank = 2;
    PyArrayObject *capi_pols_q_as_array = NULL;
    int capi_pols_q_intent = 0;
    PyObject *pols_q_capi = Py_None;
    int is_q_gamma = 0;
    PyObject *is_q_gamma_capi = Py_None;
    int nqpt = 0;
    PyObject *nqpt_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int nfc2 = 0;
    PyObject *nfc2_capi = Py_None;
    int nfc3 = 0;
    PyObject *nfc3_capi = Py_None;
    double *qgrid = NULL;
    npy_intp qgrid_Dims[2] = {-1, -1};
    const int qgrid_Rank = 2;
    PyArrayObject *capi_qgrid_as_array = NULL;
    int capi_qgrid_intent = 0;
    PyObject *qgrid_capi = Py_None;
    int *weights = NULL;
    npy_intp weights_Dims[1] = {-1};
    const int weights_Rank = 1;
    PyArrayObject *capi_weights_as_array = NULL;
    int capi_weights_intent = 0;
    PyObject *weights_capi = Py_None;
    double *fc2 = NULL;
    npy_intp fc2_Dims[3] = {-1, -1, -1};
    const int fc2_Rank = 3;
    PyArrayObject *capi_fc2_as_array = NULL;
    int capi_fc2_intent = 0;
    PyObject *fc2_capi = Py_None;
    double *fc3 = NULL;
    npy_intp fc3_Dims[4] = {-1, -1, -1, -1};
    const int fc3_Rank = 4;
    PyArrayObject *capi_fc3_as_array = NULL;
    int capi_fc3_intent = 0;
    PyObject *fc3_capi = Py_None;
    double *r2_2 = NULL;
    npy_intp r2_2_Dims[2] = {-1, -1};
    const int r2_2_Rank = 2;
    PyArrayObject *capi_r2_2_as_array = NULL;
    int capi_r2_2_intent = 0;
    PyObject *r2_2_capi = Py_None;
    double *r3_2 = NULL;
    npy_intp r3_2_Dims[2] = {-1, -1};
    const int r3_2_Rank = 2;
    PyArrayObject *capi_r3_2_as_array = NULL;
    int capi_r3_2_intent = 0;
    PyObject *r3_2_capi = Py_None;
    double *r3_3 = NULL;
    npy_intp r3_3_Dims[2] = {-1, -1};
    const int r3_3_Rank = 2;
    PyArrayObject *capi_r3_3_as_array = NULL;
    int capi_r3_3_intent = 0;
    PyObject *r3_3_capi = Py_None;
    double *pos = NULL;
    npy_intp pos_Dims[2] = {-1, -1};
    const int pos_Rank = 2;
    PyArrayObject *capi_pos_as_array = NULL;
    int capi_pos_intent = 0;
    PyObject *pos_capi = Py_None;
    double *kprim = NULL;
    npy_intp kprim_Dims[2] = {-1, -1};
    const int kprim_Rank = 2;
    PyArrayObject *capi_kprim_as_array = NULL;
    int capi_kprim_intent = 0;
    PyObject *kprim_capi = Py_None;
    double *masses = NULL;
    npy_intp masses_Dims[1] = {-1};
    const int masses_Rank = 1;
    PyArrayObject *capi_masses_as_array = NULL;
    int capi_masses_intent = 0;
    PyObject *masses_capi = Py_None;
    double *smear = NULL;
    npy_intp smear_Dims[1] = {-1};
    const int smear_Rank = 1;
    PyArrayObject *capi_smear_as_array = NULL;
    int capi_smear_intent = 0;
    PyObject *smear_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    int parallelize = 0;
    PyObject *parallelize_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    int classical = 0;
    PyObject *classical_capi = Py_None;
    complex_double *self_energy = NULL;
    npy_intp self_energy_Dims[1] = {-1};
    const int self_energy_Rank = 1;
    PyArrayObject *capi_self_energy_as_array = NULL;
    int capi_self_energy_intent = 0;
    static char *capi_kwlist[] = {"w_q","qpt","pols_q","is_q_gamma","qgrid","weights","fc2","fc3","r2_2","r3_2","r3_3","pos","kprim","masses","smear","t","parallelize","gaussian","classical","nqpt","nat","nfc2","nfc3",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOOOOOOOOOOO|OOOO:thermal_conductivity.get_lf.calculate_self_energy_la",\
        capi_kwlist,&w_q_capi,&qpt_capi,&pols_q_capi,&is_q_gamma_capi,&qgrid_capi,&weights_capi,&fc2_capi,&fc3_capi,&r2_2_capi,&r3_2_capi,&r3_3_capi,&pos_capi,&kprim_capi,&masses_capi,&smear_capi,&t_capi,&parallelize_capi,&gaussian_capi,&classical_capi,&nqpt_capi,&nat_capi,&nfc2_capi,&nfc3_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable w_q */
    ;
    capi_w_q_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 1st argument `w_q`";
    capi_w_q_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,w_q_Dims,w_q_Rank,  capi_w_q_intent,w_q_capi,capi_errmess);
    if (capi_w_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        w_q = (double *)(PyArray_DATA(capi_w_q_as_array));

    /* Processing variable qpt */
    qpt_Dims[0]=3;
    capi_qpt_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 2nd argument `qpt`";
    capi_qpt_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qpt_Dims,qpt_Rank,  capi_qpt_intent,qpt_capi,capi_errmess);
    if (capi_qpt_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qpt = (double *)(PyArray_DATA(capi_qpt_as_array));

    /* Processing variable qgrid */
    qgrid_Dims[0]=3;
    capi_qgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 5th argument `qgrid`";
    capi_qgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qgrid_Dims,qgrid_Rank,  capi_qgrid_intent,qgrid_capi,capi_errmess);
    if (capi_qgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qgrid = (double *)(PyArray_DATA(capi_qgrid_as_array));

    /* Processing variable kprim */
    kprim_Dims[0]=3,kprim_Dims[1]=3;
    capi_kprim_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 13rd argument `kprim`";
    capi_kprim_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,kprim_Dims,kprim_Rank,  capi_kprim_intent,kprim_capi,capi_errmess);
    if (capi_kprim_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        kprim = (double *)(PyArray_DATA(capi_kprim_as_array));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.get_lf.calculate_self_energy_la() 16th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable is_q_gamma */
        is_q_gamma = (int)PyObject_IsTrue(is_q_gamma_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable parallelize */
        parallelize = (int)PyObject_IsTrue(parallelize_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable classical */
        classical = (int)PyObject_IsTrue(classical_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable nqpt */
    if (nqpt_capi == Py_None) nqpt = shape(qgrid, 1); else
        f2py_success = int_from_pyobj(&nqpt,nqpt_capi,"thermal_conductivity.get_lf.calculate_self_energy_la() 1st keyword (nqpt) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(qgrid, 1) == nqpt,"shape(qgrid, 1) == nqpt","1st keyword nqpt","calculate_self_energy_la:nqpt=%d",nqpt) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(w_q, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.get_lf.calculate_self_energy_la() 2nd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(w_q, 0) == 3 * nat,"shape(w_q, 0) == 3 * nat","2nd keyword nat","calculate_self_energy_la:nat=%d",nat) {
    /* Processing variable weights */
    weights_Dims[0]=nqpt;
    capi_weights_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 6th argument `weights`";
    capi_weights_as_array = ndarray_from_pyobj(  NPY_INT,1,weights_Dims,weights_Rank,  capi_weights_intent,weights_capi,capi_errmess);
    if (capi_weights_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        weights = (int *)(PyArray_DATA(capi_weights_as_array));

    /* Processing variable fc2 */
    fc2_Dims[1]=3 * nat,fc2_Dims[2]=3 * nat;
    capi_fc2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 7th argument `fc2`";
    capi_fc2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc2_Dims,fc2_Rank,  capi_fc2_intent,fc2_capi,capi_errmess);
    if (capi_fc2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc2 = (double *)(PyArray_DATA(capi_fc2_as_array));

    /* Processing variable fc3 */
    fc3_Dims[1]=3 * nat,fc3_Dims[2]=3 * nat,fc3_Dims[3]=3 * nat;
    capi_fc3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 8th argument `fc3`";
    capi_fc3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc3_Dims,fc3_Rank,  capi_fc3_intent,fc3_capi,capi_errmess);
    if (capi_fc3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc3 = (double *)(PyArray_DATA(capi_fc3_as_array));

    /* Processing variable pos */
    pos_Dims[0]=3,pos_Dims[1]=nat;
    capi_pos_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 12nd argument `pos`";
    capi_pos_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,pos_Dims,pos_Rank,  capi_pos_intent,pos_capi,capi_errmess);
    if (capi_pos_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pos = (double *)(PyArray_DATA(capi_pos_as_array));

    /* Processing variable masses */
    masses_Dims[0]=nat;
    capi_masses_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 14th argument `masses`";
    capi_masses_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,masses_Dims,masses_Rank,  capi_masses_intent,masses_capi,capi_errmess);
    if (capi_masses_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        masses = (double *)(PyArray_DATA(capi_masses_as_array));

    /* Processing variable smear */
    smear_Dims[0]=3 * nat;
    capi_smear_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 15th argument `smear`";
    capi_smear_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_Dims,smear_Rank,  capi_smear_intent,smear_capi,capi_errmess);
    if (capi_smear_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear = (double *)(PyArray_DATA(capi_smear_as_array));

    /* Processing variable pols_q */
    pols_q_Dims[0]=3 * nat,pols_q_Dims[1]=3 * nat;
    capi_pols_q_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 3rd argument `pols_q`";
    capi_pols_q_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,pols_q_Dims,pols_q_Rank,  capi_pols_q_intent,pols_q_capi,capi_errmess);
    if (capi_pols_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pols_q = (complex_double *)(PyArray_DATA(capi_pols_q_as_array));

    /* Processing variable self_energy */
    self_energy_Dims[0]=3 * nat;
    capi_self_energy_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the hidden `self_energy`";
    capi_self_energy_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,self_energy_Dims,self_energy_Rank,  capi_self_energy_intent,Py_None,capi_errmess);
    if (capi_self_energy_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        self_energy = (complex_double *)(PyArray_DATA(capi_self_energy_as_array));

    /* Processing variable nfc2 */
    if (nfc2_capi == Py_None) nfc2 = shape(fc2, 0); else
        f2py_success = int_from_pyobj(&nfc2,nfc2_capi,"thermal_conductivity.get_lf.calculate_self_energy_la() 3rd keyword (nfc2) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 0) == nfc2,"shape(fc2, 0) == nfc2","3rd keyword nfc2","calculate_self_energy_la:nfc2=%d",nfc2) {
    /* Processing variable nfc3 */
    if (nfc3_capi == Py_None) nfc3 = shape(fc3, 0); else
        f2py_success = int_from_pyobj(&nfc3,nfc3_capi,"thermal_conductivity.get_lf.calculate_self_energy_la() 4th keyword (nfc3) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc3, 0) == nfc3,"shape(fc3, 0) == nfc3","4th keyword nfc3","calculate_self_energy_la:nfc3=%d",nfc3) {
    /* Processing variable r2_2 */
    r2_2_Dims[0]=3,r2_2_Dims[1]=nfc2;
    capi_r2_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 9th argument `r2_2`";
    capi_r2_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_2_Dims,r2_2_Rank,  capi_r2_2_intent,r2_2_capi,capi_errmess);
    if (capi_r2_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2_2 = (double *)(PyArray_DATA(capi_r2_2_as_array));

    /* Processing variable r3_2 */
    r3_2_Dims[0]=3,r3_2_Dims[1]=nfc3;
    capi_r3_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 10th argument `r3_2`";
    capi_r3_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_2_Dims,r3_2_Rank,  capi_r3_2_intent,r3_2_capi,capi_errmess);
    if (capi_r3_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_2 = (double *)(PyArray_DATA(capi_r3_2_as_array));

    /* Processing variable r3_3 */
    r3_3_Dims[0]=3,r3_3_Dims[1]=nfc3;
    capi_r3_3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_la: failed to create array from the 11st argument `r3_3`";
    capi_r3_3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_3_Dims,r3_3_Rank,  capi_r3_3_intent,r3_3_capi,capi_errmess);
    if (capi_r3_3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_3 = (double *)(PyArray_DATA(capi_r3_3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(w_q,qpt,pols_q,&is_q_gamma,&nqpt,&nat,&nfc2,&nfc3,qgrid,weights,fc2,fc3,r2_2,r3_2,r3_3,pos,kprim,masses,smear,&t,&parallelize,&gaussian,&classical,self_energy);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_self_energy_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_r3_3_as_array!=r3_3_capi) {
        Py_XDECREF(capi_r3_3_as_array); }
    }  /* if (capi_r3_3_as_array == NULL) ... else of r3_3 */
    /* End of cleaning variable r3_3 */
    if((PyObject *)capi_r3_2_as_array!=r3_2_capi) {
        Py_XDECREF(capi_r3_2_as_array); }
    }  /* if (capi_r3_2_as_array == NULL) ... else of r3_2 */
    /* End of cleaning variable r3_2 */
    if((PyObject *)capi_r2_2_as_array!=r2_2_capi) {
        Py_XDECREF(capi_r2_2_as_array); }
    }  /* if (capi_r2_2_as_array == NULL) ... else of r2_2 */
    /* End of cleaning variable r2_2 */
    } /*CHECKSCALAR(shape(fc3, 0) == nfc3)*/
    } /*if (f2py_success) of nfc3*/
    /* End of cleaning variable nfc3 */
    } /*CHECKSCALAR(shape(fc2, 0) == nfc2)*/
    } /*if (f2py_success) of nfc2*/
    /* End of cleaning variable nfc2 */
    }  /* if (capi_self_energy_as_array == NULL) ... else of self_energy */
    /* End of cleaning variable self_energy */
    if((PyObject *)capi_pols_q_as_array!=pols_q_capi) {
        Py_XDECREF(capi_pols_q_as_array); }
    }  /* if (capi_pols_q_as_array == NULL) ... else of pols_q */
    /* End of cleaning variable pols_q */
    if((PyObject *)capi_smear_as_array!=smear_capi) {
        Py_XDECREF(capi_smear_as_array); }
    }  /* if (capi_smear_as_array == NULL) ... else of smear */
    /* End of cleaning variable smear */
    if((PyObject *)capi_masses_as_array!=masses_capi) {
        Py_XDECREF(capi_masses_as_array); }
    }  /* if (capi_masses_as_array == NULL) ... else of masses */
    /* End of cleaning variable masses */
    if((PyObject *)capi_pos_as_array!=pos_capi) {
        Py_XDECREF(capi_pos_as_array); }
    }  /* if (capi_pos_as_array == NULL) ... else of pos */
    /* End of cleaning variable pos */
    if((PyObject *)capi_fc3_as_array!=fc3_capi) {
        Py_XDECREF(capi_fc3_as_array); }
    }  /* if (capi_fc3_as_array == NULL) ... else of fc3 */
    /* End of cleaning variable fc3 */
    if((PyObject *)capi_fc2_as_array!=fc2_capi) {
        Py_XDECREF(capi_fc2_as_array); }
    }  /* if (capi_fc2_as_array == NULL) ... else of fc2 */
    /* End of cleaning variable fc2 */
    if((PyObject *)capi_weights_as_array!=weights_capi) {
        Py_XDECREF(capi_weights_as_array); }
    }  /* if (capi_weights_as_array == NULL) ... else of weights */
    /* End of cleaning variable weights */
    } /*CHECKSCALAR(shape(w_q, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(qgrid, 1) == nqpt)*/
    } /*if (f2py_success) of nqpt*/
    /* End of cleaning variable nqpt */
    } /*if (f2py_success) of classical*/
    /* End of cleaning variable classical */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    } /*if (f2py_success) of parallelize*/
    /* End of cleaning variable parallelize */
    } /*if (f2py_success) of is_q_gamma*/
    /* End of cleaning variable is_q_gamma */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_kprim_as_array!=kprim_capi) {
        Py_XDECREF(capi_kprim_as_array); }
    }  /* if (capi_kprim_as_array == NULL) ... else of kprim */
    /* End of cleaning variable kprim */
    if((PyObject *)capi_qgrid_as_array!=qgrid_capi) {
        Py_XDECREF(capi_qgrid_as_array); }
    }  /* if (capi_qgrid_as_array == NULL) ... else of qgrid */
    /* End of cleaning variable qgrid */
    if((PyObject *)capi_qpt_as_array!=qpt_capi) {
        Py_XDECREF(capi_qpt_as_array); }
    }  /* if (capi_qpt_as_array == NULL) ... else of qpt */
    /* End of cleaning variable qpt */
    if((PyObject *)capi_w_q_as_array!=w_q_capi) {
        Py_XDECREF(capi_w_q_as_array); }
    }  /* if (capi_w_q_as_array == NULL) ... else of w_q */
    /* End of cleaning variable w_q */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************** end of calculate_self_energy_la **********************/

/************************** calculate_self_energy_p **************************/
static char doc_f2py_rout_thermal_conductivity_get_lf_calculate_self_energy_p[] = "\
self_energy = calculate_self_energy_p(w_q,qpt,pols_q,is_q_gamma,qgrid,weights,fc2,fc3,r2_2,r3_2,r3_3,pos,kprim,masses,smear,t,energies,parallelize,gaussian,classical,[nqpt,nat,nfc2,nfc3,ne])\n\nWrapper for ``calculate_self_energy_p``.\
\n\nParameters\n----------\n"
"w_q : input rank-1 array('d') with bounds (3 * nat)\n"
"qpt : input rank-1 array('d') with bounds (3)\n"
"pols_q : input rank-2 array('D') with bounds (3 * nat,3 * nat)\n"
"is_q_gamma : input int\n"
"qgrid : input rank-2 array('d') with bounds (3,nqpt)\n"
"weights : input rank-1 array('i') with bounds (nqpt)\n"
"fc2 : input rank-3 array('d') with bounds (nfc2,3 * nat,3 * nat)\n"
"fc3 : input rank-4 array('d') with bounds (nfc3,3 * nat,3 * nat,3 * nat)\n"
"r2_2 : input rank-2 array('d') with bounds (3,nfc2)\n"
"r3_2 : input rank-2 array('d') with bounds (3,nfc3)\n"
"r3_3 : input rank-2 array('d') with bounds (3,nfc3)\n"
"pos : input rank-2 array('d') with bounds (3,nat)\n"
"kprim : input rank-2 array('d') with bounds (3,3)\n"
"masses : input rank-1 array('d') with bounds (nat)\n"
"smear : input rank-1 array('d') with bounds (3 * nat)\n"
"t : input float\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"parallelize : input int\n"
"gaussian : input int\n"
"classical : input int\n"
"\nOther Parameters\n----------------\n"
"nqpt : input int, optional\n    Default: shape(qgrid, 1)\n"
"nat : input int, optional\n    Default: shape(w_q, 0) / 3\n"
"nfc2 : input int, optional\n    Default: shape(fc2, 0)\n"
"nfc3 : input int, optional\n    Default: shape(fc3, 0)\n"
"ne : input int, optional\n    Default: shape(energies, 0)\n"
"\nReturns\n-------\n"
"self_energy : rank-2 array('D') with bounds (ne,3 * nat)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_calculate_self_energy_p(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,complex_double*,int*,int*,int*,int*,int*,int*,double*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,int*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *w_q = NULL;
    npy_intp w_q_Dims[1] = {-1};
    const int w_q_Rank = 1;
    PyArrayObject *capi_w_q_as_array = NULL;
    int capi_w_q_intent = 0;
    PyObject *w_q_capi = Py_None;
    double *qpt = NULL;
    npy_intp qpt_Dims[1] = {-1};
    const int qpt_Rank = 1;
    PyArrayObject *capi_qpt_as_array = NULL;
    int capi_qpt_intent = 0;
    PyObject *qpt_capi = Py_None;
    complex_double *pols_q = NULL;
    npy_intp pols_q_Dims[2] = {-1, -1};
    const int pols_q_Rank = 2;
    PyArrayObject *capi_pols_q_as_array = NULL;
    int capi_pols_q_intent = 0;
    PyObject *pols_q_capi = Py_None;
    int is_q_gamma = 0;
    PyObject *is_q_gamma_capi = Py_None;
    int nqpt = 0;
    PyObject *nqpt_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int nfc2 = 0;
    PyObject *nfc2_capi = Py_None;
    int nfc3 = 0;
    PyObject *nfc3_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    double *qgrid = NULL;
    npy_intp qgrid_Dims[2] = {-1, -1};
    const int qgrid_Rank = 2;
    PyArrayObject *capi_qgrid_as_array = NULL;
    int capi_qgrid_intent = 0;
    PyObject *qgrid_capi = Py_None;
    int *weights = NULL;
    npy_intp weights_Dims[1] = {-1};
    const int weights_Rank = 1;
    PyArrayObject *capi_weights_as_array = NULL;
    int capi_weights_intent = 0;
    PyObject *weights_capi = Py_None;
    double *fc2 = NULL;
    npy_intp fc2_Dims[3] = {-1, -1, -1};
    const int fc2_Rank = 3;
    PyArrayObject *capi_fc2_as_array = NULL;
    int capi_fc2_intent = 0;
    PyObject *fc2_capi = Py_None;
    double *fc3 = NULL;
    npy_intp fc3_Dims[4] = {-1, -1, -1, -1};
    const int fc3_Rank = 4;
    PyArrayObject *capi_fc3_as_array = NULL;
    int capi_fc3_intent = 0;
    PyObject *fc3_capi = Py_None;
    double *r2_2 = NULL;
    npy_intp r2_2_Dims[2] = {-1, -1};
    const int r2_2_Rank = 2;
    PyArrayObject *capi_r2_2_as_array = NULL;
    int capi_r2_2_intent = 0;
    PyObject *r2_2_capi = Py_None;
    double *r3_2 = NULL;
    npy_intp r3_2_Dims[2] = {-1, -1};
    const int r3_2_Rank = 2;
    PyArrayObject *capi_r3_2_as_array = NULL;
    int capi_r3_2_intent = 0;
    PyObject *r3_2_capi = Py_None;
    double *r3_3 = NULL;
    npy_intp r3_3_Dims[2] = {-1, -1};
    const int r3_3_Rank = 2;
    PyArrayObject *capi_r3_3_as_array = NULL;
    int capi_r3_3_intent = 0;
    PyObject *r3_3_capi = Py_None;
    double *pos = NULL;
    npy_intp pos_Dims[2] = {-1, -1};
    const int pos_Rank = 2;
    PyArrayObject *capi_pos_as_array = NULL;
    int capi_pos_intent = 0;
    PyObject *pos_capi = Py_None;
    double *kprim = NULL;
    npy_intp kprim_Dims[2] = {-1, -1};
    const int kprim_Rank = 2;
    PyArrayObject *capi_kprim_as_array = NULL;
    int capi_kprim_intent = 0;
    PyObject *kprim_capi = Py_None;
    double *masses = NULL;
    npy_intp masses_Dims[1] = {-1};
    const int masses_Rank = 1;
    PyArrayObject *capi_masses_as_array = NULL;
    int capi_masses_intent = 0;
    PyObject *masses_capi = Py_None;
    double *smear = NULL;
    npy_intp smear_Dims[1] = {-1};
    const int smear_Rank = 1;
    PyArrayObject *capi_smear_as_array = NULL;
    int capi_smear_intent = 0;
    PyObject *smear_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    int parallelize = 0;
    PyObject *parallelize_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    int classical = 0;
    PyObject *classical_capi = Py_None;
    complex_double *self_energy = NULL;
    npy_intp self_energy_Dims[2] = {-1, -1};
    const int self_energy_Rank = 2;
    PyArrayObject *capi_self_energy_as_array = NULL;
    int capi_self_energy_intent = 0;
    static char *capi_kwlist[] = {"w_q","qpt","pols_q","is_q_gamma","qgrid","weights","fc2","fc3","r2_2","r3_2","r3_3","pos","kprim","masses","smear","t","energies","parallelize","gaussian","classical","nqpt","nat","nfc2","nfc3","ne",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOOOOOOOOOOOO|OOOOO:thermal_conductivity.get_lf.calculate_self_energy_p",\
        capi_kwlist,&w_q_capi,&qpt_capi,&pols_q_capi,&is_q_gamma_capi,&qgrid_capi,&weights_capi,&fc2_capi,&fc3_capi,&r2_2_capi,&r3_2_capi,&r3_3_capi,&pos_capi,&kprim_capi,&masses_capi,&smear_capi,&t_capi,&energies_capi,&parallelize_capi,&gaussian_capi,&classical_capi,&nqpt_capi,&nat_capi,&nfc2_capi,&nfc3_capi,&ne_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable w_q */
    ;
    capi_w_q_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 1st argument `w_q`";
    capi_w_q_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,w_q_Dims,w_q_Rank,  capi_w_q_intent,w_q_capi,capi_errmess);
    if (capi_w_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        w_q = (double *)(PyArray_DATA(capi_w_q_as_array));

    /* Processing variable qpt */
    qpt_Dims[0]=3;
    capi_qpt_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 2nd argument `qpt`";
    capi_qpt_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qpt_Dims,qpt_Rank,  capi_qpt_intent,qpt_capi,capi_errmess);
    if (capi_qpt_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qpt = (double *)(PyArray_DATA(capi_qpt_as_array));

    /* Processing variable qgrid */
    qgrid_Dims[0]=3;
    capi_qgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 5th argument `qgrid`";
    capi_qgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qgrid_Dims,qgrid_Rank,  capi_qgrid_intent,qgrid_capi,capi_errmess);
    if (capi_qgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qgrid = (double *)(PyArray_DATA(capi_qgrid_as_array));

    /* Processing variable kprim */
    kprim_Dims[0]=3,kprim_Dims[1]=3;
    capi_kprim_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 13rd argument `kprim`";
    capi_kprim_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,kprim_Dims,kprim_Rank,  capi_kprim_intent,kprim_capi,capi_errmess);
    if (capi_kprim_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        kprim = (double *)(PyArray_DATA(capi_kprim_as_array));

    /* Processing variable energies */
    ;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 17th argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.get_lf.calculate_self_energy_p() 16th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable is_q_gamma */
        is_q_gamma = (int)PyObject_IsTrue(is_q_gamma_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable parallelize */
        parallelize = (int)PyObject_IsTrue(parallelize_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable classical */
        classical = (int)PyObject_IsTrue(classical_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable nqpt */
    if (nqpt_capi == Py_None) nqpt = shape(qgrid, 1); else
        f2py_success = int_from_pyobj(&nqpt,nqpt_capi,"thermal_conductivity.get_lf.calculate_self_energy_p() 1st keyword (nqpt) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(qgrid, 1) == nqpt,"shape(qgrid, 1) == nqpt","1st keyword nqpt","calculate_self_energy_p:nqpt=%d",nqpt) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(w_q, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.get_lf.calculate_self_energy_p() 2nd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(w_q, 0) == 3 * nat,"shape(w_q, 0) == 3 * nat","2nd keyword nat","calculate_self_energy_p:nat=%d",nat) {
    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(energies, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.get_lf.calculate_self_energy_p() 5th keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(energies, 0) == ne,"shape(energies, 0) == ne","5th keyword ne","calculate_self_energy_p:ne=%d",ne) {
    /* Processing variable weights */
    weights_Dims[0]=nqpt;
    capi_weights_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 6th argument `weights`";
    capi_weights_as_array = ndarray_from_pyobj(  NPY_INT,1,weights_Dims,weights_Rank,  capi_weights_intent,weights_capi,capi_errmess);
    if (capi_weights_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        weights = (int *)(PyArray_DATA(capi_weights_as_array));

    /* Processing variable fc2 */
    fc2_Dims[1]=3 * nat,fc2_Dims[2]=3 * nat;
    capi_fc2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 7th argument `fc2`";
    capi_fc2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc2_Dims,fc2_Rank,  capi_fc2_intent,fc2_capi,capi_errmess);
    if (capi_fc2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc2 = (double *)(PyArray_DATA(capi_fc2_as_array));

    /* Processing variable fc3 */
    fc3_Dims[1]=3 * nat,fc3_Dims[2]=3 * nat,fc3_Dims[3]=3 * nat;
    capi_fc3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 8th argument `fc3`";
    capi_fc3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc3_Dims,fc3_Rank,  capi_fc3_intent,fc3_capi,capi_errmess);
    if (capi_fc3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc3 = (double *)(PyArray_DATA(capi_fc3_as_array));

    /* Processing variable pos */
    pos_Dims[0]=3,pos_Dims[1]=nat;
    capi_pos_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 12nd argument `pos`";
    capi_pos_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,pos_Dims,pos_Rank,  capi_pos_intent,pos_capi,capi_errmess);
    if (capi_pos_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pos = (double *)(PyArray_DATA(capi_pos_as_array));

    /* Processing variable masses */
    masses_Dims[0]=nat;
    capi_masses_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 14th argument `masses`";
    capi_masses_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,masses_Dims,masses_Rank,  capi_masses_intent,masses_capi,capi_errmess);
    if (capi_masses_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        masses = (double *)(PyArray_DATA(capi_masses_as_array));

    /* Processing variable smear */
    smear_Dims[0]=3 * nat;
    capi_smear_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 15th argument `smear`";
    capi_smear_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_Dims,smear_Rank,  capi_smear_intent,smear_capi,capi_errmess);
    if (capi_smear_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear = (double *)(PyArray_DATA(capi_smear_as_array));

    /* Processing variable pols_q */
    pols_q_Dims[0]=3 * nat,pols_q_Dims[1]=3 * nat;
    capi_pols_q_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 3rd argument `pols_q`";
    capi_pols_q_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,pols_q_Dims,pols_q_Rank,  capi_pols_q_intent,pols_q_capi,capi_errmess);
    if (capi_pols_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pols_q = (complex_double *)(PyArray_DATA(capi_pols_q_as_array));

    /* Processing variable self_energy */
    self_energy_Dims[0]=ne,self_energy_Dims[1]=3 * nat;
    capi_self_energy_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the hidden `self_energy`";
    capi_self_energy_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,self_energy_Dims,self_energy_Rank,  capi_self_energy_intent,Py_None,capi_errmess);
    if (capi_self_energy_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        self_energy = (complex_double *)(PyArray_DATA(capi_self_energy_as_array));

    /* Processing variable nfc2 */
    if (nfc2_capi == Py_None) nfc2 = shape(fc2, 0); else
        f2py_success = int_from_pyobj(&nfc2,nfc2_capi,"thermal_conductivity.get_lf.calculate_self_energy_p() 3rd keyword (nfc2) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 0) == nfc2,"shape(fc2, 0) == nfc2","3rd keyword nfc2","calculate_self_energy_p:nfc2=%d",nfc2) {
    /* Processing variable nfc3 */
    if (nfc3_capi == Py_None) nfc3 = shape(fc3, 0); else
        f2py_success = int_from_pyobj(&nfc3,nfc3_capi,"thermal_conductivity.get_lf.calculate_self_energy_p() 4th keyword (nfc3) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc3, 0) == nfc3,"shape(fc3, 0) == nfc3","4th keyword nfc3","calculate_self_energy_p:nfc3=%d",nfc3) {
    /* Processing variable r2_2 */
    r2_2_Dims[0]=3,r2_2_Dims[1]=nfc2;
    capi_r2_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 9th argument `r2_2`";
    capi_r2_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_2_Dims,r2_2_Rank,  capi_r2_2_intent,r2_2_capi,capi_errmess);
    if (capi_r2_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2_2 = (double *)(PyArray_DATA(capi_r2_2_as_array));

    /* Processing variable r3_2 */
    r3_2_Dims[0]=3,r3_2_Dims[1]=nfc3;
    capi_r3_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 10th argument `r3_2`";
    capi_r3_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_2_Dims,r3_2_Rank,  capi_r3_2_intent,r3_2_capi,capi_errmess);
    if (capi_r3_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_2 = (double *)(PyArray_DATA(capi_r3_2_as_array));

    /* Processing variable r3_3 */
    r3_3_Dims[0]=3,r3_3_Dims[1]=nfc3;
    capi_r3_3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_p: failed to create array from the 11st argument `r3_3`";
    capi_r3_3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_3_Dims,r3_3_Rank,  capi_r3_3_intent,r3_3_capi,capi_errmess);
    if (capi_r3_3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_3 = (double *)(PyArray_DATA(capi_r3_3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(w_q,qpt,pols_q,&is_q_gamma,&nqpt,&nat,&nfc2,&nfc3,&ne,qgrid,weights,fc2,fc3,r2_2,r3_2,r3_3,pos,kprim,masses,smear,&t,energies,&parallelize,&gaussian,&classical,self_energy);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_self_energy_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_r3_3_as_array!=r3_3_capi) {
        Py_XDECREF(capi_r3_3_as_array); }
    }  /* if (capi_r3_3_as_array == NULL) ... else of r3_3 */
    /* End of cleaning variable r3_3 */
    if((PyObject *)capi_r3_2_as_array!=r3_2_capi) {
        Py_XDECREF(capi_r3_2_as_array); }
    }  /* if (capi_r3_2_as_array == NULL) ... else of r3_2 */
    /* End of cleaning variable r3_2 */
    if((PyObject *)capi_r2_2_as_array!=r2_2_capi) {
        Py_XDECREF(capi_r2_2_as_array); }
    }  /* if (capi_r2_2_as_array == NULL) ... else of r2_2 */
    /* End of cleaning variable r2_2 */
    } /*CHECKSCALAR(shape(fc3, 0) == nfc3)*/
    } /*if (f2py_success) of nfc3*/
    /* End of cleaning variable nfc3 */
    } /*CHECKSCALAR(shape(fc2, 0) == nfc2)*/
    } /*if (f2py_success) of nfc2*/
    /* End of cleaning variable nfc2 */
    }  /* if (capi_self_energy_as_array == NULL) ... else of self_energy */
    /* End of cleaning variable self_energy */
    if((PyObject *)capi_pols_q_as_array!=pols_q_capi) {
        Py_XDECREF(capi_pols_q_as_array); }
    }  /* if (capi_pols_q_as_array == NULL) ... else of pols_q */
    /* End of cleaning variable pols_q */
    if((PyObject *)capi_smear_as_array!=smear_capi) {
        Py_XDECREF(capi_smear_as_array); }
    }  /* if (capi_smear_as_array == NULL) ... else of smear */
    /* End of cleaning variable smear */
    if((PyObject *)capi_masses_as_array!=masses_capi) {
        Py_XDECREF(capi_masses_as_array); }
    }  /* if (capi_masses_as_array == NULL) ... else of masses */
    /* End of cleaning variable masses */
    if((PyObject *)capi_pos_as_array!=pos_capi) {
        Py_XDECREF(capi_pos_as_array); }
    }  /* if (capi_pos_as_array == NULL) ... else of pos */
    /* End of cleaning variable pos */
    if((PyObject *)capi_fc3_as_array!=fc3_capi) {
        Py_XDECREF(capi_fc3_as_array); }
    }  /* if (capi_fc3_as_array == NULL) ... else of fc3 */
    /* End of cleaning variable fc3 */
    if((PyObject *)capi_fc2_as_array!=fc2_capi) {
        Py_XDECREF(capi_fc2_as_array); }
    }  /* if (capi_fc2_as_array == NULL) ... else of fc2 */
    /* End of cleaning variable fc2 */
    if((PyObject *)capi_weights_as_array!=weights_capi) {
        Py_XDECREF(capi_weights_as_array); }
    }  /* if (capi_weights_as_array == NULL) ... else of weights */
    /* End of cleaning variable weights */
    } /*CHECKSCALAR(shape(energies, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    } /*CHECKSCALAR(shape(w_q, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(qgrid, 1) == nqpt)*/
    } /*if (f2py_success) of nqpt*/
    /* End of cleaning variable nqpt */
    } /*if (f2py_success) of classical*/
    /* End of cleaning variable classical */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    } /*if (f2py_success) of parallelize*/
    /* End of cleaning variable parallelize */
    } /*if (f2py_success) of is_q_gamma*/
    /* End of cleaning variable is_q_gamma */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
    if((PyObject *)capi_kprim_as_array!=kprim_capi) {
        Py_XDECREF(capi_kprim_as_array); }
    }  /* if (capi_kprim_as_array == NULL) ... else of kprim */
    /* End of cleaning variable kprim */
    if((PyObject *)capi_qgrid_as_array!=qgrid_capi) {
        Py_XDECREF(capi_qgrid_as_array); }
    }  /* if (capi_qgrid_as_array == NULL) ... else of qgrid */
    /* End of cleaning variable qgrid */
    if((PyObject *)capi_qpt_as_array!=qpt_capi) {
        Py_XDECREF(capi_qpt_as_array); }
    }  /* if (capi_qpt_as_array == NULL) ... else of qpt */
    /* End of cleaning variable qpt */
    if((PyObject *)capi_w_q_as_array!=w_q_capi) {
        Py_XDECREF(capi_w_q_as_array); }
    }  /* if (capi_w_q_as_array == NULL) ... else of w_q */
    /* End of cleaning variable w_q */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/*********************** end of calculate_self_energy_p ***********************/

/************************* calculate_self_energy_full *************************/
static char doc_f2py_rout_thermal_conductivity_get_lf_calculate_self_energy_full[] = "\
self_energy = calculate_self_energy_full(w_q,qpt,pols_q,is_q_gamma,qgrid,weights,fc2,fc3,r2_2,r3_2,r3_3,pos,kprim,masses,smear,t,energies,parallelize,gaussian,classical,[nqpt,nat,nfc2,nfc3,ne])\n\nWrapper for ``calculate_self_energy_full``.\
\n\nParameters\n----------\n"
"w_q : input rank-1 array('d') with bounds (3 * nat)\n"
"qpt : input rank-1 array('d') with bounds (3)\n"
"pols_q : input rank-2 array('D') with bounds (3 * nat,3 * nat)\n"
"is_q_gamma : input int\n"
"qgrid : input rank-2 array('d') with bounds (3,nqpt)\n"
"weights : input rank-1 array('i') with bounds (nqpt)\n"
"fc2 : input rank-3 array('d') with bounds (nfc2,3 * nat,3 * nat)\n"
"fc3 : input rank-4 array('d') with bounds (nfc3,3 * nat,3 * nat,3 * nat)\n"
"r2_2 : input rank-2 array('d') with bounds (3,nfc2)\n"
"r3_2 : input rank-2 array('d') with bounds (3,nfc3)\n"
"r3_3 : input rank-2 array('d') with bounds (3,nfc3)\n"
"pos : input rank-2 array('d') with bounds (3,nat)\n"
"kprim : input rank-2 array('d') with bounds (3,3)\n"
"masses : input rank-1 array('d') with bounds (nat)\n"
"smear : input rank-1 array('d') with bounds (3 * nat)\n"
"t : input float\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"parallelize : input int\n"
"gaussian : input int\n"
"classical : input int\n"
"\nOther Parameters\n----------------\n"
"nqpt : input int, optional\n    Default: shape(qgrid, 1)\n"
"nat : input int, optional\n    Default: shape(w_q, 0) / 3\n"
"nfc2 : input int, optional\n    Default: shape(fc2, 0)\n"
"nfc3 : input int, optional\n    Default: shape(fc3, 0)\n"
"ne : input int, optional\n    Default: shape(energies, 0)\n"
"\nReturns\n-------\n"
"self_energy : rank-3 array('D') with bounds (ne,3 * nat,3 * nat)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_calculate_self_energy_full(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,complex_double*,int*,int*,int*,int*,int*,int*,double*,int*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,double*,int*,int*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *w_q = NULL;
    npy_intp w_q_Dims[1] = {-1};
    const int w_q_Rank = 1;
    PyArrayObject *capi_w_q_as_array = NULL;
    int capi_w_q_intent = 0;
    PyObject *w_q_capi = Py_None;
    double *qpt = NULL;
    npy_intp qpt_Dims[1] = {-1};
    const int qpt_Rank = 1;
    PyArrayObject *capi_qpt_as_array = NULL;
    int capi_qpt_intent = 0;
    PyObject *qpt_capi = Py_None;
    complex_double *pols_q = NULL;
    npy_intp pols_q_Dims[2] = {-1, -1};
    const int pols_q_Rank = 2;
    PyArrayObject *capi_pols_q_as_array = NULL;
    int capi_pols_q_intent = 0;
    PyObject *pols_q_capi = Py_None;
    int is_q_gamma = 0;
    PyObject *is_q_gamma_capi = Py_None;
    int nqpt = 0;
    PyObject *nqpt_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int nfc2 = 0;
    PyObject *nfc2_capi = Py_None;
    int nfc3 = 0;
    PyObject *nfc3_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    double *qgrid = NULL;
    npy_intp qgrid_Dims[2] = {-1, -1};
    const int qgrid_Rank = 2;
    PyArrayObject *capi_qgrid_as_array = NULL;
    int capi_qgrid_intent = 0;
    PyObject *qgrid_capi = Py_None;
    int *weights = NULL;
    npy_intp weights_Dims[1] = {-1};
    const int weights_Rank = 1;
    PyArrayObject *capi_weights_as_array = NULL;
    int capi_weights_intent = 0;
    PyObject *weights_capi = Py_None;
    double *fc2 = NULL;
    npy_intp fc2_Dims[3] = {-1, -1, -1};
    const int fc2_Rank = 3;
    PyArrayObject *capi_fc2_as_array = NULL;
    int capi_fc2_intent = 0;
    PyObject *fc2_capi = Py_None;
    double *fc3 = NULL;
    npy_intp fc3_Dims[4] = {-1, -1, -1, -1};
    const int fc3_Rank = 4;
    PyArrayObject *capi_fc3_as_array = NULL;
    int capi_fc3_intent = 0;
    PyObject *fc3_capi = Py_None;
    double *r2_2 = NULL;
    npy_intp r2_2_Dims[2] = {-1, -1};
    const int r2_2_Rank = 2;
    PyArrayObject *capi_r2_2_as_array = NULL;
    int capi_r2_2_intent = 0;
    PyObject *r2_2_capi = Py_None;
    double *r3_2 = NULL;
    npy_intp r3_2_Dims[2] = {-1, -1};
    const int r3_2_Rank = 2;
    PyArrayObject *capi_r3_2_as_array = NULL;
    int capi_r3_2_intent = 0;
    PyObject *r3_2_capi = Py_None;
    double *r3_3 = NULL;
    npy_intp r3_3_Dims[2] = {-1, -1};
    const int r3_3_Rank = 2;
    PyArrayObject *capi_r3_3_as_array = NULL;
    int capi_r3_3_intent = 0;
    PyObject *r3_3_capi = Py_None;
    double *pos = NULL;
    npy_intp pos_Dims[2] = {-1, -1};
    const int pos_Rank = 2;
    PyArrayObject *capi_pos_as_array = NULL;
    int capi_pos_intent = 0;
    PyObject *pos_capi = Py_None;
    double *kprim = NULL;
    npy_intp kprim_Dims[2] = {-1, -1};
    const int kprim_Rank = 2;
    PyArrayObject *capi_kprim_as_array = NULL;
    int capi_kprim_intent = 0;
    PyObject *kprim_capi = Py_None;
    double *masses = NULL;
    npy_intp masses_Dims[1] = {-1};
    const int masses_Rank = 1;
    PyArrayObject *capi_masses_as_array = NULL;
    int capi_masses_intent = 0;
    PyObject *masses_capi = Py_None;
    double *smear = NULL;
    npy_intp smear_Dims[1] = {-1};
    const int smear_Rank = 1;
    PyArrayObject *capi_smear_as_array = NULL;
    int capi_smear_intent = 0;
    PyObject *smear_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    int parallelize = 0;
    PyObject *parallelize_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    int classical = 0;
    PyObject *classical_capi = Py_None;
    complex_double *self_energy = NULL;
    npy_intp self_energy_Dims[3] = {-1, -1, -1};
    const int self_energy_Rank = 3;
    PyArrayObject *capi_self_energy_as_array = NULL;
    int capi_self_energy_intent = 0;
    static char *capi_kwlist[] = {"w_q","qpt","pols_q","is_q_gamma","qgrid","weights","fc2","fc3","r2_2","r3_2","r3_3","pos","kprim","masses","smear","t","energies","parallelize","gaussian","classical","nqpt","nat","nfc2","nfc3","ne",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOOOOOOOOOOOOO|OOOOO:thermal_conductivity.get_lf.calculate_self_energy_full",\
        capi_kwlist,&w_q_capi,&qpt_capi,&pols_q_capi,&is_q_gamma_capi,&qgrid_capi,&weights_capi,&fc2_capi,&fc3_capi,&r2_2_capi,&r3_2_capi,&r3_3_capi,&pos_capi,&kprim_capi,&masses_capi,&smear_capi,&t_capi,&energies_capi,&parallelize_capi,&gaussian_capi,&classical_capi,&nqpt_capi,&nat_capi,&nfc2_capi,&nfc3_capi,&ne_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable w_q */
    ;
    capi_w_q_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 1st argument `w_q`";
    capi_w_q_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,w_q_Dims,w_q_Rank,  capi_w_q_intent,w_q_capi,capi_errmess);
    if (capi_w_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        w_q = (double *)(PyArray_DATA(capi_w_q_as_array));

    /* Processing variable qpt */
    qpt_Dims[0]=3;
    capi_qpt_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 2nd argument `qpt`";
    capi_qpt_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qpt_Dims,qpt_Rank,  capi_qpt_intent,qpt_capi,capi_errmess);
    if (capi_qpt_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qpt = (double *)(PyArray_DATA(capi_qpt_as_array));

    /* Processing variable qgrid */
    qgrid_Dims[0]=3;
    capi_qgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 5th argument `qgrid`";
    capi_qgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qgrid_Dims,qgrid_Rank,  capi_qgrid_intent,qgrid_capi,capi_errmess);
    if (capi_qgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qgrid = (double *)(PyArray_DATA(capi_qgrid_as_array));

    /* Processing variable kprim */
    kprim_Dims[0]=3,kprim_Dims[1]=3;
    capi_kprim_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 13rd argument `kprim`";
    capi_kprim_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,kprim_Dims,kprim_Rank,  capi_kprim_intent,kprim_capi,capi_errmess);
    if (capi_kprim_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        kprim = (double *)(PyArray_DATA(capi_kprim_as_array));

    /* Processing variable energies */
    ;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 17th argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.get_lf.calculate_self_energy_full() 16th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable is_q_gamma */
        is_q_gamma = (int)PyObject_IsTrue(is_q_gamma_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable parallelize */
        parallelize = (int)PyObject_IsTrue(parallelize_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable classical */
        classical = (int)PyObject_IsTrue(classical_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable nqpt */
    if (nqpt_capi == Py_None) nqpt = shape(qgrid, 1); else
        f2py_success = int_from_pyobj(&nqpt,nqpt_capi,"thermal_conductivity.get_lf.calculate_self_energy_full() 1st keyword (nqpt) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(qgrid, 1) == nqpt,"shape(qgrid, 1) == nqpt","1st keyword nqpt","calculate_self_energy_full:nqpt=%d",nqpt) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(w_q, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.get_lf.calculate_self_energy_full() 2nd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(w_q, 0) == 3 * nat,"shape(w_q, 0) == 3 * nat","2nd keyword nat","calculate_self_energy_full:nat=%d",nat) {
    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(energies, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.get_lf.calculate_self_energy_full() 5th keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(energies, 0) == ne,"shape(energies, 0) == ne","5th keyword ne","calculate_self_energy_full:ne=%d",ne) {
    /* Processing variable weights */
    weights_Dims[0]=nqpt;
    capi_weights_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 6th argument `weights`";
    capi_weights_as_array = ndarray_from_pyobj(  NPY_INT,1,weights_Dims,weights_Rank,  capi_weights_intent,weights_capi,capi_errmess);
    if (capi_weights_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        weights = (int *)(PyArray_DATA(capi_weights_as_array));

    /* Processing variable fc2 */
    fc2_Dims[1]=3 * nat,fc2_Dims[2]=3 * nat;
    capi_fc2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 7th argument `fc2`";
    capi_fc2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc2_Dims,fc2_Rank,  capi_fc2_intent,fc2_capi,capi_errmess);
    if (capi_fc2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc2 = (double *)(PyArray_DATA(capi_fc2_as_array));

    /* Processing variable fc3 */
    fc3_Dims[1]=3 * nat,fc3_Dims[2]=3 * nat,fc3_Dims[3]=3 * nat;
    capi_fc3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 8th argument `fc3`";
    capi_fc3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc3_Dims,fc3_Rank,  capi_fc3_intent,fc3_capi,capi_errmess);
    if (capi_fc3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc3 = (double *)(PyArray_DATA(capi_fc3_as_array));

    /* Processing variable pos */
    pos_Dims[0]=3,pos_Dims[1]=nat;
    capi_pos_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 12nd argument `pos`";
    capi_pos_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,pos_Dims,pos_Rank,  capi_pos_intent,pos_capi,capi_errmess);
    if (capi_pos_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pos = (double *)(PyArray_DATA(capi_pos_as_array));

    /* Processing variable masses */
    masses_Dims[0]=nat;
    capi_masses_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 14th argument `masses`";
    capi_masses_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,masses_Dims,masses_Rank,  capi_masses_intent,masses_capi,capi_errmess);
    if (capi_masses_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        masses = (double *)(PyArray_DATA(capi_masses_as_array));

    /* Processing variable smear */
    smear_Dims[0]=3 * nat;
    capi_smear_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 15th argument `smear`";
    capi_smear_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_Dims,smear_Rank,  capi_smear_intent,smear_capi,capi_errmess);
    if (capi_smear_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear = (double *)(PyArray_DATA(capi_smear_as_array));

    /* Processing variable pols_q */
    pols_q_Dims[0]=3 * nat,pols_q_Dims[1]=3 * nat;
    capi_pols_q_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 3rd argument `pols_q`";
    capi_pols_q_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,pols_q_Dims,pols_q_Rank,  capi_pols_q_intent,pols_q_capi,capi_errmess);
    if (capi_pols_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pols_q = (complex_double *)(PyArray_DATA(capi_pols_q_as_array));

    /* Processing variable self_energy */
    self_energy_Dims[0]=ne,self_energy_Dims[1]=3 * nat,self_energy_Dims[2]=3 * nat;
    capi_self_energy_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the hidden `self_energy`";
    capi_self_energy_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,self_energy_Dims,self_energy_Rank,  capi_self_energy_intent,Py_None,capi_errmess);
    if (capi_self_energy_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        self_energy = (complex_double *)(PyArray_DATA(capi_self_energy_as_array));

    /* Processing variable nfc2 */
    if (nfc2_capi == Py_None) nfc2 = shape(fc2, 0); else
        f2py_success = int_from_pyobj(&nfc2,nfc2_capi,"thermal_conductivity.get_lf.calculate_self_energy_full() 3rd keyword (nfc2) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 0) == nfc2,"shape(fc2, 0) == nfc2","3rd keyword nfc2","calculate_self_energy_full:nfc2=%d",nfc2) {
    /* Processing variable nfc3 */
    if (nfc3_capi == Py_None) nfc3 = shape(fc3, 0); else
        f2py_success = int_from_pyobj(&nfc3,nfc3_capi,"thermal_conductivity.get_lf.calculate_self_energy_full() 4th keyword (nfc3) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc3, 0) == nfc3,"shape(fc3, 0) == nfc3","4th keyword nfc3","calculate_self_energy_full:nfc3=%d",nfc3) {
    /* Processing variable r2_2 */
    r2_2_Dims[0]=3,r2_2_Dims[1]=nfc2;
    capi_r2_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 9th argument `r2_2`";
    capi_r2_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_2_Dims,r2_2_Rank,  capi_r2_2_intent,r2_2_capi,capi_errmess);
    if (capi_r2_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2_2 = (double *)(PyArray_DATA(capi_r2_2_as_array));

    /* Processing variable r3_2 */
    r3_2_Dims[0]=3,r3_2_Dims[1]=nfc3;
    capi_r3_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 10th argument `r3_2`";
    capi_r3_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_2_Dims,r3_2_Rank,  capi_r3_2_intent,r3_2_capi,capi_errmess);
    if (capi_r3_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_2 = (double *)(PyArray_DATA(capi_r3_2_as_array));

    /* Processing variable r3_3 */
    r3_3_Dims[0]=3,r3_3_Dims[1]=nfc3;
    capi_r3_3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_self_energy_full: failed to create array from the 11st argument `r3_3`";
    capi_r3_3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_3_Dims,r3_3_Rank,  capi_r3_3_intent,r3_3_capi,capi_errmess);
    if (capi_r3_3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3_3 = (double *)(PyArray_DATA(capi_r3_3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(w_q,qpt,pols_q,&is_q_gamma,&nqpt,&nat,&nfc2,&nfc3,&ne,qgrid,weights,fc2,fc3,r2_2,r3_2,r3_3,pos,kprim,masses,smear,&t,energies,&parallelize,&gaussian,&classical,self_energy);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_self_energy_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_r3_3_as_array!=r3_3_capi) {
        Py_XDECREF(capi_r3_3_as_array); }
    }  /* if (capi_r3_3_as_array == NULL) ... else of r3_3 */
    /* End of cleaning variable r3_3 */
    if((PyObject *)capi_r3_2_as_array!=r3_2_capi) {
        Py_XDECREF(capi_r3_2_as_array); }
    }  /* if (capi_r3_2_as_array == NULL) ... else of r3_2 */
    /* End of cleaning variable r3_2 */
    if((PyObject *)capi_r2_2_as_array!=r2_2_capi) {
        Py_XDECREF(capi_r2_2_as_array); }
    }  /* if (capi_r2_2_as_array == NULL) ... else of r2_2 */
    /* End of cleaning variable r2_2 */
    } /*CHECKSCALAR(shape(fc3, 0) == nfc3)*/
    } /*if (f2py_success) of nfc3*/
    /* End of cleaning variable nfc3 */
    } /*CHECKSCALAR(shape(fc2, 0) == nfc2)*/
    } /*if (f2py_success) of nfc2*/
    /* End of cleaning variable nfc2 */
    }  /* if (capi_self_energy_as_array == NULL) ... else of self_energy */
    /* End of cleaning variable self_energy */
    if((PyObject *)capi_pols_q_as_array!=pols_q_capi) {
        Py_XDECREF(capi_pols_q_as_array); }
    }  /* if (capi_pols_q_as_array == NULL) ... else of pols_q */
    /* End of cleaning variable pols_q */
    if((PyObject *)capi_smear_as_array!=smear_capi) {
        Py_XDECREF(capi_smear_as_array); }
    }  /* if (capi_smear_as_array == NULL) ... else of smear */
    /* End of cleaning variable smear */
    if((PyObject *)capi_masses_as_array!=masses_capi) {
        Py_XDECREF(capi_masses_as_array); }
    }  /* if (capi_masses_as_array == NULL) ... else of masses */
    /* End of cleaning variable masses */
    if((PyObject *)capi_pos_as_array!=pos_capi) {
        Py_XDECREF(capi_pos_as_array); }
    }  /* if (capi_pos_as_array == NULL) ... else of pos */
    /* End of cleaning variable pos */
    if((PyObject *)capi_fc3_as_array!=fc3_capi) {
        Py_XDECREF(capi_fc3_as_array); }
    }  /* if (capi_fc3_as_array == NULL) ... else of fc3 */
    /* End of cleaning variable fc3 */
    if((PyObject *)capi_fc2_as_array!=fc2_capi) {
        Py_XDECREF(capi_fc2_as_array); }
    }  /* if (capi_fc2_as_array == NULL) ... else of fc2 */
    /* End of cleaning variable fc2 */
    if((PyObject *)capi_weights_as_array!=weights_capi) {
        Py_XDECREF(capi_weights_as_array); }
    }  /* if (capi_weights_as_array == NULL) ... else of weights */
    /* End of cleaning variable weights */
    } /*CHECKSCALAR(shape(energies, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    } /*CHECKSCALAR(shape(w_q, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(qgrid, 1) == nqpt)*/
    } /*if (f2py_success) of nqpt*/
    /* End of cleaning variable nqpt */
    } /*if (f2py_success) of classical*/
    /* End of cleaning variable classical */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    } /*if (f2py_success) of parallelize*/
    /* End of cleaning variable parallelize */
    } /*if (f2py_success) of is_q_gamma*/
    /* End of cleaning variable is_q_gamma */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
    if((PyObject *)capi_kprim_as_array!=kprim_capi) {
        Py_XDECREF(capi_kprim_as_array); }
    }  /* if (capi_kprim_as_array == NULL) ... else of kprim */
    /* End of cleaning variable kprim */
    if((PyObject *)capi_qgrid_as_array!=qgrid_capi) {
        Py_XDECREF(capi_qgrid_as_array); }
    }  /* if (capi_qgrid_as_array == NULL) ... else of qgrid */
    /* End of cleaning variable qgrid */
    if((PyObject *)capi_qpt_as_array!=qpt_capi) {
        Py_XDECREF(capi_qpt_as_array); }
    }  /* if (capi_qpt_as_array == NULL) ... else of qpt */
    /* End of cleaning variable qpt */
    if((PyObject *)capi_w_q_as_array!=w_q_capi) {
        Py_XDECREF(capi_w_q_as_array); }
    }  /* if (capi_w_q_as_array == NULL) ... else of w_q */
    /* End of cleaning variable w_q */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************* end of calculate_self_energy_full *********************/

/******************************* check_if_gamma *******************************/
static char doc_f2py_rout_thermal_conductivity_get_lf_check_if_gamma[] = "\
is_gamma = check_if_gamma(q,kprim,w2_q,[nat])\n\nWrapper for ``check_if_gamma``.\
\n\nParameters\n----------\n"
"q : input rank-1 array('d') with bounds (3)\n"
"kprim : input rank-2 array('d') with bounds (3,3)\n"
"w2_q : in/output rank-1 array('d') with bounds (3 * nat)\n"
"\nOther Parameters\n----------------\n"
"nat : input int, optional\n    Default: shape(w2_q, 0) / 3\n"
"\nReturns\n-------\n"
"is_gamma : int";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_check_if_gamma(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,double*,double*,double*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int nat = 0;
    PyObject *nat_capi = Py_None;
    double *q = NULL;
    npy_intp q_Dims[1] = {-1};
    const int q_Rank = 1;
    PyArrayObject *capi_q_as_array = NULL;
    int capi_q_intent = 0;
    PyObject *q_capi = Py_None;
    double *kprim = NULL;
    npy_intp kprim_Dims[2] = {-1, -1};
    const int kprim_Rank = 2;
    PyArrayObject *capi_kprim_as_array = NULL;
    int capi_kprim_intent = 0;
    PyObject *kprim_capi = Py_None;
    double *w2_q = NULL;
    npy_intp w2_q_Dims[1] = {-1};
    const int w2_q_Rank = 1;
    PyArrayObject *capi_w2_q_as_array = NULL;
    int capi_w2_q_intent = 0;
    PyObject *w2_q_capi = Py_None;
    int is_gamma = 0;
    static char *capi_kwlist[] = {"q","kprim","w2_q","nat",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|O:thermal_conductivity.get_lf.check_if_gamma",\
        capi_kwlist,&q_capi,&kprim_capi,&w2_q_capi,&nat_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable q */
    q_Dims[0]=3;
    capi_q_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.check_if_gamma: failed to create array from the 1st argument `q`";
    capi_q_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,q_Dims,q_Rank,  capi_q_intent,q_capi,capi_errmess);
    if (capi_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        q = (double *)(PyArray_DATA(capi_q_as_array));

    /* Processing variable kprim */
    kprim_Dims[0]=3,kprim_Dims[1]=3;
    capi_kprim_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.check_if_gamma: failed to create array from the 2nd argument `kprim`";
    capi_kprim_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,kprim_Dims,kprim_Rank,  capi_kprim_intent,kprim_capi,capi_errmess);
    if (capi_kprim_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        kprim = (double *)(PyArray_DATA(capi_kprim_as_array));

    /* Processing variable w2_q */
    ;
    capi_w2_q_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.check_if_gamma: failed to create array from the 3rd argument `w2_q`";
    capi_w2_q_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,w2_q_Dims,w2_q_Rank,  capi_w2_q_intent,w2_q_capi,capi_errmess);
    if (capi_w2_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        w2_q = (double *)(PyArray_DATA(capi_w2_q_as_array));

    /* Processing variable is_gamma */
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(w2_q, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.get_lf.check_if_gamma() 1st keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(w2_q, 0) == 3 * nat,"shape(w2_q, 0) == 3 * nat","1st keyword nat","check_if_gamma:nat=%d",nat) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&nat,q,kprim,w2_q,&is_gamma);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("i",is_gamma);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    } /*CHECKSCALAR(shape(w2_q, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    /* End of cleaning variable is_gamma */
    if((PyObject *)capi_w2_q_as_array!=w2_q_capi) {
        Py_XDECREF(capi_w2_q_as_array); }
    }  /* if (capi_w2_q_as_array == NULL) ... else of w2_q */
    /* End of cleaning variable w2_q */
    if((PyObject *)capi_kprim_as_array!=kprim_capi) {
        Py_XDECREF(capi_kprim_as_array); }
    }  /* if (capi_kprim_as_array == NULL) ... else of kprim */
    /* End of cleaning variable kprim */
    if((PyObject *)capi_q_as_array!=q_capi) {
        Py_XDECREF(capi_q_as_array); }
    }  /* if (capi_q_as_array == NULL) ... else of q */
    /* End of cleaning variable q */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/*************************** end of check_if_gamma ***************************/

/******************************** vec_dot_mat ********************************/
static char doc_f2py_rout_thermal_conductivity_get_lf_vec_dot_mat[] = "\
v2 = vec_dot_mat(v1,m1)\n\nWrapper for ``vec_dot_mat``.\
\n\nParameters\n----------\n"
"v1 : input rank-1 array('d') with bounds (f2py_v1_d0)\n"
"m1 : input rank-2 array('d') with bounds (f2py_m1_d0,f2py_m1_d1)\n"
"\nReturns\n-------\n"
"v2 : rank-1 array('d') with bounds (size(v1)) and vec_dot_matf2pywrap storage";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_get_lf_vec_dot_mat(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *vec_dot_matf2pywrap = NULL;
    npy_intp vec_dot_matf2pywrap_Dims[1] = {-1};
    const int vec_dot_matf2pywrap_Rank = 1;
    PyArrayObject *capi_vec_dot_matf2pywrap_as_array = NULL;
    int capi_vec_dot_matf2pywrap_intent = 0;
    double *v1 = NULL;
    npy_intp v1_Dims[1] = {-1};
    const int v1_Rank = 1;
    PyArrayObject *capi_v1_as_array = NULL;
    int capi_v1_intent = 0;
    PyObject *v1_capi = Py_None;
    double *m1 = NULL;
    npy_intp m1_Dims[2] = {-1, -1};
    const int m1_Rank = 2;
    PyArrayObject *capi_m1_as_array = NULL;
    int capi_m1_intent = 0;
    PyObject *m1_capi = Py_None;
    int f2py_v1_d0 = 0;
    int f2py_m1_d0 = 0;
    int f2py_m1_d1 = 0;
    static char *capi_kwlist[] = {"v1","m1",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:thermal_conductivity.get_lf.vec_dot_mat",\
        capi_kwlist,&v1_capi,&m1_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable m1 */
    ;
    capi_m1_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.vec_dot_mat: failed to create array from the 2nd argument `m1`";
    capi_m1_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,m1_Dims,m1_Rank,  capi_m1_intent,m1_capi,capi_errmess);
    if (capi_m1_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        m1 = (double *)(PyArray_DATA(capi_m1_as_array));

    /* Processing variable v1 */
    ;
    capi_v1_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.vec_dot_mat: failed to create array from the 1st argument `v1`";
    capi_v1_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,v1_Dims,v1_Rank,  capi_v1_intent,v1_capi,capi_errmess);
    if (capi_v1_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v1 = (double *)(PyArray_DATA(capi_v1_as_array));

    /* Processing variable vec_dot_matf2pywrap */
    vec_dot_matf2pywrap_Dims[0]=size(v1);
    capi_vec_dot_matf2pywrap_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.vec_dot_mat: failed to create array from the hidden `vec_dot_matf2pywrap`";
    capi_vec_dot_matf2pywrap_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,vec_dot_matf2pywrap_Dims,vec_dot_matf2pywrap_Rank,  capi_vec_dot_matf2pywrap_intent,Py_None,capi_errmess);
    if (capi_vec_dot_matf2pywrap_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        vec_dot_matf2pywrap = (double *)(PyArray_DATA(capi_vec_dot_matf2pywrap_as_array));

    /* Processing variable f2py_v1_d0 */
    f2py_v1_d0 = shape(v1, 0);
    /* Processing variable f2py_m1_d0 */
    f2py_m1_d0 = shape(m1, 0);
    /* Processing variable f2py_m1_d1 */
    f2py_m1_d1 = shape(m1, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(vec_dot_matf2pywrap,v1,m1,&f2py_v1_d0,&f2py_m1_d0,&f2py_m1_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_vec_dot_matf2pywrap_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_m1_d1 */
    /* End of cleaning variable f2py_m1_d0 */
    /* End of cleaning variable f2py_v1_d0 */
    }  /* if (capi_vec_dot_matf2pywrap_as_array == NULL) ... else of vec_dot_matf2pywrap */
    /* End of cleaning variable vec_dot_matf2pywrap */
    if((PyObject *)capi_v1_as_array!=v1_capi) {
        Py_XDECREF(capi_v1_as_array); }
    }  /* if (capi_v1_as_array == NULL) ... else of v1 */
    /* End of cleaning variable v1 */
    if((PyObject *)capi_m1_as_array!=m1_capi) {
        Py_XDECREF(capi_m1_as_array); }
    }  /* if (capi_m1_as_array == NULL) ... else of m1 */
    /* End of cleaning variable m1 */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of vec_dot_mat *****************************/

/******************* calculate_real_part_via_kramers_kronig *******************/
static char doc_f2py_rout_thermal_conductivity_get_lf_calculate_real_part_via_kramers_kronig[] = "\
calculate_real_part_via_kramers_kronig(self_energy,energies,freq,[ne,nband])\n\nWrapper for ``calculate_real_part_via_kramers_kronig``.\
\n\nParameters\n----------\n"
"self_energy : in/output rank-2 array('D') with bounds (ne,nband)\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"freq : input rank-1 array('d') with bounds (nband)\n"
"\nOther Parameters\n----------------\n"
"ne : input int, optional\n    Default: shape(self_energy, 0)\n"
"nband : input int, optional\n    Default: shape(self_energy, 1)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_calculate_real_part_via_kramers_kronig(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,complex_double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int ne = 0;
    PyObject *ne_capi = Py_None;
    int nband = 0;
    PyObject *nband_capi = Py_None;
    complex_double *self_energy = NULL;
    npy_intp self_energy_Dims[2] = {-1, -1};
    const int self_energy_Rank = 2;
    PyArrayObject *capi_self_energy_as_array = NULL;
    int capi_self_energy_intent = 0;
    PyObject *self_energy_capi = Py_None;
    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    double *freq = NULL;
    npy_intp freq_Dims[1] = {-1};
    const int freq_Rank = 1;
    PyArrayObject *capi_freq_as_array = NULL;
    int capi_freq_intent = 0;
    PyObject *freq_capi = Py_None;
    static char *capi_kwlist[] = {"self_energy","energies","freq","ne","nband",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|OO:thermal_conductivity.get_lf.calculate_real_part_via_kramers_kronig",\
        capi_kwlist,&self_energy_capi,&energies_capi,&freq_capi,&ne_capi,&nband_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable self_energy */
    ;
    capi_self_energy_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_real_part_via_kramers_kronig: failed to create array from the 1st argument `self_energy`";
    capi_self_energy_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,self_energy_Dims,self_energy_Rank,  capi_self_energy_intent,self_energy_capi,capi_errmess);
    if (capi_self_energy_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        self_energy = (complex_double *)(PyArray_DATA(capi_self_energy_as_array));

    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(self_energy, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.get_lf.calculate_real_part_via_kramers_kronig() 1st keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(self_energy, 0) == ne,"shape(self_energy, 0) == ne","1st keyword ne","calculate_real_part_via_kramers_kronig:ne=%d",ne) {
    /* Processing variable nband */
    if (nband_capi == Py_None) nband = shape(self_energy, 1); else
        f2py_success = int_from_pyobj(&nband,nband_capi,"thermal_conductivity.get_lf.calculate_real_part_via_kramers_kronig() 2nd keyword (nband) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(self_energy, 1) == nband,"shape(self_energy, 1) == nband","2nd keyword nband","calculate_real_part_via_kramers_kronig:nband=%d",nband) {
    /* Processing variable energies */
    energies_Dims[0]=ne;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_real_part_via_kramers_kronig: failed to create array from the 2nd argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

    /* Processing variable freq */
    freq_Dims[0]=nband;
    capi_freq_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_real_part_via_kramers_kronig: failed to create array from the 3rd argument `freq`";
    capi_freq_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,freq_Dims,freq_Rank,  capi_freq_intent,freq_capi,capi_errmess);
    if (capi_freq_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        freq = (double *)(PyArray_DATA(capi_freq_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&ne,&nband,self_energy,energies,freq);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_freq_as_array!=freq_capi) {
        Py_XDECREF(capi_freq_as_array); }
    }  /* if (capi_freq_as_array == NULL) ... else of freq */
    /* End of cleaning variable freq */
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
    } /*CHECKSCALAR(shape(self_energy, 1) == nband)*/
    } /*if (f2py_success) of nband*/
    /* End of cleaning variable nband */
    } /*CHECKSCALAR(shape(self_energy, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    if((PyObject *)capi_self_energy_as_array!=self_energy_capi) {
        Py_XDECREF(capi_self_energy_as_array); }
    }  /* if (capi_self_energy_as_array == NULL) ... else of self_energy */
    /* End of cleaning variable self_energy */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/*************** end of calculate_real_part_via_kramers_kronig ***************/

/***************** calculate_real_part_via_kramers_kronig_2d *****************/
static char doc_f2py_rout_thermal_conductivity_get_lf_calculate_real_part_via_kramers_kronig_2d[] = "\
calculate_real_part_via_kramers_kronig_2d(self_energy,energies,freq,[ne,nband])\n\nWrapper for ``calculate_real_part_via_kramers_kronig_2d``.\
\n\nParameters\n----------\n"
"self_energy : in/output rank-3 array('D') with bounds (ne,nband,nband)\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"freq : input rank-1 array('d') with bounds (nband)\n"
"\nOther Parameters\n----------------\n"
"ne : input int, optional\n    Default: shape(self_energy, 0)\n"
"nband : input int, optional\n    Default: shape(self_energy, 1)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_calculate_real_part_via_kramers_kronig_2d(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,complex_double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int ne = 0;
    PyObject *ne_capi = Py_None;
    int nband = 0;
    PyObject *nband_capi = Py_None;
    complex_double *self_energy = NULL;
    npy_intp self_energy_Dims[3] = {-1, -1, -1};
    const int self_energy_Rank = 3;
    PyArrayObject *capi_self_energy_as_array = NULL;
    int capi_self_energy_intent = 0;
    PyObject *self_energy_capi = Py_None;
    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    double *freq = NULL;
    npy_intp freq_Dims[1] = {-1};
    const int freq_Rank = 1;
    PyArrayObject *capi_freq_as_array = NULL;
    int capi_freq_intent = 0;
    PyObject *freq_capi = Py_None;
    static char *capi_kwlist[] = {"self_energy","energies","freq","ne","nband",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|OO:thermal_conductivity.get_lf.calculate_real_part_via_kramers_kronig_2d",\
        capi_kwlist,&self_energy_capi,&energies_capi,&freq_capi,&ne_capi,&nband_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable self_energy */
    ;
    capi_self_energy_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_real_part_via_kramers_kronig_2d: failed to create array from the 1st argument `self_energy`";
    capi_self_energy_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,self_energy_Dims,self_energy_Rank,  capi_self_energy_intent,self_energy_capi,capi_errmess);
    if (capi_self_energy_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        self_energy = (complex_double *)(PyArray_DATA(capi_self_energy_as_array));

    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(self_energy, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.get_lf.calculate_real_part_via_kramers_kronig_2d() 1st keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(self_energy, 0) == ne,"shape(self_energy, 0) == ne","1st keyword ne","calculate_real_part_via_kramers_kronig_2d:ne=%d",ne) {
    /* Processing variable nband */
    if (nband_capi == Py_None) nband = shape(self_energy, 1); else
        f2py_success = int_from_pyobj(&nband,nband_capi,"thermal_conductivity.get_lf.calculate_real_part_via_kramers_kronig_2d() 2nd keyword (nband) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(self_energy, 1) == nband,"shape(self_energy, 1) == nband","2nd keyword nband","calculate_real_part_via_kramers_kronig_2d:nband=%d",nband) {
    /* Processing variable energies */
    energies_Dims[0]=ne;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_real_part_via_kramers_kronig_2d: failed to create array from the 2nd argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

    /* Processing variable freq */
    freq_Dims[0]=nband;
    capi_freq_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.calculate_real_part_via_kramers_kronig_2d: failed to create array from the 3rd argument `freq`";
    capi_freq_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,freq_Dims,freq_Rank,  capi_freq_intent,freq_capi,capi_errmess);
    if (capi_freq_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        freq = (double *)(PyArray_DATA(capi_freq_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&ne,&nband,self_energy,energies,freq);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_freq_as_array!=freq_capi) {
        Py_XDECREF(capi_freq_as_array); }
    }  /* if (capi_freq_as_array == NULL) ... else of freq */
    /* End of cleaning variable freq */
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
    } /*CHECKSCALAR(shape(self_energy, 1) == nband)*/
    } /*if (f2py_success) of nband*/
    /* End of cleaning variable nband */
    } /*CHECKSCALAR(shape(self_energy, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    if((PyObject *)capi_self_energy_as_array!=self_energy_capi) {
        Py_XDECREF(capi_self_energy_as_array); }
    }  /* if (capi_self_energy_as_array == NULL) ... else of self_energy */
    /* End of cleaning variable self_energy */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************** end of calculate_real_part_via_kramers_kronig_2d **************/

/************************* hilbert_transform_via_fft *************************/
static char doc_f2py_rout_thermal_conductivity_get_lf_hilbert_transform_via_fft[] = "\
hilbert_transform_via_fft(self_energy,[ne,nband])\n\nWrapper for ``hilbert_transform_via_fft``.\
\n\nParameters\n----------\n"
"self_energy : in/output rank-2 array('D') with bounds (ne,nband)\n"
"\nOther Parameters\n----------------\n"
"ne : input int, optional\n    Default: shape(self_energy, 0)\n"
"nband : input int, optional\n    Default: shape(self_energy, 1)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_hilbert_transform_via_fft(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int ne = 0;
    PyObject *ne_capi = Py_None;
    int nband = 0;
    PyObject *nband_capi = Py_None;
    complex_double *self_energy = NULL;
    npy_intp self_energy_Dims[2] = {-1, -1};
    const int self_energy_Rank = 2;
    PyArrayObject *capi_self_energy_as_array = NULL;
    int capi_self_energy_intent = 0;
    PyObject *self_energy_capi = Py_None;
    static char *capi_kwlist[] = {"self_energy","ne","nband",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "O|OO:thermal_conductivity.get_lf.hilbert_transform_via_fft",\
        capi_kwlist,&self_energy_capi,&ne_capi,&nband_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable self_energy */
    ;
    capi_self_energy_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.hilbert_transform_via_fft: failed to create array from the 1st argument `self_energy`";
    capi_self_energy_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,self_energy_Dims,self_energy_Rank,  capi_self_energy_intent,self_energy_capi,capi_errmess);
    if (capi_self_energy_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        self_energy = (complex_double *)(PyArray_DATA(capi_self_energy_as_array));

    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(self_energy, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.get_lf.hilbert_transform_via_fft() 1st keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(self_energy, 0) == ne,"shape(self_energy, 0) == ne","1st keyword ne","hilbert_transform_via_fft:ne=%d",ne) {
    /* Processing variable nband */
    if (nband_capi == Py_None) nband = shape(self_energy, 1); else
        f2py_success = int_from_pyobj(&nband,nband_capi,"thermal_conductivity.get_lf.hilbert_transform_via_fft() 2nd keyword (nband) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(self_energy, 1) == nband,"shape(self_energy, 1) == nband","2nd keyword nband","hilbert_transform_via_fft:nband=%d",nband) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&ne,&nband,self_energy);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    } /*CHECKSCALAR(shape(self_energy, 1) == nband)*/
    } /*if (f2py_success) of nband*/
    /* End of cleaning variable nband */
    } /*CHECKSCALAR(shape(self_energy, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    if((PyObject *)capi_self_energy_as_array!=self_energy_capi) {
        Py_XDECREF(capi_self_energy_as_array); }
    }  /* if (capi_self_energy_as_array == NULL) ... else of self_energy */
    /* End of cleaning variable self_energy */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************** end of hilbert_transform_via_fft **********************/

/************************************* ht *************************************/
static char doc_f2py_rout_thermal_conductivity_get_lf_ht[] = "\
ht(x,[n])\n\nWrapper for ``ht``.\
\n\nParameters\n----------\n"
"x : in/output rank-1 array('d') with bounds (n)\n"
"\nOther Parameters\n----------------\n"
"n : input int, optional\n    Default: shape(x, 0)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_ht(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *x = NULL;
    npy_intp x_Dims[1] = {-1};
    const int x_Rank = 1;
    PyArrayObject *capi_x_as_array = NULL;
    int capi_x_intent = 0;
    PyObject *x_capi = Py_None;
    int n = 0;
    PyObject *n_capi = Py_None;
    static char *capi_kwlist[] = {"x","n",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "O|O:thermal_conductivity.get_lf.ht",\
        capi_kwlist,&x_capi,&n_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable x */
    ;
    capi_x_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.ht: failed to create array from the 1st argument `x`";
    capi_x_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,x_Dims,x_Rank,  capi_x_intent,x_capi,capi_errmess);
    if (capi_x_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        x = (double *)(PyArray_DATA(capi_x_as_array));

    /* Processing variable n */
    if (n_capi == Py_None) n = shape(x, 0); else
        f2py_success = int_from_pyobj(&n,n_capi,"thermal_conductivity.get_lf.ht() 1st keyword (n) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(x, 0) == n,"shape(x, 0) == n","1st keyword n","ht:n=%d",n) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(x,&n);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    } /*CHECKSCALAR(shape(x, 0) == n)*/
    } /*if (f2py_success) of n*/
    /* End of cleaning variable n */
    if((PyObject *)capi_x_as_array!=x_capi) {
        Py_XDECREF(capi_x_as_array); }
    }  /* if (capi_x_as_array == NULL) ... else of x */
    /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************************* end of ht *********************************/

/************************************ cfft ************************************/
static char doc_f2py_rout_thermal_conductivity_get_lf_cfft[] = "\
cfft(x,isig,[n])\n\nWrapper for ``cfft``.\
\n\nParameters\n----------\n"
"x : in/output rank-1 array('D') with bounds (n)\n"
"isig : input int\n"
"\nOther Parameters\n----------------\n"
"n : input int, optional\n    Default: shape(x, 0)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_cfft(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(complex_double*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    complex_double *x = NULL;
    npy_intp x_Dims[1] = {-1};
    const int x_Rank = 1;
    PyArrayObject *capi_x_as_array = NULL;
    int capi_x_intent = 0;
    PyObject *x_capi = Py_None;
    int n = 0;
    PyObject *n_capi = Py_None;
    int isig = 0;
    PyObject *isig_capi = Py_None;
    static char *capi_kwlist[] = {"x","isig","n",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|O:thermal_conductivity.get_lf.cfft",\
        capi_kwlist,&x_capi,&isig_capi,&n_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable isig */
        f2py_success = int_from_pyobj(&isig,isig_capi,"thermal_conductivity.get_lf.cfft() 2nd argument (isig) can't be converted to int");
    if (f2py_success) {
    /* Processing variable x */
    ;
    capi_x_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.cfft: failed to create array from the 1st argument `x`";
    capi_x_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,x_Dims,x_Rank,  capi_x_intent,x_capi,capi_errmess);
    if (capi_x_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        x = (complex_double *)(PyArray_DATA(capi_x_as_array));

    /* Processing variable n */
    if (n_capi == Py_None) n = shape(x, 0); else
        f2py_success = int_from_pyobj(&n,n_capi,"thermal_conductivity.get_lf.cfft() 1st keyword (n) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(x, 0) == n,"shape(x, 0) == n","1st keyword n","cfft:n=%d",n) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(x,&n,&isig);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    } /*CHECKSCALAR(shape(x, 0) == n)*/
    } /*if (f2py_success) of n*/
    /* End of cleaning variable n */
    if((PyObject *)capi_x_as_array!=x_capi) {
        Py_XDECREF(capi_x_as_array); }
    }  /* if (capi_x_as_array == NULL) ... else of x */
    /* End of cleaning variable x */
    } /*if (f2py_success) of isig*/
    /* End of cleaning variable isig */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************** end of cfft ********************************/

/************************************ inv ************************************/
static char doc_f2py_rout_thermal_conductivity_get_lf_inv[] = "\
ainv = inv(a)\n\nWrapper for ``inv``.\
\n\nParameters\n----------\n"
"a : input rank-2 array('d') with bounds (f2py_a_d0,f2py_a_d1)\n"
"\nReturns\n-------\n"
"ainv : rank-2 array('d') with bounds (size(a, 1),size(a, 2)) and invf2pywrap storage";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_get_lf_inv(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *invf2pywrap = NULL;
    npy_intp invf2pywrap_Dims[2] = {-1, -1};
    const int invf2pywrap_Rank = 2;
    PyArrayObject *capi_invf2pywrap_as_array = NULL;
    int capi_invf2pywrap_intent = 0;
    double *a = NULL;
    npy_intp a_Dims[2] = {-1, -1};
    const int a_Rank = 2;
    PyArrayObject *capi_a_as_array = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    int f2py_a_d0 = 0;
    int f2py_a_d1 = 0;
    static char *capi_kwlist[] = {"a",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "O|:thermal_conductivity.get_lf.inv",\
        capi_kwlist,&a_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    ;
    capi_a_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.inv: failed to create array from the 1st argument `a`";
    capi_a_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,a_Dims,a_Rank,  capi_a_intent,a_capi,capi_errmess);
    if (capi_a_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        a = (double *)(PyArray_DATA(capi_a_as_array));

    /* Processing variable invf2pywrap */
    invf2pywrap_Dims[0]=size(a, 1),invf2pywrap_Dims[1]=size(a, 2);
    capi_invf2pywrap_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.inv: failed to create array from the hidden `invf2pywrap`";
    capi_invf2pywrap_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,invf2pywrap_Dims,invf2pywrap_Rank,  capi_invf2pywrap_intent,Py_None,capi_errmess);
    if (capi_invf2pywrap_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        invf2pywrap = (double *)(PyArray_DATA(capi_invf2pywrap_as_array));

    /* Processing variable f2py_a_d0 */
    f2py_a_d0 = shape(a, 0);
    /* Processing variable f2py_a_d1 */
    f2py_a_d1 = shape(a, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(invf2pywrap,a,&f2py_a_d0,&f2py_a_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_invf2pywrap_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_a_d1 */
    /* End of cleaning variable f2py_a_d0 */
    }  /* if (capi_invf2pywrap_as_array == NULL) ... else of invf2pywrap */
    /* End of cleaning variable invf2pywrap */
    if((PyObject *)capi_a_as_array!=a_capi) {
        Py_XDECREF(capi_a_as_array); }
    }  /* if (capi_a_as_array == NULL) ... else of a */
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************************* end of inv *********************************/

/****************************** interpolate_fc2 ******************************/
static char doc_f2py_rout_thermal_conductivity_get_lf_interpolate_fc2[] = "\
w2_q,pols_q,pols_q1 = interpolate_fc2(fc2,r2_2,masses,pos,q,[nfc2,nat])\n\nWrapper for ``interpolate_fc2``.\
\n\nParameters\n----------\n"
"fc2 : input rank-3 array('d') with bounds (nfc2,3 * nat,3 * nat)\n"
"r2_2 : input rank-2 array('d') with bounds (3,nfc2)\n"
"masses : input rank-1 array('d') with bounds (nat)\n"
"pos : input rank-2 array('d') with bounds (3,nat)\n"
"q : input rank-1 array('d') with bounds (3)\n"
"\nOther Parameters\n----------------\n"
"nfc2 : input int, optional\n    Default: shape(fc2, 0)\n"
"nat : input int, optional\n    Default: shape(fc2, 1) / 3\n"
"\nReturns\n-------\n"
"w2_q : rank-1 array('d') with bounds (3 * nat)\n"
"pols_q : rank-2 array('D') with bounds (3 * nat,3 * nat)\n"
"pols_q1 : rank-2 array('D') with bounds (3 * nat,3 * nat)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_get_lf_interpolate_fc2(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,double*,double*,double*,double*,double*,double*,complex_double*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int nfc2 = 0;
    PyObject *nfc2_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    double *fc2 = NULL;
    npy_intp fc2_Dims[3] = {-1, -1, -1};
    const int fc2_Rank = 3;
    PyArrayObject *capi_fc2_as_array = NULL;
    int capi_fc2_intent = 0;
    PyObject *fc2_capi = Py_None;
    double *r2_2 = NULL;
    npy_intp r2_2_Dims[2] = {-1, -1};
    const int r2_2_Rank = 2;
    PyArrayObject *capi_r2_2_as_array = NULL;
    int capi_r2_2_intent = 0;
    PyObject *r2_2_capi = Py_None;
    double *masses = NULL;
    npy_intp masses_Dims[1] = {-1};
    const int masses_Rank = 1;
    PyArrayObject *capi_masses_as_array = NULL;
    int capi_masses_intent = 0;
    PyObject *masses_capi = Py_None;
    double *pos = NULL;
    npy_intp pos_Dims[2] = {-1, -1};
    const int pos_Rank = 2;
    PyArrayObject *capi_pos_as_array = NULL;
    int capi_pos_intent = 0;
    PyObject *pos_capi = Py_None;
    double *q = NULL;
    npy_intp q_Dims[1] = {-1};
    const int q_Rank = 1;
    PyArrayObject *capi_q_as_array = NULL;
    int capi_q_intent = 0;
    PyObject *q_capi = Py_None;
    double *w2_q = NULL;
    npy_intp w2_q_Dims[1] = {-1};
    const int w2_q_Rank = 1;
    PyArrayObject *capi_w2_q_as_array = NULL;
    int capi_w2_q_intent = 0;
    complex_double *pols_q = NULL;
    npy_intp pols_q_Dims[2] = {-1, -1};
    const int pols_q_Rank = 2;
    PyArrayObject *capi_pols_q_as_array = NULL;
    int capi_pols_q_intent = 0;
    complex_double *pols_q1 = NULL;
    npy_intp pols_q1_Dims[2] = {-1, -1};
    const int pols_q1_Rank = 2;
    PyArrayObject *capi_pols_q1_as_array = NULL;
    int capi_pols_q1_intent = 0;
    static char *capi_kwlist[] = {"fc2","r2_2","masses","pos","q","nfc2","nat",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOO|OO:thermal_conductivity.get_lf.interpolate_fc2",\
        capi_kwlist,&fc2_capi,&r2_2_capi,&masses_capi,&pos_capi,&q_capi,&nfc2_capi,&nat_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable fc2 */
    ;
    capi_fc2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.interpolate_fc2: failed to create array from the 1st argument `fc2`";
    capi_fc2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc2_Dims,fc2_Rank,  capi_fc2_intent,fc2_capi,capi_errmess);
    if (capi_fc2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc2 = (double *)(PyArray_DATA(capi_fc2_as_array));

    /* Processing variable q */
    q_Dims[0]=3;
    capi_q_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.interpolate_fc2: failed to create array from the 5th argument `q`";
    capi_q_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,q_Dims,q_Rank,  capi_q_intent,q_capi,capi_errmess);
    if (capi_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        q = (double *)(PyArray_DATA(capi_q_as_array));

    /* Processing variable nfc2 */
    if (nfc2_capi == Py_None) nfc2 = shape(fc2, 0); else
        f2py_success = int_from_pyobj(&nfc2,nfc2_capi,"thermal_conductivity.get_lf.interpolate_fc2() 1st keyword (nfc2) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 0) == nfc2,"shape(fc2, 0) == nfc2","1st keyword nfc2","interpolate_fc2:nfc2=%d",nfc2) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(fc2, 1) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.get_lf.interpolate_fc2() 2nd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc2, 1) == 3 * nat,"shape(fc2, 1) == 3 * nat","2nd keyword nat","interpolate_fc2:nat=%d",nat) {
    /* Processing variable r2_2 */
    r2_2_Dims[0]=3,r2_2_Dims[1]=nfc2;
    capi_r2_2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.interpolate_fc2: failed to create array from the 2nd argument `r2_2`";
    capi_r2_2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_2_Dims,r2_2_Rank,  capi_r2_2_intent,r2_2_capi,capi_errmess);
    if (capi_r2_2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2_2 = (double *)(PyArray_DATA(capi_r2_2_as_array));

    /* Processing variable pos */
    pos_Dims[0]=3,pos_Dims[1]=nat;
    capi_pos_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.interpolate_fc2: failed to create array from the 4th argument `pos`";
    capi_pos_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,pos_Dims,pos_Rank,  capi_pos_intent,pos_capi,capi_errmess);
    if (capi_pos_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pos = (double *)(PyArray_DATA(capi_pos_as_array));

    /* Processing variable masses */
    masses_Dims[0]=nat;
    capi_masses_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.interpolate_fc2: failed to create array from the 3rd argument `masses`";
    capi_masses_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,masses_Dims,masses_Rank,  capi_masses_intent,masses_capi,capi_errmess);
    if (capi_masses_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        masses = (double *)(PyArray_DATA(capi_masses_as_array));

    /* Processing variable w2_q */
    w2_q_Dims[0]=3 * nat;
    capi_w2_q_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.interpolate_fc2: failed to create array from the hidden `w2_q`";
    capi_w2_q_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,w2_q_Dims,w2_q_Rank,  capi_w2_q_intent,Py_None,capi_errmess);
    if (capi_w2_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        w2_q = (double *)(PyArray_DATA(capi_w2_q_as_array));

    /* Processing variable pols_q */
    pols_q_Dims[0]=3 * nat,pols_q_Dims[1]=3 * nat;
    capi_pols_q_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.interpolate_fc2: failed to create array from the hidden `pols_q`";
    capi_pols_q_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,pols_q_Dims,pols_q_Rank,  capi_pols_q_intent,Py_None,capi_errmess);
    if (capi_pols_q_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pols_q = (complex_double *)(PyArray_DATA(capi_pols_q_as_array));

    /* Processing variable pols_q1 */
    pols_q1_Dims[0]=3 * nat,pols_q1_Dims[1]=3 * nat;
    capi_pols_q1_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.get_lf.interpolate_fc2: failed to create array from the hidden `pols_q1`";
    capi_pols_q1_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,pols_q1_Dims,pols_q1_Rank,  capi_pols_q1_intent,Py_None,capi_errmess);
    if (capi_pols_q1_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pols_q1 = (complex_double *)(PyArray_DATA(capi_pols_q1_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&nfc2,&nat,fc2,r2_2,masses,pos,q,w2_q,pols_q,pols_q1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NNN",capi_w2_q_as_array,capi_pols_q_as_array,capi_pols_q1_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_pols_q1_as_array == NULL) ... else of pols_q1 */
    /* End of cleaning variable pols_q1 */
    }  /* if (capi_pols_q_as_array == NULL) ... else of pols_q */
    /* End of cleaning variable pols_q */
    }  /* if (capi_w2_q_as_array == NULL) ... else of w2_q */
    /* End of cleaning variable w2_q */
    if((PyObject *)capi_masses_as_array!=masses_capi) {
        Py_XDECREF(capi_masses_as_array); }
    }  /* if (capi_masses_as_array == NULL) ... else of masses */
    /* End of cleaning variable masses */
    if((PyObject *)capi_pos_as_array!=pos_capi) {
        Py_XDECREF(capi_pos_as_array); }
    }  /* if (capi_pos_as_array == NULL) ... else of pos */
    /* End of cleaning variable pos */
    if((PyObject *)capi_r2_2_as_array!=r2_2_capi) {
        Py_XDECREF(capi_r2_2_as_array); }
    }  /* if (capi_r2_2_as_array == NULL) ... else of r2_2 */
    /* End of cleaning variable r2_2 */
    } /*CHECKSCALAR(shape(fc2, 1) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(fc2, 0) == nfc2)*/
    } /*if (f2py_success) of nfc2*/
    /* End of cleaning variable nfc2 */
    if((PyObject *)capi_q_as_array!=q_capi) {
        Py_XDECREF(capi_q_as_array); }
    }  /* if (capi_q_as_array == NULL) ... else of q */
    /* End of cleaning variable q */
    if((PyObject *)capi_fc2_as_array!=fc2_capi) {
        Py_XDECREF(capi_fc2_as_array); }
    }  /* if (capi_fc2_as_array == NULL) ... else of fc2 */
    /* End of cleaning variable fc2 */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/*************************** end of interpolate_fc2 ***************************/

/*************************** get_scattering_q_grid ***************************/
static char doc_f2py_rout_thermal_conductivity_scattering_grids_get_scattering_q_grid[] = "\
scattering_grid,scattering_weights = get_scattering_q_grid(rotations,irrqgrid,qgrid,scatt_qgrid,[nirrqpt,nqpt,scatt_nqpt,nsym])\n\nWrapper for ``get_scattering_q_grid``.\
\n\nParameters\n----------\n"
"rotations : input rank-3 array('d') with bounds (nsym,3,3)\n"
"irrqgrid : input rank-2 array('d') with bounds (nirrqpt,3)\n"
"qgrid : input rank-2 array('d') with bounds (nqpt,3)\n"
"scatt_qgrid : input rank-2 array('d') with bounds (scatt_nqpt,3)\n"
"\nOther Parameters\n----------------\n"
"nirrqpt : input int, optional\n    Default: shape(irrqgrid, 0)\n"
"nqpt : input int, optional\n    Default: shape(qgrid, 0)\n"
"scatt_nqpt : input int, optional\n    Default: shape(scatt_qgrid, 0)\n"
"nsym : input int, optional\n    Default: shape(rotations, 0)\n"
"\nReturns\n-------\n"
"scattering_grid : rank-3 array('d') with bounds (nirrqpt,scatt_nqpt,3)\n"
"scattering_weights : rank-2 array('i') with bounds (nirrqpt,scatt_nqpt)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_scattering_grids_get_scattering_q_grid(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,int*,int*,int*,double*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *rotations = NULL;
    npy_intp rotations_Dims[3] = {-1, -1, -1};
    const int rotations_Rank = 3;
    PyArrayObject *capi_rotations_as_array = NULL;
    int capi_rotations_intent = 0;
    PyObject *rotations_capi = Py_None;
    double *irrqgrid = NULL;
    npy_intp irrqgrid_Dims[2] = {-1, -1};
    const int irrqgrid_Rank = 2;
    PyArrayObject *capi_irrqgrid_as_array = NULL;
    int capi_irrqgrid_intent = 0;
    PyObject *irrqgrid_capi = Py_None;
    double *qgrid = NULL;
    npy_intp qgrid_Dims[2] = {-1, -1};
    const int qgrid_Rank = 2;
    PyArrayObject *capi_qgrid_as_array = NULL;
    int capi_qgrid_intent = 0;
    PyObject *qgrid_capi = Py_None;
    double *scatt_qgrid = NULL;
    npy_intp scatt_qgrid_Dims[2] = {-1, -1};
    const int scatt_qgrid_Rank = 2;
    PyArrayObject *capi_scatt_qgrid_as_array = NULL;
    int capi_scatt_qgrid_intent = 0;
    PyObject *scatt_qgrid_capi = Py_None;
    int nirrqpt = 0;
    PyObject *nirrqpt_capi = Py_None;
    int nqpt = 0;
    PyObject *nqpt_capi = Py_None;
    int scatt_nqpt = 0;
    PyObject *scatt_nqpt_capi = Py_None;
    int nsym = 0;
    PyObject *nsym_capi = Py_None;
    double *scattering_grid = NULL;
    npy_intp scattering_grid_Dims[3] = {-1, -1, -1};
    const int scattering_grid_Rank = 3;
    PyArrayObject *capi_scattering_grid_as_array = NULL;
    int capi_scattering_grid_intent = 0;
    int *scattering_weights = NULL;
    npy_intp scattering_weights_Dims[2] = {-1, -1};
    const int scattering_weights_Rank = 2;
    PyArrayObject *capi_scattering_weights_as_array = NULL;
    int capi_scattering_weights_intent = 0;
    static char *capi_kwlist[] = {"rotations","irrqgrid","qgrid","scatt_qgrid","nirrqpt","nqpt","scatt_nqpt","nsym",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOO|OOOO:thermal_conductivity.scattering_grids.get_scattering_q_grid",\
        capi_kwlist,&rotations_capi,&irrqgrid_capi,&qgrid_capi,&scatt_qgrid_capi,&nirrqpt_capi,&nqpt_capi,&scatt_nqpt_capi,&nsym_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable rotations */
    rotations_Dims[1]=3,rotations_Dims[2]=3;
    capi_rotations_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.scattering_grids.get_scattering_q_grid: failed to create array from the 1st argument `rotations`";
    capi_rotations_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,rotations_Dims,rotations_Rank,  capi_rotations_intent,rotations_capi,capi_errmess);
    if (capi_rotations_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        rotations = (double *)(PyArray_DATA(capi_rotations_as_array));

    /* Processing variable irrqgrid */
    irrqgrid_Dims[1]=3;
    capi_irrqgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.scattering_grids.get_scattering_q_grid: failed to create array from the 2nd argument `irrqgrid`";
    capi_irrqgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,irrqgrid_Dims,irrqgrid_Rank,  capi_irrqgrid_intent,irrqgrid_capi,capi_errmess);
    if (capi_irrqgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        irrqgrid = (double *)(PyArray_DATA(capi_irrqgrid_as_array));

    /* Processing variable qgrid */
    qgrid_Dims[1]=3;
    capi_qgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.scattering_grids.get_scattering_q_grid: failed to create array from the 3rd argument `qgrid`";
    capi_qgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,qgrid_Dims,qgrid_Rank,  capi_qgrid_intent,qgrid_capi,capi_errmess);
    if (capi_qgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        qgrid = (double *)(PyArray_DATA(capi_qgrid_as_array));

    /* Processing variable scatt_qgrid */
    scatt_qgrid_Dims[1]=3;
    capi_scatt_qgrid_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.scattering_grids.get_scattering_q_grid: failed to create array from the 4th argument `scatt_qgrid`";
    capi_scatt_qgrid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,scatt_qgrid_Dims,scatt_qgrid_Rank,  capi_scatt_qgrid_intent,scatt_qgrid_capi,capi_errmess);
    if (capi_scatt_qgrid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        scatt_qgrid = (double *)(PyArray_DATA(capi_scatt_qgrid_as_array));

    /* Processing variable nirrqpt */
    if (nirrqpt_capi == Py_None) nirrqpt = shape(irrqgrid, 0); else
        f2py_success = int_from_pyobj(&nirrqpt,nirrqpt_capi,"thermal_conductivity.scattering_grids.get_scattering_q_grid() 1st keyword (nirrqpt) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(irrqgrid, 0) == nirrqpt,"shape(irrqgrid, 0) == nirrqpt","1st keyword nirrqpt","get_scattering_q_grid:nirrqpt=%d",nirrqpt) {
    /* Processing variable nqpt */
    if (nqpt_capi == Py_None) nqpt = shape(qgrid, 0); else
        f2py_success = int_from_pyobj(&nqpt,nqpt_capi,"thermal_conductivity.scattering_grids.get_scattering_q_grid() 2nd keyword (nqpt) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(qgrid, 0) == nqpt,"shape(qgrid, 0) == nqpt","2nd keyword nqpt","get_scattering_q_grid:nqpt=%d",nqpt) {
    /* Processing variable nsym */
    if (nsym_capi == Py_None) nsym = shape(rotations, 0); else
        f2py_success = int_from_pyobj(&nsym,nsym_capi,"thermal_conductivity.scattering_grids.get_scattering_q_grid() 4th keyword (nsym) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(rotations, 0) == nsym,"shape(rotations, 0) == nsym","4th keyword nsym","get_scattering_q_grid:nsym=%d",nsym) {
    /* Processing variable scatt_nqpt */
    if (scatt_nqpt_capi == Py_None) scatt_nqpt = shape(scatt_qgrid, 0); else
        f2py_success = int_from_pyobj(&scatt_nqpt,scatt_nqpt_capi,"thermal_conductivity.scattering_grids.get_scattering_q_grid() 3rd keyword (scatt_nqpt) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(scatt_qgrid, 0) == scatt_nqpt,"shape(scatt_qgrid, 0) == scatt_nqpt","3rd keyword scatt_nqpt","get_scattering_q_grid:scatt_nqpt=%d",scatt_nqpt) {
    /* Processing variable scattering_grid */
    scattering_grid_Dims[0]=nirrqpt,scattering_grid_Dims[1]=scatt_nqpt,scattering_grid_Dims[2]=3;
    capi_scattering_grid_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.scattering_grids.get_scattering_q_grid: failed to create array from the hidden `scattering_grid`";
    capi_scattering_grid_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,scattering_grid_Dims,scattering_grid_Rank,  capi_scattering_grid_intent,Py_None,capi_errmess);
    if (capi_scattering_grid_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        scattering_grid = (double *)(PyArray_DATA(capi_scattering_grid_as_array));

    /* Processing variable scattering_weights */
    scattering_weights_Dims[0]=nirrqpt,scattering_weights_Dims[1]=scatt_nqpt;
    capi_scattering_weights_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.scattering_grids.get_scattering_q_grid: failed to create array from the hidden `scattering_weights`";
    capi_scattering_weights_as_array = ndarray_from_pyobj(  NPY_INT,1,scattering_weights_Dims,scattering_weights_Rank,  capi_scattering_weights_intent,Py_None,capi_errmess);
    if (capi_scattering_weights_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        scattering_weights = (int *)(PyArray_DATA(capi_scattering_weights_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(rotations,irrqgrid,qgrid,scatt_qgrid,&nirrqpt,&nqpt,&scatt_nqpt,&nsym,scattering_grid,scattering_weights);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NN",capi_scattering_grid_as_array,capi_scattering_weights_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_scattering_weights_as_array == NULL) ... else of scattering_weights */
    /* End of cleaning variable scattering_weights */
    }  /* if (capi_scattering_grid_as_array == NULL) ... else of scattering_grid */
    /* End of cleaning variable scattering_grid */
    } /*CHECKSCALAR(shape(scatt_qgrid, 0) == scatt_nqpt)*/
    } /*if (f2py_success) of scatt_nqpt*/
    /* End of cleaning variable scatt_nqpt */
    } /*CHECKSCALAR(shape(rotations, 0) == nsym)*/
    } /*if (f2py_success) of nsym*/
    /* End of cleaning variable nsym */
    } /*CHECKSCALAR(shape(qgrid, 0) == nqpt)*/
    } /*if (f2py_success) of nqpt*/
    /* End of cleaning variable nqpt */
    } /*CHECKSCALAR(shape(irrqgrid, 0) == nirrqpt)*/
    } /*if (f2py_success) of nirrqpt*/
    /* End of cleaning variable nirrqpt */
    if((PyObject *)capi_scatt_qgrid_as_array!=scatt_qgrid_capi) {
        Py_XDECREF(capi_scatt_qgrid_as_array); }
    }  /* if (capi_scatt_qgrid_as_array == NULL) ... else of scatt_qgrid */
    /* End of cleaning variable scatt_qgrid */
    if((PyObject *)capi_qgrid_as_array!=qgrid_capi) {
        Py_XDECREF(capi_qgrid_as_array); }
    }  /* if (capi_qgrid_as_array == NULL) ... else of qgrid */
    /* End of cleaning variable qgrid */
    if((PyObject *)capi_irrqgrid_as_array!=irrqgrid_capi) {
        Py_XDECREF(capi_irrqgrid_as_array); }
    }  /* if (capi_irrqgrid_as_array == NULL) ... else of irrqgrid */
    /* End of cleaning variable irrqgrid */
    if((PyObject *)capi_rotations_as_array!=rotations_capi) {
        Py_XDECREF(capi_rotations_as_array); }
    }  /* if (capi_rotations_as_array == NULL) ... else of rotations */
    /* End of cleaning variable rotations */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************ end of get_scattering_q_grid ************************/

/******************************** same_vector ********************************/
static char doc_f2py_rout_thermal_conductivity_scattering_grids_same_vector[] = "\
same_vector = same_vector(v1,v2)\n\nWrapper for ``same_vector``.\
\n\nParameters\n----------\n"
"v1 : input rank-1 array('d') with bounds (3)\n"
"v2 : input rank-1 array('d') with bounds (3)\n"
"\nReturns\n-------\n"
"same_vector : int";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_scattering_grids_same_vector(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int same_vectorf2pywrap = 0;
    double *v1 = NULL;
    npy_intp v1_Dims[1] = {-1};
    const int v1_Rank = 1;
    PyArrayObject *capi_v1_as_array = NULL;
    int capi_v1_intent = 0;
    PyObject *v1_capi = Py_None;
    double *v2 = NULL;
    npy_intp v2_Dims[1] = {-1};
    const int v2_Rank = 1;
    PyArrayObject *capi_v2_as_array = NULL;
    int capi_v2_intent = 0;
    PyObject *v2_capi = Py_None;
    static char *capi_kwlist[] = {"v1","v2",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:thermal_conductivity.scattering_grids.same_vector",\
        capi_kwlist,&v1_capi,&v2_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable v1 */
    v1_Dims[0]=3;
    capi_v1_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.scattering_grids.same_vector: failed to create array from the 1st argument `v1`";
    capi_v1_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,v1_Dims,v1_Rank,  capi_v1_intent,v1_capi,capi_errmess);
    if (capi_v1_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v1 = (double *)(PyArray_DATA(capi_v1_as_array));

    /* Processing variable v2 */
    v2_Dims[0]=3;
    capi_v2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.scattering_grids.same_vector: failed to create array from the 2nd argument `v2`";
    capi_v2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,v2_Dims,v2_Rank,  capi_v2_intent,v2_capi,capi_errmess);
    if (capi_v2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v2 = (double *)(PyArray_DATA(capi_v2_as_array));

    /* Processing variable same_vectorf2pywrap */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(&same_vectorf2pywrap,v1,v2);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("i",same_vectorf2pywrap);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable same_vectorf2pywrap */
    if((PyObject *)capi_v2_as_array!=v2_capi) {
        Py_XDECREF(capi_v2_as_array); }
    }  /* if (capi_v2_as_array == NULL) ... else of v2 */
    /* End of cleaning variable v2 */
    if((PyObject *)capi_v1_as_array!=v1_capi) {
        Py_XDECREF(capi_v1_as_array); }
    }  /* if (capi_v1_as_array == NULL) ... else of v1 */
    /* End of cleaning variable v1 */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of same_vector *****************************/

/***************************** same_vector_nopbc *****************************/
static char doc_f2py_rout_thermal_conductivity_scattering_grids_same_vector_nopbc[] = "\
same_vector_nopbc = same_vector_nopbc(v1,v2)\n\nWrapper for ``same_vector_nopbc``.\
\n\nParameters\n----------\n"
"v1 : input rank-1 array('d') with bounds (3)\n"
"v2 : input rank-1 array('d') with bounds (3)\n"
"\nReturns\n-------\n"
"same_vector_nopbc : int";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_scattering_grids_same_vector_nopbc(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int same_vector_nopbcf2pywrap = 0;
    double *v1 = NULL;
    npy_intp v1_Dims[1] = {-1};
    const int v1_Rank = 1;
    PyArrayObject *capi_v1_as_array = NULL;
    int capi_v1_intent = 0;
    PyObject *v1_capi = Py_None;
    double *v2 = NULL;
    npy_intp v2_Dims[1] = {-1};
    const int v2_Rank = 1;
    PyArrayObject *capi_v2_as_array = NULL;
    int capi_v2_intent = 0;
    PyObject *v2_capi = Py_None;
    static char *capi_kwlist[] = {"v1","v2",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:thermal_conductivity.scattering_grids.same_vector_nopbc",\
        capi_kwlist,&v1_capi,&v2_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable v1 */
    v1_Dims[0]=3;
    capi_v1_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.scattering_grids.same_vector_nopbc: failed to create array from the 1st argument `v1`";
    capi_v1_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,v1_Dims,v1_Rank,  capi_v1_intent,v1_capi,capi_errmess);
    if (capi_v1_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v1 = (double *)(PyArray_DATA(capi_v1_as_array));

    /* Processing variable v2 */
    v2_Dims[0]=3;
    capi_v2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.scattering_grids.same_vector_nopbc: failed to create array from the 2nd argument `v2`";
    capi_v2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,v2_Dims,v2_Rank,  capi_v2_intent,v2_capi,capi_errmess);
    if (capi_v2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v2 = (double *)(PyArray_DATA(capi_v2_as_array));

    /* Processing variable same_vector_nopbcf2pywrap */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(&same_vector_nopbcf2pywrap,v1,v2);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("i",same_vector_nopbcf2pywrap);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable same_vector_nopbcf2pywrap */
    if((PyObject *)capi_v2_as_array!=v2_capi) {
        Py_XDECREF(capi_v2_as_array); }
    }  /* if (capi_v2_as_array == NULL) ... else of v2 */
    /* End of cleaning variable v2 */
    if((PyObject *)capi_v1_as_array!=v1_capi) {
        Py_XDECREF(capi_v1_as_array); }
    }  /* if (capi_v1_as_array == NULL) ... else of v1 */
    /* End of cleaning variable v1 */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************** end of same_vector_nopbc **************************/

/********************************** analysis **********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_analysis[] = "\
weight,xr2,xr3 = analysis(far,tol,dmax,sc_size,xr2_list,xr3_list,alat,tau,tensor,[nat,n_blocks])\n\nWrapper for ``analysis``.\
\n\nParameters\n----------\n"
"far : input int\n"
"tol : input float\n"
"dmax : input rank-1 array('d') with bounds (nat)\n"
"sc_size : input rank-1 array('i') with bounds (3)\n"
"xr2_list : input rank-2 array('i') with bounds (3,n_blocks)\n"
"xr3_list : input rank-2 array('i') with bounds (3,n_blocks)\n"
"alat : input rank-2 array('d') with bounds (3,3)\n"
"tau : input rank-2 array('d') with bounds (nat,3)\n"
"tensor : input rank-4 array('d') with bounds (3 * nat,3 * nat,3 * nat,n_blocks)\n"
"\nOther Parameters\n----------------\n"
"nat : input int, optional\n    Default: shape(dmax, 0)\n"
"n_blocks : input int, optional\n    Default: shape(xr2_list, 1)\n"
"\nReturns\n-------\n"
"weight : rank-4 array('i') with bounds (nat,nat,nat,n_blocks)\n"
"xr2 : rank-6 array('i') with bounds (3,1 + 6 * far + 12 * far * far + 8 * far * far * far,nat,nat,nat,n_blocks)\n"
"xr3 : rank-6 array('i') with bounds (3,1 + 6 * far + 12 * far * far + 8 * far * far * far,nat,nat,nat,n_blocks)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_analysis(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,double*,double*,int*,int*,int*,double*,double*,double*,int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int far = 0;
    PyObject *far_capi = Py_None;
    double tol = 0;
    PyObject *tol_capi = Py_None;
    double *dmax = NULL;
    npy_intp dmax_Dims[1] = {-1};
    const int dmax_Rank = 1;
    PyArrayObject *capi_dmax_as_array = NULL;
    int capi_dmax_intent = 0;
    PyObject *dmax_capi = Py_None;
    int *sc_size = NULL;
    npy_intp sc_size_Dims[1] = {-1};
    const int sc_size_Rank = 1;
    PyArrayObject *capi_sc_size_as_array = NULL;
    int capi_sc_size_intent = 0;
    PyObject *sc_size_capi = Py_None;
    int *xr2_list = NULL;
    npy_intp xr2_list_Dims[2] = {-1, -1};
    const int xr2_list_Rank = 2;
    PyArrayObject *capi_xr2_list_as_array = NULL;
    int capi_xr2_list_intent = 0;
    PyObject *xr2_list_capi = Py_None;
    int *xr3_list = NULL;
    npy_intp xr3_list_Dims[2] = {-1, -1};
    const int xr3_list_Rank = 2;
    PyArrayObject *capi_xr3_list_as_array = NULL;
    int capi_xr3_list_intent = 0;
    PyObject *xr3_list_capi = Py_None;
    double *alat = NULL;
    npy_intp alat_Dims[2] = {-1, -1};
    const int alat_Rank = 2;
    PyArrayObject *capi_alat_as_array = NULL;
    int capi_alat_intent = 0;
    PyObject *alat_capi = Py_None;
    double *tau = NULL;
    npy_intp tau_Dims[2] = {-1, -1};
    const int tau_Rank = 2;
    PyArrayObject *capi_tau_as_array = NULL;
    int capi_tau_intent = 0;
    PyObject *tau_capi = Py_None;
    double *tensor = NULL;
    npy_intp tensor_Dims[4] = {-1, -1, -1, -1};
    const int tensor_Rank = 4;
    PyArrayObject *capi_tensor_as_array = NULL;
    int capi_tensor_intent = 0;
    PyObject *tensor_capi = Py_None;
    int *weight = NULL;
    npy_intp weight_Dims[4] = {-1, -1, -1, -1};
    const int weight_Rank = 4;
    PyArrayObject *capi_weight_as_array = NULL;
    int capi_weight_intent = 0;
    int *xr2 = NULL;
    npy_intp xr2_Dims[6] = {-1, -1, -1, -1, -1, -1};
    const int xr2_Rank = 6;
    PyArrayObject *capi_xr2_as_array = NULL;
    int capi_xr2_intent = 0;
    int *xr3 = NULL;
    npy_intp xr3_Dims[6] = {-1, -1, -1, -1, -1, -1};
    const int xr3_Rank = 6;
    PyArrayObject *capi_xr3_as_array = NULL;
    int capi_xr3_intent = 0;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int n_blocks = 0;
    PyObject *n_blocks_capi = Py_None;
    static char *capi_kwlist[] = {"far","tol","dmax","sc_size","xr2_list","xr3_list","alat","tau","tensor","nat","n_blocks",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOOO|OO:thermal_conductivity.third_order_centering.analysis",\
        capi_kwlist,&far_capi,&tol_capi,&dmax_capi,&sc_size_capi,&xr2_list_capi,&xr3_list_capi,&alat_capi,&tau_capi,&tensor_capi,&nat_capi,&n_blocks_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable far */
        f2py_success = int_from_pyobj(&far,far_capi,"thermal_conductivity.third_order_centering.analysis() 1st argument (far) can't be converted to int");
    if (f2py_success) {
    /* Processing variable dmax */
    ;
    capi_dmax_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.analysis: failed to create array from the 3rd argument `dmax`";
    capi_dmax_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,dmax_Dims,dmax_Rank,  capi_dmax_intent,dmax_capi,capi_errmess);
    if (capi_dmax_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        dmax = (double *)(PyArray_DATA(capi_dmax_as_array));

    /* Processing variable alat */
    alat_Dims[0]=3,alat_Dims[1]=3;
    capi_alat_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.analysis: failed to create array from the 7th argument `alat`";
    capi_alat_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,alat_Dims,alat_Rank,  capi_alat_intent,alat_capi,capi_errmess);
    if (capi_alat_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        alat = (double *)(PyArray_DATA(capi_alat_as_array));

    /* Processing variable xr2_list */
    xr2_list_Dims[0]=3;
    capi_xr2_list_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.analysis: failed to create array from the 5th argument `xr2_list`";
    capi_xr2_list_as_array = ndarray_from_pyobj(  NPY_INT,1,xr2_list_Dims,xr2_list_Rank,  capi_xr2_list_intent,xr2_list_capi,capi_errmess);
    if (capi_xr2_list_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr2_list = (int *)(PyArray_DATA(capi_xr2_list_as_array));

    /* Processing variable tol */
        f2py_success = double_from_pyobj(&tol,tol_capi,"thermal_conductivity.third_order_centering.analysis() 2nd argument (tol) can't be converted to double");
    if (f2py_success) {
    /* Processing variable sc_size */
    sc_size_Dims[0]=3;
    capi_sc_size_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.analysis: failed to create array from the 4th argument `sc_size`";
    capi_sc_size_as_array = ndarray_from_pyobj(  NPY_INT,1,sc_size_Dims,sc_size_Rank,  capi_sc_size_intent,sc_size_capi,capi_errmess);
    if (capi_sc_size_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        sc_size = (int *)(PyArray_DATA(capi_sc_size_as_array));

    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(dmax, 0); else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.third_order_centering.analysis() 1st keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(dmax, 0) == nat,"shape(dmax, 0) == nat","1st keyword nat","analysis:nat=%d",nat) {
    /* Processing variable tau */
    tau_Dims[0]=nat,tau_Dims[1]=3;
    capi_tau_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.analysis: failed to create array from the 8th argument `tau`";
    capi_tau_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,tau_Dims,tau_Rank,  capi_tau_intent,tau_capi,capi_errmess);
    if (capi_tau_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        tau = (double *)(PyArray_DATA(capi_tau_as_array));

    /* Processing variable n_blocks */
    if (n_blocks_capi == Py_None) n_blocks = shape(xr2_list, 1); else
        f2py_success = int_from_pyobj(&n_blocks,n_blocks_capi,"thermal_conductivity.third_order_centering.analysis() 2nd keyword (n_blocks) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(xr2_list, 1) == n_blocks,"shape(xr2_list, 1) == n_blocks","2nd keyword n_blocks","analysis:n_blocks=%d",n_blocks) {
    /* Processing variable weight */
    weight_Dims[0]=nat,weight_Dims[1]=nat,weight_Dims[2]=nat,weight_Dims[3]=n_blocks;
    capi_weight_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.analysis: failed to create array from the hidden `weight`";
    capi_weight_as_array = ndarray_from_pyobj(  NPY_INT,1,weight_Dims,weight_Rank,  capi_weight_intent,Py_None,capi_errmess);
    if (capi_weight_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        weight = (int *)(PyArray_DATA(capi_weight_as_array));

    /* Processing variable xr2 */
    xr2_Dims[0]=3,xr2_Dims[1]=1 + 6 * far + 12 * far * far + 8 * far * far * far,xr2_Dims[2]=nat,xr2_Dims[3]=nat,xr2_Dims[4]=nat,xr2_Dims[5]=n_blocks;
    capi_xr2_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.analysis: failed to create array from the hidden `xr2`";
    capi_xr2_as_array = ndarray_from_pyobj(  NPY_INT,1,xr2_Dims,xr2_Rank,  capi_xr2_intent,Py_None,capi_errmess);
    if (capi_xr2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr2 = (int *)(PyArray_DATA(capi_xr2_as_array));

    /* Processing variable xr3 */
    xr3_Dims[0]=3,xr3_Dims[1]=1 + 6 * far + 12 * far * far + 8 * far * far * far,xr3_Dims[2]=nat,xr3_Dims[3]=nat,xr3_Dims[4]=nat,xr3_Dims[5]=n_blocks;
    capi_xr3_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.analysis: failed to create array from the hidden `xr3`";
    capi_xr3_as_array = ndarray_from_pyobj(  NPY_INT,1,xr3_Dims,xr3_Rank,  capi_xr3_intent,Py_None,capi_errmess);
    if (capi_xr3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr3 = (int *)(PyArray_DATA(capi_xr3_as_array));

    /* Processing variable xr3_list */
    xr3_list_Dims[0]=3,xr3_list_Dims[1]=n_blocks;
    capi_xr3_list_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.analysis: failed to create array from the 6th argument `xr3_list`";
    capi_xr3_list_as_array = ndarray_from_pyobj(  NPY_INT,1,xr3_list_Dims,xr3_list_Rank,  capi_xr3_list_intent,xr3_list_capi,capi_errmess);
    if (capi_xr3_list_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr3_list = (int *)(PyArray_DATA(capi_xr3_list_as_array));

    /* Processing variable tensor */
    tensor_Dims[0]=3 * nat,tensor_Dims[1]=3 * nat,tensor_Dims[2]=3 * nat,tensor_Dims[3]=n_blocks;
    capi_tensor_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.analysis: failed to create array from the 9th argument `tensor`";
    capi_tensor_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,tensor_Dims,tensor_Rank,  capi_tensor_intent,tensor_capi,capi_errmess);
    if (capi_tensor_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        tensor = (double *)(PyArray_DATA(capi_tensor_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&far,&tol,dmax,sc_size,xr2_list,xr3_list,alat,tau,tensor,weight,xr2,xr3,&nat,&n_blocks);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NNN",capi_weight_as_array,capi_xr2_as_array,capi_xr3_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_tensor_as_array!=tensor_capi) {
        Py_XDECREF(capi_tensor_as_array); }
    }  /* if (capi_tensor_as_array == NULL) ... else of tensor */
    /* End of cleaning variable tensor */
    if((PyObject *)capi_xr3_list_as_array!=xr3_list_capi) {
        Py_XDECREF(capi_xr3_list_as_array); }
    }  /* if (capi_xr3_list_as_array == NULL) ... else of xr3_list */
    /* End of cleaning variable xr3_list */
    }  /* if (capi_xr3_as_array == NULL) ... else of xr3 */
    /* End of cleaning variable xr3 */
    }  /* if (capi_xr2_as_array == NULL) ... else of xr2 */
    /* End of cleaning variable xr2 */
    }  /* if (capi_weight_as_array == NULL) ... else of weight */
    /* End of cleaning variable weight */
    } /*CHECKSCALAR(shape(xr2_list, 1) == n_blocks)*/
    } /*if (f2py_success) of n_blocks*/
    /* End of cleaning variable n_blocks */
    if((PyObject *)capi_tau_as_array!=tau_capi) {
        Py_XDECREF(capi_tau_as_array); }
    }  /* if (capi_tau_as_array == NULL) ... else of tau */
    /* End of cleaning variable tau */
    } /*CHECKSCALAR(shape(dmax, 0) == nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    if((PyObject *)capi_sc_size_as_array!=sc_size_capi) {
        Py_XDECREF(capi_sc_size_as_array); }
    }  /* if (capi_sc_size_as_array == NULL) ... else of sc_size */
    /* End of cleaning variable sc_size */
    } /*if (f2py_success) of tol*/
    /* End of cleaning variable tol */
    if((PyObject *)capi_xr2_list_as_array!=xr2_list_capi) {
        Py_XDECREF(capi_xr2_list_as_array); }
    }  /* if (capi_xr2_list_as_array == NULL) ... else of xr2_list */
    /* End of cleaning variable xr2_list */
    if((PyObject *)capi_alat_as_array!=alat_capi) {
        Py_XDECREF(capi_alat_as_array); }
    }  /* if (capi_alat_as_array == NULL) ... else of alat */
    /* End of cleaning variable alat */
    if((PyObject *)capi_dmax_as_array!=dmax_capi) {
        Py_XDECREF(capi_dmax_as_array); }
    }  /* if (capi_dmax_as_array == NULL) ... else of dmax */
    /* End of cleaning variable dmax */
    } /*if (f2py_success) of far*/
    /* End of cleaning variable far */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/****************************** end of analysis ******************************/

/*********************************** center ***********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_center[] = "\
centered = center(original,weight,xr2_list,xr2,xr3_list,xr3,far,[nat,n_blocks,n_blocks_old])\n\nWrapper for ``center``.\
\n\nParameters\n----------\n"
"original : input rank-4 array('d') with bounds (3 * nat,3 * nat,3 * nat,n_blocks_old)\n"
"weight : input rank-4 array('i') with bounds (nat,nat,nat,n_blocks_old)\n"
"xr2_list : input rank-2 array('i') with bounds (3,n_blocks)\n"
"xr2 : input rank-6 array('i') with bounds (3,1 + 6 * far + 12 * far * far + 8 * far * far * far,nat,nat,nat,n_blocks_old)\n"
"xr3_list : input rank-2 array('i') with bounds (3,n_blocks)\n"
"xr3 : input rank-6 array('i') with bounds (3,1 + 6 * far + 12 * far * far + 8 * far * far * far,nat,nat,nat,n_blocks_old)\n"
"far : input int\n"
"\nOther Parameters\n----------------\n"
"nat : input int, optional\n    Default: shape(original, 0) / 3\n"
"n_blocks : input int, optional\n    Default: shape(xr2_list, 1)\n"
"n_blocks_old : input int, optional\n    Default: shape(original, 3)\n"
"\nReturns\n-------\n"
"centered : rank-4 array('d') with bounds (3 * nat,3 * nat,3 * nat,n_blocks)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_center(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,int*,int*,int*,int*,int*,int*,double*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *original = NULL;
    npy_intp original_Dims[4] = {-1, -1, -1, -1};
    const int original_Rank = 4;
    PyArrayObject *capi_original_as_array = NULL;
    int capi_original_intent = 0;
    PyObject *original_capi = Py_None;
    int *weight = NULL;
    npy_intp weight_Dims[4] = {-1, -1, -1, -1};
    const int weight_Rank = 4;
    PyArrayObject *capi_weight_as_array = NULL;
    int capi_weight_intent = 0;
    PyObject *weight_capi = Py_None;
    int *xr2_list = NULL;
    npy_intp xr2_list_Dims[2] = {-1, -1};
    const int xr2_list_Rank = 2;
    PyArrayObject *capi_xr2_list_as_array = NULL;
    int capi_xr2_list_intent = 0;
    PyObject *xr2_list_capi = Py_None;
    int *xr2 = NULL;
    npy_intp xr2_Dims[6] = {-1, -1, -1, -1, -1, -1};
    const int xr2_Rank = 6;
    PyArrayObject *capi_xr2_as_array = NULL;
    int capi_xr2_intent = 0;
    PyObject *xr2_capi = Py_None;
    int *xr3_list = NULL;
    npy_intp xr3_list_Dims[2] = {-1, -1};
    const int xr3_list_Rank = 2;
    PyArrayObject *capi_xr3_list_as_array = NULL;
    int capi_xr3_list_intent = 0;
    PyObject *xr3_list_capi = Py_None;
    int *xr3 = NULL;
    npy_intp xr3_Dims[6] = {-1, -1, -1, -1, -1, -1};
    const int xr3_Rank = 6;
    PyArrayObject *capi_xr3_as_array = NULL;
    int capi_xr3_intent = 0;
    PyObject *xr3_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    double *centered = NULL;
    npy_intp centered_Dims[4] = {-1, -1, -1, -1};
    const int centered_Rank = 4;
    PyArrayObject *capi_centered_as_array = NULL;
    int capi_centered_intent = 0;
    int far = 0;
    PyObject *far_capi = Py_None;
    int n_blocks = 0;
    PyObject *n_blocks_capi = Py_None;
    int n_blocks_old = 0;
    PyObject *n_blocks_old_capi = Py_None;
    static char *capi_kwlist[] = {"original","weight","xr2_list","xr2","xr3_list","xr3","far","nat","n_blocks","n_blocks_old",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOO|OOO:thermal_conductivity.third_order_centering.center",\
        capi_kwlist,&original_capi,&weight_capi,&xr2_list_capi,&xr2_capi,&xr3_list_capi,&xr3_capi,&far_capi,&nat_capi,&n_blocks_capi,&n_blocks_old_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable far */
        f2py_success = int_from_pyobj(&far,far_capi,"thermal_conductivity.third_order_centering.center() 7th argument (far) can't be converted to int");
    if (f2py_success) {
    /* Processing variable xr2_list */
    xr2_list_Dims[0]=3;
    capi_xr2_list_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center: failed to create array from the 3rd argument `xr2_list`";
    capi_xr2_list_as_array = ndarray_from_pyobj(  NPY_INT,1,xr2_list_Dims,xr2_list_Rank,  capi_xr2_list_intent,xr2_list_capi,capi_errmess);
    if (capi_xr2_list_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr2_list = (int *)(PyArray_DATA(capi_xr2_list_as_array));

    /* Processing variable original */
    ;
    capi_original_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center: failed to create array from the 1st argument `original`";
    capi_original_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,original_Dims,original_Rank,  capi_original_intent,original_capi,capi_errmess);
    if (capi_original_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        original = (double *)(PyArray_DATA(capi_original_as_array));

    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(original, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.third_order_centering.center() 1st keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(original, 0) == 3 * nat,"shape(original, 0) == 3 * nat","1st keyword nat","center:nat=%d",nat) {
    /* Processing variable n_blocks */
    if (n_blocks_capi == Py_None) n_blocks = shape(xr2_list, 1); else
        f2py_success = int_from_pyobj(&n_blocks,n_blocks_capi,"thermal_conductivity.third_order_centering.center() 2nd keyword (n_blocks) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(xr2_list, 1) == n_blocks,"shape(xr2_list, 1) == n_blocks","2nd keyword n_blocks","center:n_blocks=%d",n_blocks) {
    /* Processing variable xr3_list */
    xr3_list_Dims[0]=3,xr3_list_Dims[1]=n_blocks;
    capi_xr3_list_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center: failed to create array from the 5th argument `xr3_list`";
    capi_xr3_list_as_array = ndarray_from_pyobj(  NPY_INT,1,xr3_list_Dims,xr3_list_Rank,  capi_xr3_list_intent,xr3_list_capi,capi_errmess);
    if (capi_xr3_list_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr3_list = (int *)(PyArray_DATA(capi_xr3_list_as_array));

    /* Processing variable n_blocks_old */
    if (n_blocks_old_capi == Py_None) n_blocks_old = shape(original, 3); else
        f2py_success = int_from_pyobj(&n_blocks_old,n_blocks_old_capi,"thermal_conductivity.third_order_centering.center() 3rd keyword (n_blocks_old) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(original, 3) == n_blocks_old,"shape(original, 3) == n_blocks_old","3rd keyword n_blocks_old","center:n_blocks_old=%d",n_blocks_old) {
    /* Processing variable centered */
    centered_Dims[0]=3 * nat,centered_Dims[1]=3 * nat,centered_Dims[2]=3 * nat,centered_Dims[3]=n_blocks;
    capi_centered_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center: failed to create array from the hidden `centered`";
    capi_centered_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,centered_Dims,centered_Rank,  capi_centered_intent,Py_None,capi_errmess);
    if (capi_centered_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        centered = (double *)(PyArray_DATA(capi_centered_as_array));

    /* Processing variable xr2 */
    xr2_Dims[0]=3,xr2_Dims[1]=1 + 6 * far + 12 * far * far + 8 * far * far * far,xr2_Dims[2]=nat,xr2_Dims[3]=nat,xr2_Dims[4]=nat,xr2_Dims[5]=n_blocks_old;
    capi_xr2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center: failed to create array from the 4th argument `xr2`";
    capi_xr2_as_array = ndarray_from_pyobj(  NPY_INT,1,xr2_Dims,xr2_Rank,  capi_xr2_intent,xr2_capi,capi_errmess);
    if (capi_xr2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr2 = (int *)(PyArray_DATA(capi_xr2_as_array));

    CHECKARRAY(shape(xr2, 1) == 1 + 6 * far + 12 * far * far + 8 * far * far * far,"shape(xr2, 1) == 1 + 6 * far + 12 * far * far + 8 * far * far * far","4th argument xr2") {
    /* Processing variable xr3 */
    xr3_Dims[0]=3,xr3_Dims[1]=1 + 6 * far + 12 * far * far + 8 * far * far * far,xr3_Dims[2]=nat,xr3_Dims[3]=nat,xr3_Dims[4]=nat,xr3_Dims[5]=n_blocks_old;
    capi_xr3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center: failed to create array from the 6th argument `xr3`";
    capi_xr3_as_array = ndarray_from_pyobj(  NPY_INT,1,xr3_Dims,xr3_Rank,  capi_xr3_intent,xr3_capi,capi_errmess);
    if (capi_xr3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr3 = (int *)(PyArray_DATA(capi_xr3_as_array));

    CHECKARRAY(shape(xr3, 1) == 1 + 6 * far + 12 * far * far + 8 * far * far * far,"shape(xr3, 1) == 1 + 6 * far + 12 * far * far + 8 * far * far * far","6th argument xr3") {
    /* Processing variable weight */
    weight_Dims[0]=nat,weight_Dims[1]=nat,weight_Dims[2]=nat,weight_Dims[3]=n_blocks_old;
    capi_weight_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center: failed to create array from the 2nd argument `weight`";
    capi_weight_as_array = ndarray_from_pyobj(  NPY_INT,1,weight_Dims,weight_Rank,  capi_weight_intent,weight_capi,capi_errmess);
    if (capi_weight_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        weight = (int *)(PyArray_DATA(capi_weight_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(original,weight,xr2_list,xr2,xr3_list,xr3,&nat,centered,&far,&n_blocks,&n_blocks_old);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_centered_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_weight_as_array!=weight_capi) {
        Py_XDECREF(capi_weight_as_array); }
    }  /* if (capi_weight_as_array == NULL) ... else of weight */
    /* End of cleaning variable weight */
    } /*CHECKARRAY(shape(xr3, 1) == 1 + 6 * far + 12 * far * far + 8 * far * far * far)*/
    if((PyObject *)capi_xr3_as_array!=xr3_capi) {
        Py_XDECREF(capi_xr3_as_array); }
    }  /* if (capi_xr3_as_array == NULL) ... else of xr3 */
    /* End of cleaning variable xr3 */
    } /*CHECKARRAY(shape(xr2, 1) == 1 + 6 * far + 12 * far * far + 8 * far * far * far)*/
    if((PyObject *)capi_xr2_as_array!=xr2_capi) {
        Py_XDECREF(capi_xr2_as_array); }
    }  /* if (capi_xr2_as_array == NULL) ... else of xr2 */
    /* End of cleaning variable xr2 */
    }  /* if (capi_centered_as_array == NULL) ... else of centered */
    /* End of cleaning variable centered */
    } /*CHECKSCALAR(shape(original, 3) == n_blocks_old)*/
    } /*if (f2py_success) of n_blocks_old*/
    /* End of cleaning variable n_blocks_old */
    if((PyObject *)capi_xr3_list_as_array!=xr3_list_capi) {
        Py_XDECREF(capi_xr3_list_as_array); }
    }  /* if (capi_xr3_list_as_array == NULL) ... else of xr3_list */
    /* End of cleaning variable xr3_list */
    } /*CHECKSCALAR(shape(xr2_list, 1) == n_blocks)*/
    } /*if (f2py_success) of n_blocks*/
    /* End of cleaning variable n_blocks */
    } /*CHECKSCALAR(shape(original, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    if((PyObject *)capi_original_as_array!=original_capi) {
        Py_XDECREF(capi_original_as_array); }
    }  /* if (capi_original_as_array == NULL) ... else of original */
    /* End of cleaning variable original */
    if((PyObject *)capi_xr2_list_as_array!=xr2_list_capi) {
        Py_XDECREF(capi_xr2_list_as_array); }
    }  /* if (capi_xr2_list_as_array == NULL) ... else of xr2_list */
    /* End of cleaning variable xr2_list */
    } /*if (f2py_success) of far*/
    /* End of cleaning variable far */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************* end of center *******************************/

/******************************* center_sparse *******************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_center_sparse[] = "\
centered,n_sparse_blocks,xr2_sparse_list,xr3_sparse_list,atom_sparse_list,r_blocks_sparse_list = center_sparse(original,weight,xr2_list,xr2,xr3_list,xr3,far,[nat,n_sup,n_blocks])\n\nWrapper for ``center_sparse``.\
\n\nParameters\n----------\n"
"original : input rank-5 array('d') with bounds (3 * nat,3 * nat,3 * nat,n_sup,n_sup)\n"
"weight : input rank-5 array('i') with bounds (nat,nat,n_sup,nat,n_sup)\n"
"xr2_list : input rank-2 array('i') with bounds (3,n_blocks)\n"
"xr2 : input rank-7 array('i') with bounds (3,n_sup + 6 * far * n_sup + 12 * far * far * n_sup + 8 * far * far * far * n_sup,nat,nat,n_sup,nat,n_sup)\n"
"xr3_list : input rank-2 array('i') with bounds (3,n_blocks)\n"
"xr3 : input rank-7 array('i') with bounds (3,n_sup + 6 * far * n_sup + 12 * far * far * n_sup + 8 * far * far * far * n_sup,nat,nat,n_sup,nat,n_sup)\n"
"far : input int\n"
"\nOther Parameters\n----------------\n"
"nat : input int, optional\n    Default: shape(original, 0) / 3\n"
"n_sup : input int, optional\n    Default: shape(original, 3)\n"
"n_blocks : input int, optional\n    Default: shape(xr2_list, 1)\n"
"\nReturns\n-------\n"
"centered : rank-4 array('d') with bounds (3 * nat,3 * nat,3 * nat,n_blocks)\n"
"n_sparse_blocks : int\n"
"xr2_sparse_list : rank-2 array('i') with bounds (3,n_blocks * nat * nat * nat)\n"
"xr3_sparse_list : rank-2 array('i') with bounds (3,n_blocks * nat * nat * nat)\n"
"atom_sparse_list : rank-2 array('i') with bounds (3,n_blocks * nat * nat * nat)\n"
"r_blocks_sparse_list : rank-1 array('i') with bounds (n_blocks * nat * nat * nat)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_center_sparse(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,int*,int*,int*,int*,int*,double*,int*,int*,int*,int*,int*,int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *original = NULL;
    npy_intp original_Dims[5] = {-1, -1, -1, -1, -1};
    const int original_Rank = 5;
    PyArrayObject *capi_original_as_array = NULL;
    int capi_original_intent = 0;
    PyObject *original_capi = Py_None;
    int *weight = NULL;
    npy_intp weight_Dims[5] = {-1, -1, -1, -1, -1};
    const int weight_Rank = 5;
    PyArrayObject *capi_weight_as_array = NULL;
    int capi_weight_intent = 0;
    PyObject *weight_capi = Py_None;
    int *xr2_list = NULL;
    npy_intp xr2_list_Dims[2] = {-1, -1};
    const int xr2_list_Rank = 2;
    PyArrayObject *capi_xr2_list_as_array = NULL;
    int capi_xr2_list_intent = 0;
    PyObject *xr2_list_capi = Py_None;
    int *xr2 = NULL;
    npy_intp xr2_Dims[7] = {-1, -1, -1, -1, -1, -1, -1};
    const int xr2_Rank = 7;
    PyArrayObject *capi_xr2_as_array = NULL;
    int capi_xr2_intent = 0;
    PyObject *xr2_capi = Py_None;
    int *xr3_list = NULL;
    npy_intp xr3_list_Dims[2] = {-1, -1};
    const int xr3_list_Rank = 2;
    PyArrayObject *capi_xr3_list_as_array = NULL;
    int capi_xr3_list_intent = 0;
    PyObject *xr3_list_capi = Py_None;
    int *xr3 = NULL;
    npy_intp xr3_Dims[7] = {-1, -1, -1, -1, -1, -1, -1};
    const int xr3_Rank = 7;
    PyArrayObject *capi_xr3_as_array = NULL;
    int capi_xr3_intent = 0;
    PyObject *xr3_capi = Py_None;
    double *centered = NULL;
    npy_intp centered_Dims[4] = {-1, -1, -1, -1};
    const int centered_Rank = 4;
    PyArrayObject *capi_centered_as_array = NULL;
    int capi_centered_intent = 0;
    int n_sparse_blocks = 0;
    int *xr2_sparse_list = NULL;
    npy_intp xr2_sparse_list_Dims[2] = {-1, -1};
    const int xr2_sparse_list_Rank = 2;
    PyArrayObject *capi_xr2_sparse_list_as_array = NULL;
    int capi_xr2_sparse_list_intent = 0;
    int *xr3_sparse_list = NULL;
    npy_intp xr3_sparse_list_Dims[2] = {-1, -1};
    const int xr3_sparse_list_Rank = 2;
    PyArrayObject *capi_xr3_sparse_list_as_array = NULL;
    int capi_xr3_sparse_list_intent = 0;
    int *atom_sparse_list = NULL;
    npy_intp atom_sparse_list_Dims[2] = {-1, -1};
    const int atom_sparse_list_Rank = 2;
    PyArrayObject *capi_atom_sparse_list_as_array = NULL;
    int capi_atom_sparse_list_intent = 0;
    int *r_blocks_sparse_list = NULL;
    npy_intp r_blocks_sparse_list_Dims[1] = {-1};
    const int r_blocks_sparse_list_Rank = 1;
    PyArrayObject *capi_r_blocks_sparse_list_as_array = NULL;
    int capi_r_blocks_sparse_list_intent = 0;
    int far = 0;
    PyObject *far_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int n_sup = 0;
    PyObject *n_sup_capi = Py_None;
    int n_blocks = 0;
    PyObject *n_blocks_capi = Py_None;
    static char *capi_kwlist[] = {"original","weight","xr2_list","xr2","xr3_list","xr3","far","nat","n_sup","n_blocks",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOO|OOO:thermal_conductivity.third_order_centering.center_sparse",\
        capi_kwlist,&original_capi,&weight_capi,&xr2_list_capi,&xr2_capi,&xr3_list_capi,&xr3_capi,&far_capi,&nat_capi,&n_sup_capi,&n_blocks_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable far */
        f2py_success = int_from_pyobj(&far,far_capi,"thermal_conductivity.third_order_centering.center_sparse() 7th argument (far) can't be converted to int");
    if (f2py_success) {
    /* Processing variable xr2_list */
    xr2_list_Dims[0]=3;
    capi_xr2_list_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center_sparse: failed to create array from the 3rd argument `xr2_list`";
    capi_xr2_list_as_array = ndarray_from_pyobj(  NPY_INT,1,xr2_list_Dims,xr2_list_Rank,  capi_xr2_list_intent,xr2_list_capi,capi_errmess);
    if (capi_xr2_list_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr2_list = (int *)(PyArray_DATA(capi_xr2_list_as_array));

    /* Processing variable original */
    ;
    capi_original_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center_sparse: failed to create array from the 1st argument `original`";
    capi_original_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,original_Dims,original_Rank,  capi_original_intent,original_capi,capi_errmess);
    if (capi_original_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        original = (double *)(PyArray_DATA(capi_original_as_array));

    /* Processing variable n_sparse_blocks */
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(original, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.third_order_centering.center_sparse() 1st keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(original, 0) == 3 * nat,"shape(original, 0) == 3 * nat","1st keyword nat","center_sparse:nat=%d",nat) {
    /* Processing variable n_sup */
    if (n_sup_capi == Py_None) n_sup = shape(original, 3); else
        f2py_success = int_from_pyobj(&n_sup,n_sup_capi,"thermal_conductivity.third_order_centering.center_sparse() 2nd keyword (n_sup) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(original, 3) == n_sup,"shape(original, 3) == n_sup","2nd keyword n_sup","center_sparse:n_sup=%d",n_sup) {
    /* Processing variable n_blocks */
    if (n_blocks_capi == Py_None) n_blocks = shape(xr2_list, 1); else
        f2py_success = int_from_pyobj(&n_blocks,n_blocks_capi,"thermal_conductivity.third_order_centering.center_sparse() 3rd keyword (n_blocks) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(xr2_list, 1) == n_blocks,"shape(xr2_list, 1) == n_blocks","3rd keyword n_blocks","center_sparse:n_blocks=%d",n_blocks) {
    /* Processing variable xr3_list */
    xr3_list_Dims[0]=3,xr3_list_Dims[1]=n_blocks;
    capi_xr3_list_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center_sparse: failed to create array from the 5th argument `xr3_list`";
    capi_xr3_list_as_array = ndarray_from_pyobj(  NPY_INT,1,xr3_list_Dims,xr3_list_Rank,  capi_xr3_list_intent,xr3_list_capi,capi_errmess);
    if (capi_xr3_list_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr3_list = (int *)(PyArray_DATA(capi_xr3_list_as_array));

    /* Processing variable xr2 */
    xr2_Dims[0]=3,xr2_Dims[1]=n_sup + 6 * far * n_sup + 12 * far * far * n_sup + 8 * far * far * far * n_sup,xr2_Dims[2]=nat,xr2_Dims[3]=nat,xr2_Dims[4]=n_sup,xr2_Dims[5]=nat,xr2_Dims[6]=n_sup;
    capi_xr2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center_sparse: failed to create array from the 4th argument `xr2`";
    capi_xr2_as_array = ndarray_from_pyobj(  NPY_INT,1,xr2_Dims,xr2_Rank,  capi_xr2_intent,xr2_capi,capi_errmess);
    if (capi_xr2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr2 = (int *)(PyArray_DATA(capi_xr2_as_array));

    CHECKARRAY(shape(xr2, 1) == n_sup + 6 * far * n_sup + 12 * far * far * n_sup + 8 * far * far * far * n_sup,"shape(xr2, 1) == n_sup + 6 * far * n_sup + 12 * far * far * n_sup + 8 * far * far * far * n_sup","4th argument xr2") {
    /* Processing variable xr3 */
    xr3_Dims[0]=3,xr3_Dims[1]=n_sup + 6 * far * n_sup + 12 * far * far * n_sup + 8 * far * far * far * n_sup,xr3_Dims[2]=nat,xr3_Dims[3]=nat,xr3_Dims[4]=n_sup,xr3_Dims[5]=nat,xr3_Dims[6]=n_sup;
    capi_xr3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center_sparse: failed to create array from the 6th argument `xr3`";
    capi_xr3_as_array = ndarray_from_pyobj(  NPY_INT,1,xr3_Dims,xr3_Rank,  capi_xr3_intent,xr3_capi,capi_errmess);
    if (capi_xr3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr3 = (int *)(PyArray_DATA(capi_xr3_as_array));

    CHECKARRAY(shape(xr3, 1) == n_sup + 6 * far * n_sup + 12 * far * far * n_sup + 8 * far * far * far * n_sup,"shape(xr3, 1) == n_sup + 6 * far * n_sup + 12 * far * far * n_sup + 8 * far * far * far * n_sup","6th argument xr3") {
    /* Processing variable weight */
    weight_Dims[0]=nat,weight_Dims[1]=nat,weight_Dims[2]=n_sup,weight_Dims[3]=nat,weight_Dims[4]=n_sup;
    capi_weight_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center_sparse: failed to create array from the 2nd argument `weight`";
    capi_weight_as_array = ndarray_from_pyobj(  NPY_INT,1,weight_Dims,weight_Rank,  capi_weight_intent,weight_capi,capi_errmess);
    if (capi_weight_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        weight = (int *)(PyArray_DATA(capi_weight_as_array));

    /* Processing variable centered */
    centered_Dims[0]=3 * nat,centered_Dims[1]=3 * nat,centered_Dims[2]=3 * nat,centered_Dims[3]=n_blocks;
    capi_centered_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center_sparse: failed to create array from the hidden `centered`";
    capi_centered_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,centered_Dims,centered_Rank,  capi_centered_intent,Py_None,capi_errmess);
    if (capi_centered_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        centered = (double *)(PyArray_DATA(capi_centered_as_array));

    /* Processing variable xr2_sparse_list */
    xr2_sparse_list_Dims[0]=3,xr2_sparse_list_Dims[1]=n_blocks * nat * nat * nat;
    capi_xr2_sparse_list_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center_sparse: failed to create array from the hidden `xr2_sparse_list`";
    capi_xr2_sparse_list_as_array = ndarray_from_pyobj(  NPY_INT,1,xr2_sparse_list_Dims,xr2_sparse_list_Rank,  capi_xr2_sparse_list_intent,Py_None,capi_errmess);
    if (capi_xr2_sparse_list_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr2_sparse_list = (int *)(PyArray_DATA(capi_xr2_sparse_list_as_array));

    /* Processing variable xr3_sparse_list */
    xr3_sparse_list_Dims[0]=3,xr3_sparse_list_Dims[1]=n_blocks * nat * nat * nat;
    capi_xr3_sparse_list_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center_sparse: failed to create array from the hidden `xr3_sparse_list`";
    capi_xr3_sparse_list_as_array = ndarray_from_pyobj(  NPY_INT,1,xr3_sparse_list_Dims,xr3_sparse_list_Rank,  capi_xr3_sparse_list_intent,Py_None,capi_errmess);
    if (capi_xr3_sparse_list_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        xr3_sparse_list = (int *)(PyArray_DATA(capi_xr3_sparse_list_as_array));

    /* Processing variable atom_sparse_list */
    atom_sparse_list_Dims[0]=3,atom_sparse_list_Dims[1]=n_blocks * nat * nat * nat;
    capi_atom_sparse_list_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center_sparse: failed to create array from the hidden `atom_sparse_list`";
    capi_atom_sparse_list_as_array = ndarray_from_pyobj(  NPY_INT,1,atom_sparse_list_Dims,atom_sparse_list_Rank,  capi_atom_sparse_list_intent,Py_None,capi_errmess);
    if (capi_atom_sparse_list_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        atom_sparse_list = (int *)(PyArray_DATA(capi_atom_sparse_list_as_array));

    /* Processing variable r_blocks_sparse_list */
    r_blocks_sparse_list_Dims[0]=n_blocks * nat * nat * nat;
    capi_r_blocks_sparse_list_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.center_sparse: failed to create array from the hidden `r_blocks_sparse_list`";
    capi_r_blocks_sparse_list_as_array = ndarray_from_pyobj(  NPY_INT,1,r_blocks_sparse_list_Dims,r_blocks_sparse_list_Rank,  capi_r_blocks_sparse_list_intent,Py_None,capi_errmess);
    if (capi_r_blocks_sparse_list_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r_blocks_sparse_list = (int *)(PyArray_DATA(capi_r_blocks_sparse_list_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(original,weight,xr2_list,xr2,xr3_list,xr3,centered,&n_sparse_blocks,xr2_sparse_list,xr3_sparse_list,atom_sparse_list,r_blocks_sparse_list,&far,&nat,&n_sup,&n_blocks);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NiNNNN",capi_centered_as_array,n_sparse_blocks,capi_xr2_sparse_list_as_array,capi_xr3_sparse_list_as_array,capi_atom_sparse_list_as_array,capi_r_blocks_sparse_list_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_r_blocks_sparse_list_as_array == NULL) ... else of r_blocks_sparse_list */
    /* End of cleaning variable r_blocks_sparse_list */
    }  /* if (capi_atom_sparse_list_as_array == NULL) ... else of atom_sparse_list */
    /* End of cleaning variable atom_sparse_list */
    }  /* if (capi_xr3_sparse_list_as_array == NULL) ... else of xr3_sparse_list */
    /* End of cleaning variable xr3_sparse_list */
    }  /* if (capi_xr2_sparse_list_as_array == NULL) ... else of xr2_sparse_list */
    /* End of cleaning variable xr2_sparse_list */
    }  /* if (capi_centered_as_array == NULL) ... else of centered */
    /* End of cleaning variable centered */
    if((PyObject *)capi_weight_as_array!=weight_capi) {
        Py_XDECREF(capi_weight_as_array); }
    }  /* if (capi_weight_as_array == NULL) ... else of weight */
    /* End of cleaning variable weight */
    } /*CHECKARRAY(shape(xr3, 1) == n_sup + 6 * far * n_sup + 12 * far * far * n_sup + 8 * far * far * far * n_sup)*/
    if((PyObject *)capi_xr3_as_array!=xr3_capi) {
        Py_XDECREF(capi_xr3_as_array); }
    }  /* if (capi_xr3_as_array == NULL) ... else of xr3 */
    /* End of cleaning variable xr3 */
    } /*CHECKARRAY(shape(xr2, 1) == n_sup + 6 * far * n_sup + 12 * far * far * n_sup + 8 * far * far * far * n_sup)*/
    if((PyObject *)capi_xr2_as_array!=xr2_capi) {
        Py_XDECREF(capi_xr2_as_array); }
    }  /* if (capi_xr2_as_array == NULL) ... else of xr2 */
    /* End of cleaning variable xr2 */
    if((PyObject *)capi_xr3_list_as_array!=xr3_list_capi) {
        Py_XDECREF(capi_xr3_list_as_array); }
    }  /* if (capi_xr3_list_as_array == NULL) ... else of xr3_list */
    /* End of cleaning variable xr3_list */
    } /*CHECKSCALAR(shape(xr2_list, 1) == n_blocks)*/
    } /*if (f2py_success) of n_blocks*/
    /* End of cleaning variable n_blocks */
    } /*CHECKSCALAR(shape(original, 3) == n_sup)*/
    } /*if (f2py_success) of n_sup*/
    /* End of cleaning variable n_sup */
    } /*CHECKSCALAR(shape(original, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    /* End of cleaning variable n_sparse_blocks */
    if((PyObject *)capi_original_as_array!=original_capi) {
        Py_XDECREF(capi_original_as_array); }
    }  /* if (capi_original_as_array == NULL) ... else of original */
    /* End of cleaning variable original */
    if((PyObject *)capi_xr2_list_as_array!=xr2_list_capi) {
        Py_XDECREF(capi_xr2_list_as_array); }
    }  /* if (capi_xr2_list_as_array == NULL) ... else of xr2_list */
    /* End of cleaning variable xr2_list */
    } /*if (f2py_success) of far*/
    /* End of cleaning variable far */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************************** end of center_sparse ****************************/

/********************************* pre_center *********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_pre_center[] = "\
centered,lat_min,lat_max = pre_center(far,nq1,nq2,nq3,tol,alat,tau,original,[nat])\n\nWrapper for ``pre_center``.\
\n\nParameters\n----------\n"
"far : input int\n"
"nq1 : input int\n"
"nq2 : input int\n"
"nq3 : input int\n"
"tol : input float\n"
"alat : input rank-2 array('d') with bounds (3,3)\n"
"tau : input rank-2 array('d') with bounds (nat,3)\n"
"original : input rank-5 array('d') with bounds (3 * nat,3 * nat,3 * nat,nq1 * nq2 * nq3,nq1 * nq2 * nq3)\n"
"\nOther Parameters\n----------------\n"
"nat : input int, optional\n    Default: shape(tau, 0)\n"
"\nReturns\n-------\n"
"centered : rank-5 array('d') with bounds (3 * nat,3 * nat,3 * nat,6 * far * nq1 * nq2 * nq3 + 12 * far * far * nq1 * nq2 * nq3 + 8 * far * far * far * nq1 * nq2 * nq3 + nq1 * nq2 * nq3,6 * far * nq1 * nq2 * nq3 + 12 * far * far * nq1 * nq2 * nq3 + 8 * far * far * far * nq1 * nq2 * nq3 + nq1 * nq2 * nq3)\n"
"lat_min : rank-1 array('i') with bounds (3)\n"
"lat_max : rank-1 array('i') with bounds (3)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_pre_center(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*,int*,double*,double*,double*,double*,double*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int far = 0;
    PyObject *far_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int nq1 = 0;
    PyObject *nq1_capi = Py_None;
    int nq2 = 0;
    PyObject *nq2_capi = Py_None;
    int nq3 = 0;
    PyObject *nq3_capi = Py_None;
    double tol = 0;
    PyObject *tol_capi = Py_None;
    double *alat = NULL;
    npy_intp alat_Dims[2] = {-1, -1};
    const int alat_Rank = 2;
    PyArrayObject *capi_alat_as_array = NULL;
    int capi_alat_intent = 0;
    PyObject *alat_capi = Py_None;
    double *tau = NULL;
    npy_intp tau_Dims[2] = {-1, -1};
    const int tau_Rank = 2;
    PyArrayObject *capi_tau_as_array = NULL;
    int capi_tau_intent = 0;
    PyObject *tau_capi = Py_None;
    double *original = NULL;
    npy_intp original_Dims[5] = {-1, -1, -1, -1, -1};
    const int original_Rank = 5;
    PyArrayObject *capi_original_as_array = NULL;
    int capi_original_intent = 0;
    PyObject *original_capi = Py_None;
    double *centered = NULL;
    npy_intp centered_Dims[5] = {-1, -1, -1, -1, -1};
    const int centered_Rank = 5;
    PyArrayObject *capi_centered_as_array = NULL;
    int capi_centered_intent = 0;
    int *lat_min = NULL;
    npy_intp lat_min_Dims[1] = {-1};
    const int lat_min_Rank = 1;
    PyArrayObject *capi_lat_min_as_array = NULL;
    int capi_lat_min_intent = 0;
    int *lat_max = NULL;
    npy_intp lat_max_Dims[1] = {-1};
    const int lat_max_Rank = 1;
    PyArrayObject *capi_lat_max_as_array = NULL;
    int capi_lat_max_intent = 0;
    static char *capi_kwlist[] = {"far","nq1","nq2","nq3","tol","alat","tau","original","nat",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOO|O:thermal_conductivity.third_order_centering.pre_center",\
        capi_kwlist,&far_capi,&nq1_capi,&nq2_capi,&nq3_capi,&tol_capi,&alat_capi,&tau_capi,&original_capi,&nat_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable nq1 */
        f2py_success = int_from_pyobj(&nq1,nq1_capi,"thermal_conductivity.third_order_centering.pre_center() 2nd argument (nq1) can't be converted to int");
    if (f2py_success) {
    /* Processing variable nq2 */
        f2py_success = int_from_pyobj(&nq2,nq2_capi,"thermal_conductivity.third_order_centering.pre_center() 3rd argument (nq2) can't be converted to int");
    if (f2py_success) {
    /* Processing variable nq3 */
        f2py_success = int_from_pyobj(&nq3,nq3_capi,"thermal_conductivity.third_order_centering.pre_center() 4th argument (nq3) can't be converted to int");
    if (f2py_success) {
    /* Processing variable alat */
    alat_Dims[0]=3,alat_Dims[1]=3;
    capi_alat_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.pre_center: failed to create array from the 6th argument `alat`";
    capi_alat_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,alat_Dims,alat_Rank,  capi_alat_intent,alat_capi,capi_errmess);
    if (capi_alat_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        alat = (double *)(PyArray_DATA(capi_alat_as_array));

    /* Processing variable tau */
    tau_Dims[1]=3;
    capi_tau_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.pre_center: failed to create array from the 7th argument `tau`";
    capi_tau_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,tau_Dims,tau_Rank,  capi_tau_intent,tau_capi,capi_errmess);
    if (capi_tau_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        tau = (double *)(PyArray_DATA(capi_tau_as_array));

    /* Processing variable far */
        f2py_success = int_from_pyobj(&far,far_capi,"thermal_conductivity.third_order_centering.pre_center() 1st argument (far) can't be converted to int");
    if (f2py_success) {
    /* Processing variable tol */
        f2py_success = double_from_pyobj(&tol,tol_capi,"thermal_conductivity.third_order_centering.pre_center() 5th argument (tol) can't be converted to double");
    if (f2py_success) {
    /* Processing variable lat_min */
    lat_min_Dims[0]=3;
    capi_lat_min_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.pre_center: failed to create array from the hidden `lat_min`";
    capi_lat_min_as_array = ndarray_from_pyobj(  NPY_INT,1,lat_min_Dims,lat_min_Rank,  capi_lat_min_intent,Py_None,capi_errmess);
    if (capi_lat_min_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        lat_min = (int *)(PyArray_DATA(capi_lat_min_as_array));

    /* Processing variable lat_max */
    lat_max_Dims[0]=3;
    capi_lat_max_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.pre_center: failed to create array from the hidden `lat_max`";
    capi_lat_max_as_array = ndarray_from_pyobj(  NPY_INT,1,lat_max_Dims,lat_max_Rank,  capi_lat_max_intent,Py_None,capi_errmess);
    if (capi_lat_max_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        lat_max = (int *)(PyArray_DATA(capi_lat_max_as_array));

    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(tau, 0); else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.third_order_centering.pre_center() 1st keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(tau, 0) == nat,"shape(tau, 0) == nat","1st keyword nat","pre_center:nat=%d",nat) {
    /* Processing variable original */
    original_Dims[0]=3 * nat,original_Dims[1]=3 * nat,original_Dims[2]=3 * nat,original_Dims[3]=nq1 * nq2 * nq3,original_Dims[4]=nq1 * nq2 * nq3;
    capi_original_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.pre_center: failed to create array from the 8th argument `original`";
    capi_original_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,original_Dims,original_Rank,  capi_original_intent,original_capi,capi_errmess);
    if (capi_original_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        original = (double *)(PyArray_DATA(capi_original_as_array));

    CHECKARRAY(shape(original, 3) == nq1 * nq2 * nq3,"shape(original, 3) == nq1 * nq2 * nq3","8th argument original") {
    CHECKARRAY(shape(original, 3) == nq1 * nq2 * nq3,"shape(original, 3) == nq1 * nq2 * nq3","8th argument original") {
    CHECKARRAY(shape(original, 3) == nq1 * nq2 * nq3,"shape(original, 3) == nq1 * nq2 * nq3","8th argument original") {
    /* Processing variable centered */
    centered_Dims[0]=3 * nat,centered_Dims[1]=3 * nat,centered_Dims[2]=3 * nat,centered_Dims[3]=6 * far * nq1 * nq2 * nq3 + 12 * far * far * nq1 * nq2 * nq3 + 8 * far * far * far * nq1 * nq2 * nq3 + nq1 * nq2 * nq3,centered_Dims[4]=6 * far * nq1 * nq2 * nq3 + 12 * far * far * nq1 * nq2 * nq3 + 8 * far * far * far * nq1 * nq2 * nq3 + nq1 * nq2 * nq3;
    capi_centered_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.pre_center: failed to create array from the hidden `centered`";
    capi_centered_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,centered_Dims,centered_Rank,  capi_centered_intent,Py_None,capi_errmess);
    if (capi_centered_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        centered = (double *)(PyArray_DATA(capi_centered_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&far,&nat,&nq1,&nq2,&nq3,&tol,alat,tau,original,centered,lat_min,lat_max);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NNN",capi_centered_as_array,capi_lat_min_as_array,capi_lat_max_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_centered_as_array == NULL) ... else of centered */
    /* End of cleaning variable centered */
    } /*CHECKARRAY(shape(original, 3) == nq1 * nq2 * nq3)*/
    } /*CHECKARRAY(shape(original, 3) == nq1 * nq2 * nq3)*/
    } /*CHECKARRAY(shape(original, 3) == nq1 * nq2 * nq3)*/
    if((PyObject *)capi_original_as_array!=original_capi) {
        Py_XDECREF(capi_original_as_array); }
    }  /* if (capi_original_as_array == NULL) ... else of original */
    /* End of cleaning variable original */
    } /*CHECKSCALAR(shape(tau, 0) == nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    }  /* if (capi_lat_max_as_array == NULL) ... else of lat_max */
    /* End of cleaning variable lat_max */
    }  /* if (capi_lat_min_as_array == NULL) ... else of lat_min */
    /* End of cleaning variable lat_min */
    } /*if (f2py_success) of tol*/
    /* End of cleaning variable tol */
    } /*if (f2py_success) of far*/
    /* End of cleaning variable far */
    if((PyObject *)capi_tau_as_array!=tau_capi) {
        Py_XDECREF(capi_tau_as_array); }
    }  /* if (capi_tau_as_array == NULL) ... else of tau */
    /* End of cleaning variable tau */
    if((PyObject *)capi_alat_as_array!=alat_capi) {
        Py_XDECREF(capi_alat_as_array); }
    }  /* if (capi_alat_as_array == NULL) ... else of alat */
    /* End of cleaning variable alat */
    } /*if (f2py_success) of nq3*/
    /* End of cleaning variable nq3 */
    } /*if (f2py_success) of nq2*/
    /* End of cleaning variable nq2 */
    } /*if (f2py_success) of nq1*/
    /* End of cleaning variable nq1 */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of pre_center *****************************/

/*********************************** assign ***********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_assign[] = "\
centered,x2,x3,r2,r3 = assign(alat,lat_min_prev,lat_max_prev,centered_prev,lat_min,lat_max,n_sup_ws,[nat,n_sup_ws_prev])\n\nWrapper for ``assign``.\
\n\nParameters\n----------\n"
"alat : input rank-2 array('d') with bounds (3,3)\n"
"lat_min_prev : input rank-1 array('i') with bounds (3)\n"
"lat_max_prev : input rank-1 array('i') with bounds (3)\n"
"centered_prev : input rank-5 array('d') with bounds (3 * nat,3 * nat,3 * nat,n_sup_ws_prev,n_sup_ws_prev)\n"
"lat_min : input rank-1 array('i') with bounds (3)\n"
"lat_max : input rank-1 array('i') with bounds (3)\n"
"n_sup_ws : input int\n"
"\nOther Parameters\n----------------\n"
"nat : input int, optional\n    Default: shape(centered_prev, 0) / 3\n"
"n_sup_ws_prev : input int, optional\n    Default: shape(centered_prev, 3)\n"
"\nReturns\n-------\n"
"centered : rank-4 array('d') with bounds (3 * nat,3 * nat,3 * nat,n_sup_ws * n_sup_ws)\n"
"x2 : rank-2 array('i') with bounds (3,n_sup_ws * n_sup_ws)\n"
"x3 : rank-2 array('i') with bounds (3,n_sup_ws * n_sup_ws)\n"
"r2 : rank-2 array('d') with bounds (3,n_sup_ws * n_sup_ws)\n"
"r3 : rank-2 array('d') with bounds (3,n_sup_ws * n_sup_ws)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_assign(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,int*,int*,double*,int*,int*,int*,int*,int*,double*,int*,int*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *alat = NULL;
    npy_intp alat_Dims[2] = {-1, -1};
    const int alat_Rank = 2;
    PyArrayObject *capi_alat_as_array = NULL;
    int capi_alat_intent = 0;
    PyObject *alat_capi = Py_None;
    int *lat_min_prev = NULL;
    npy_intp lat_min_prev_Dims[1] = {-1};
    const int lat_min_prev_Rank = 1;
    PyArrayObject *capi_lat_min_prev_as_array = NULL;
    int capi_lat_min_prev_intent = 0;
    PyObject *lat_min_prev_capi = Py_None;
    int *lat_max_prev = NULL;
    npy_intp lat_max_prev_Dims[1] = {-1};
    const int lat_max_prev_Rank = 1;
    PyArrayObject *capi_lat_max_prev_as_array = NULL;
    int capi_lat_max_prev_intent = 0;
    PyObject *lat_max_prev_capi = Py_None;
    double *centered_prev = NULL;
    npy_intp centered_prev_Dims[5] = {-1, -1, -1, -1, -1};
    const int centered_prev_Rank = 5;
    PyArrayObject *capi_centered_prev_as_array = NULL;
    int capi_centered_prev_intent = 0;
    PyObject *centered_prev_capi = Py_None;
    int *lat_min = NULL;
    npy_intp lat_min_Dims[1] = {-1};
    const int lat_min_Rank = 1;
    PyArrayObject *capi_lat_min_as_array = NULL;
    int capi_lat_min_intent = 0;
    PyObject *lat_min_capi = Py_None;
    int *lat_max = NULL;
    npy_intp lat_max_Dims[1] = {-1};
    const int lat_max_Rank = 1;
    PyArrayObject *capi_lat_max_as_array = NULL;
    int capi_lat_max_intent = 0;
    PyObject *lat_max_capi = Py_None;
    int n_sup_ws = 0;
    PyObject *n_sup_ws_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int n_sup_ws_prev = 0;
    PyObject *n_sup_ws_prev_capi = Py_None;
    double *centered = NULL;
    npy_intp centered_Dims[4] = {-1, -1, -1, -1};
    const int centered_Rank = 4;
    PyArrayObject *capi_centered_as_array = NULL;
    int capi_centered_intent = 0;
    int *x2 = NULL;
    npy_intp x2_Dims[2] = {-1, -1};
    const int x2_Rank = 2;
    PyArrayObject *capi_x2_as_array = NULL;
    int capi_x2_intent = 0;
    int *x3 = NULL;
    npy_intp x3_Dims[2] = {-1, -1};
    const int x3_Rank = 2;
    PyArrayObject *capi_x3_as_array = NULL;
    int capi_x3_intent = 0;
    double *r2 = NULL;
    npy_intp r2_Dims[2] = {-1, -1};
    const int r2_Rank = 2;
    PyArrayObject *capi_r2_as_array = NULL;
    int capi_r2_intent = 0;
    double *r3 = NULL;
    npy_intp r3_Dims[2] = {-1, -1};
    const int r3_Rank = 2;
    PyArrayObject *capi_r3_as_array = NULL;
    int capi_r3_intent = 0;
    static char *capi_kwlist[] = {"alat","lat_min_prev","lat_max_prev","centered_prev","lat_min","lat_max","n_sup_ws","nat","n_sup_ws_prev",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOO|OO:thermal_conductivity.third_order_centering.assign",\
        capi_kwlist,&alat_capi,&lat_min_prev_capi,&lat_max_prev_capi,&centered_prev_capi,&lat_min_capi,&lat_max_capi,&n_sup_ws_capi,&nat_capi,&n_sup_ws_prev_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable n_sup_ws */
        f2py_success = int_from_pyobj(&n_sup_ws,n_sup_ws_capi,"thermal_conductivity.third_order_centering.assign() 7th argument (n_sup_ws) can't be converted to int");
    if (f2py_success) {
    /* Processing variable alat */
    alat_Dims[0]=3,alat_Dims[1]=3;
    capi_alat_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.assign: failed to create array from the 1st argument `alat`";
    capi_alat_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,alat_Dims,alat_Rank,  capi_alat_intent,alat_capi,capi_errmess);
    if (capi_alat_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        alat = (double *)(PyArray_DATA(capi_alat_as_array));

    /* Processing variable lat_min_prev */
    lat_min_prev_Dims[0]=3;
    capi_lat_min_prev_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.assign: failed to create array from the 2nd argument `lat_min_prev`";
    capi_lat_min_prev_as_array = ndarray_from_pyobj(  NPY_INT,1,lat_min_prev_Dims,lat_min_prev_Rank,  capi_lat_min_prev_intent,lat_min_prev_capi,capi_errmess);
    if (capi_lat_min_prev_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        lat_min_prev = (int *)(PyArray_DATA(capi_lat_min_prev_as_array));

    /* Processing variable lat_max_prev */
    lat_max_prev_Dims[0]=3;
    capi_lat_max_prev_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.assign: failed to create array from the 3rd argument `lat_max_prev`";
    capi_lat_max_prev_as_array = ndarray_from_pyobj(  NPY_INT,1,lat_max_prev_Dims,lat_max_prev_Rank,  capi_lat_max_prev_intent,lat_max_prev_capi,capi_errmess);
    if (capi_lat_max_prev_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        lat_max_prev = (int *)(PyArray_DATA(capi_lat_max_prev_as_array));

    /* Processing variable lat_min */
    lat_min_Dims[0]=3;
    capi_lat_min_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.assign: failed to create array from the 5th argument `lat_min`";
    capi_lat_min_as_array = ndarray_from_pyobj(  NPY_INT,1,lat_min_Dims,lat_min_Rank,  capi_lat_min_intent,lat_min_capi,capi_errmess);
    if (capi_lat_min_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        lat_min = (int *)(PyArray_DATA(capi_lat_min_as_array));

    /* Processing variable lat_max */
    lat_max_Dims[0]=3;
    capi_lat_max_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.assign: failed to create array from the 6th argument `lat_max`";
    capi_lat_max_as_array = ndarray_from_pyobj(  NPY_INT,1,lat_max_Dims,lat_max_Rank,  capi_lat_max_intent,lat_max_capi,capi_errmess);
    if (capi_lat_max_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        lat_max = (int *)(PyArray_DATA(capi_lat_max_as_array));

    /* Processing variable centered_prev */
    ;
    capi_centered_prev_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.assign: failed to create array from the 4th argument `centered_prev`";
    capi_centered_prev_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,centered_prev_Dims,centered_prev_Rank,  capi_centered_prev_intent,centered_prev_capi,capi_errmess);
    if (capi_centered_prev_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        centered_prev = (double *)(PyArray_DATA(capi_centered_prev_as_array));

    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(centered_prev, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.third_order_centering.assign() 1st keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(centered_prev, 0) == 3 * nat,"shape(centered_prev, 0) == 3 * nat","1st keyword nat","assign:nat=%d",nat) {
    /* Processing variable n_sup_ws_prev */
    if (n_sup_ws_prev_capi == Py_None) n_sup_ws_prev = shape(centered_prev, 3); else
        f2py_success = int_from_pyobj(&n_sup_ws_prev,n_sup_ws_prev_capi,"thermal_conductivity.third_order_centering.assign() 2nd keyword (n_sup_ws_prev) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(centered_prev, 3) == n_sup_ws_prev,"shape(centered_prev, 3) == n_sup_ws_prev","2nd keyword n_sup_ws_prev","assign:n_sup_ws_prev=%d",n_sup_ws_prev) {
    /* Processing variable centered */
    centered_Dims[0]=3 * nat,centered_Dims[1]=3 * nat,centered_Dims[2]=3 * nat,centered_Dims[3]=n_sup_ws * n_sup_ws;
    capi_centered_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.assign: failed to create array from the hidden `centered`";
    capi_centered_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,centered_Dims,centered_Rank,  capi_centered_intent,Py_None,capi_errmess);
    if (capi_centered_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        centered = (double *)(PyArray_DATA(capi_centered_as_array));

    /* Processing variable x2 */
    x2_Dims[0]=3,x2_Dims[1]=n_sup_ws * n_sup_ws;
    capi_x2_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.assign: failed to create array from the hidden `x2`";
    capi_x2_as_array = ndarray_from_pyobj(  NPY_INT,1,x2_Dims,x2_Rank,  capi_x2_intent,Py_None,capi_errmess);
    if (capi_x2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        x2 = (int *)(PyArray_DATA(capi_x2_as_array));

    /* Processing variable x3 */
    x3_Dims[0]=3,x3_Dims[1]=n_sup_ws * n_sup_ws;
    capi_x3_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.assign: failed to create array from the hidden `x3`";
    capi_x3_as_array = ndarray_from_pyobj(  NPY_INT,1,x3_Dims,x3_Rank,  capi_x3_intent,Py_None,capi_errmess);
    if (capi_x3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        x3 = (int *)(PyArray_DATA(capi_x3_as_array));

    /* Processing variable r2 */
    r2_Dims[0]=3,r2_Dims[1]=n_sup_ws * n_sup_ws;
    capi_r2_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.assign: failed to create array from the hidden `r2`";
    capi_r2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_Dims,r2_Rank,  capi_r2_intent,Py_None,capi_errmess);
    if (capi_r2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2 = (double *)(PyArray_DATA(capi_r2_as_array));

    /* Processing variable r3 */
    r3_Dims[0]=3,r3_Dims[1]=n_sup_ws * n_sup_ws;
    capi_r3_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.assign: failed to create array from the hidden `r3`";
    capi_r3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_Dims,r3_Rank,  capi_r3_intent,Py_None,capi_errmess);
    if (capi_r3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3 = (double *)(PyArray_DATA(capi_r3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(alat,lat_min_prev,lat_max_prev,centered_prev,lat_min,lat_max,&n_sup_ws,&nat,&n_sup_ws_prev,centered,x2,x3,r2,r3);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("NNNNN",capi_centered_as_array,capi_x2_as_array,capi_x3_as_array,capi_r2_as_array,capi_r3_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_r3_as_array == NULL) ... else of r3 */
    /* End of cleaning variable r3 */
    }  /* if (capi_r2_as_array == NULL) ... else of r2 */
    /* End of cleaning variable r2 */
    }  /* if (capi_x3_as_array == NULL) ... else of x3 */
    /* End of cleaning variable x3 */
    }  /* if (capi_x2_as_array == NULL) ... else of x2 */
    /* End of cleaning variable x2 */
    }  /* if (capi_centered_as_array == NULL) ... else of centered */
    /* End of cleaning variable centered */
    } /*CHECKSCALAR(shape(centered_prev, 3) == n_sup_ws_prev)*/
    } /*if (f2py_success) of n_sup_ws_prev*/
    /* End of cleaning variable n_sup_ws_prev */
    } /*CHECKSCALAR(shape(centered_prev, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    if((PyObject *)capi_centered_prev_as_array!=centered_prev_capi) {
        Py_XDECREF(capi_centered_prev_as_array); }
    }  /* if (capi_centered_prev_as_array == NULL) ... else of centered_prev */
    /* End of cleaning variable centered_prev */
    if((PyObject *)capi_lat_max_as_array!=lat_max_capi) {
        Py_XDECREF(capi_lat_max_as_array); }
    }  /* if (capi_lat_max_as_array == NULL) ... else of lat_max */
    /* End of cleaning variable lat_max */
    if((PyObject *)capi_lat_min_as_array!=lat_min_capi) {
        Py_XDECREF(capi_lat_min_as_array); }
    }  /* if (capi_lat_min_as_array == NULL) ... else of lat_min */
    /* End of cleaning variable lat_min */
    if((PyObject *)capi_lat_max_prev_as_array!=lat_max_prev_capi) {
        Py_XDECREF(capi_lat_max_prev_as_array); }
    }  /* if (capi_lat_max_prev_as_array == NULL) ... else of lat_max_prev */
    /* End of cleaning variable lat_max_prev */
    if((PyObject *)capi_lat_min_prev_as_array!=lat_min_prev_capi) {
        Py_XDECREF(capi_lat_min_prev_as_array); }
    }  /* if (capi_lat_min_prev_as_array == NULL) ... else of lat_min_prev */
    /* End of cleaning variable lat_min_prev */
    if((PyObject *)capi_alat_as_array!=alat_capi) {
        Py_XDECREF(capi_alat_as_array); }
    }  /* if (capi_alat_as_array == NULL) ... else of alat */
    /* End of cleaning variable alat */
    } /*if (f2py_success) of n_sup_ws*/
    /* End of cleaning variable n_sup_ws */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************* end of assign *******************************/

/******************************** within_dmax ********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_within_dmax[] = "\
within_dmax = within_dmax(v1,v2,v3,d1,d2,d3,tol)\n\nWrapper for ``within_dmax``.\
\n\nParameters\n----------\n"
"v1 : input rank-1 array('d') with bounds (3)\n"
"v2 : input rank-1 array('d') with bounds (3)\n"
"v3 : input rank-1 array('d') with bounds (3)\n"
"d1 : input float\n"
"d2 : input float\n"
"d3 : input float\n"
"tol : input float\n"
"\nReturns\n-------\n"
"within_dmax : int";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_within_dmax(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,double*,double*,double*,double*,double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int within_dmaxf2pywrap = 0;
    double *v1 = NULL;
    npy_intp v1_Dims[1] = {-1};
    const int v1_Rank = 1;
    PyArrayObject *capi_v1_as_array = NULL;
    int capi_v1_intent = 0;
    PyObject *v1_capi = Py_None;
    double *v2 = NULL;
    npy_intp v2_Dims[1] = {-1};
    const int v2_Rank = 1;
    PyArrayObject *capi_v2_as_array = NULL;
    int capi_v2_intent = 0;
    PyObject *v2_capi = Py_None;
    double *v3 = NULL;
    npy_intp v3_Dims[1] = {-1};
    const int v3_Rank = 1;
    PyArrayObject *capi_v3_as_array = NULL;
    int capi_v3_intent = 0;
    PyObject *v3_capi = Py_None;
    double d1 = 0;
    PyObject *d1_capi = Py_None;
    double d2 = 0;
    PyObject *d2_capi = Py_None;
    double d3 = 0;
    PyObject *d3_capi = Py_None;
    double tol = 0;
    PyObject *tol_capi = Py_None;
    static char *capi_kwlist[] = {"v1","v2","v3","d1","d2","d3","tol",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOO|:thermal_conductivity.third_order_centering.within_dmax",\
        capi_kwlist,&v1_capi,&v2_capi,&v3_capi,&d1_capi,&d2_capi,&d3_capi,&tol_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable v1 */
    v1_Dims[0]=3;
    capi_v1_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.within_dmax: failed to create array from the 1st argument `v1`";
    capi_v1_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,v1_Dims,v1_Rank,  capi_v1_intent,v1_capi,capi_errmess);
    if (capi_v1_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v1 = (double *)(PyArray_DATA(capi_v1_as_array));

    /* Processing variable v2 */
    v2_Dims[0]=3;
    capi_v2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.within_dmax: failed to create array from the 2nd argument `v2`";
    capi_v2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,v2_Dims,v2_Rank,  capi_v2_intent,v2_capi,capi_errmess);
    if (capi_v2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v2 = (double *)(PyArray_DATA(capi_v2_as_array));

    /* Processing variable v3 */
    v3_Dims[0]=3;
    capi_v3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.within_dmax: failed to create array from the 3rd argument `v3`";
    capi_v3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,v3_Dims,v3_Rank,  capi_v3_intent,v3_capi,capi_errmess);
    if (capi_v3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v3 = (double *)(PyArray_DATA(capi_v3_as_array));

    /* Processing variable d1 */
        f2py_success = double_from_pyobj(&d1,d1_capi,"thermal_conductivity.third_order_centering.within_dmax() 4th argument (d1) can't be converted to double");
    if (f2py_success) {
    /* Processing variable d2 */
        f2py_success = double_from_pyobj(&d2,d2_capi,"thermal_conductivity.third_order_centering.within_dmax() 5th argument (d2) can't be converted to double");
    if (f2py_success) {
    /* Processing variable d3 */
        f2py_success = double_from_pyobj(&d3,d3_capi,"thermal_conductivity.third_order_centering.within_dmax() 6th argument (d3) can't be converted to double");
    if (f2py_success) {
    /* Processing variable tol */
        f2py_success = double_from_pyobj(&tol,tol_capi,"thermal_conductivity.third_order_centering.within_dmax() 7th argument (tol) can't be converted to double");
    if (f2py_success) {
    /* Processing variable within_dmaxf2pywrap */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(&within_dmaxf2pywrap,v1,v2,v3,&d1,&d2,&d3,&tol);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("i",within_dmaxf2pywrap);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable within_dmaxf2pywrap */
    } /*if (f2py_success) of tol*/
    /* End of cleaning variable tol */
    } /*if (f2py_success) of d3*/
    /* End of cleaning variable d3 */
    } /*if (f2py_success) of d2*/
    /* End of cleaning variable d2 */
    } /*if (f2py_success) of d1*/
    /* End of cleaning variable d1 */
    if((PyObject *)capi_v3_as_array!=v3_capi) {
        Py_XDECREF(capi_v3_as_array); }
    }  /* if (capi_v3_as_array == NULL) ... else of v3 */
    /* End of cleaning variable v3 */
    if((PyObject *)capi_v2_as_array!=v2_capi) {
        Py_XDECREF(capi_v2_as_array); }
    }  /* if (capi_v2_as_array == NULL) ... else of v2 */
    /* End of cleaning variable v2 */
    if((PyObject *)capi_v1_as_array!=v1_capi) {
        Py_XDECREF(capi_v1_as_array); }
    }  /* if (capi_v1_as_array == NULL) ... else of v1 */
    /* End of cleaning variable v1 */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of within_dmax *****************************/

/***************************** compute_perimeter *****************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_compute_perimeter[] = "\
compute_perimeter = compute_perimeter(v1,v2,v3)\n\nWrapper for ``compute_perimeter``.\
\n\nParameters\n----------\n"
"v1 : input rank-1 array('d') with bounds (3)\n"
"v2 : input rank-1 array('d') with bounds (3)\n"
"v3 : input rank-1 array('d') with bounds (3)\n"
"\nReturns\n-------\n"
"compute_perimeter : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_compute_perimeter(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double compute_perimeterf2pywrap = 0;
    double *v1 = NULL;
    npy_intp v1_Dims[1] = {-1};
    const int v1_Rank = 1;
    PyArrayObject *capi_v1_as_array = NULL;
    int capi_v1_intent = 0;
    PyObject *v1_capi = Py_None;
    double *v2 = NULL;
    npy_intp v2_Dims[1] = {-1};
    const int v2_Rank = 1;
    PyArrayObject *capi_v2_as_array = NULL;
    int capi_v2_intent = 0;
    PyObject *v2_capi = Py_None;
    double *v3 = NULL;
    npy_intp v3_Dims[1] = {-1};
    const int v3_Rank = 1;
    PyArrayObject *capi_v3_as_array = NULL;
    int capi_v3_intent = 0;
    PyObject *v3_capi = Py_None;
    static char *capi_kwlist[] = {"v1","v2","v3",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|:thermal_conductivity.third_order_centering.compute_perimeter",\
        capi_kwlist,&v1_capi,&v2_capi,&v3_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable v1 */
    v1_Dims[0]=3;
    capi_v1_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.compute_perimeter: failed to create array from the 1st argument `v1`";
    capi_v1_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,v1_Dims,v1_Rank,  capi_v1_intent,v1_capi,capi_errmess);
    if (capi_v1_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v1 = (double *)(PyArray_DATA(capi_v1_as_array));

    /* Processing variable v2 */
    v2_Dims[0]=3;
    capi_v2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.compute_perimeter: failed to create array from the 2nd argument `v2`";
    capi_v2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,v2_Dims,v2_Rank,  capi_v2_intent,v2_capi,capi_errmess);
    if (capi_v2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v2 = (double *)(PyArray_DATA(capi_v2_as_array));

    /* Processing variable v3 */
    v3_Dims[0]=3;
    capi_v3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.compute_perimeter: failed to create array from the 3rd argument `v3`";
    capi_v3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,v3_Dims,v3_Rank,  capi_v3_intent,v3_capi,capi_errmess);
    if (capi_v3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v3 = (double *)(PyArray_DATA(capi_v3_as_array));

    /* Processing variable compute_perimeterf2pywrap */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(&compute_perimeterf2pywrap,v1,v2,v3);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("d",compute_perimeterf2pywrap);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable compute_perimeterf2pywrap */
    if((PyObject *)capi_v3_as_array!=v3_capi) {
        Py_XDECREF(capi_v3_as_array); }
    }  /* if (capi_v3_as_array == NULL) ... else of v3 */
    /* End of cleaning variable v3 */
    if((PyObject *)capi_v2_as_array!=v2_capi) {
        Py_XDECREF(capi_v2_as_array); }
    }  /* if (capi_v2_as_array == NULL) ... else of v2 */
    /* End of cleaning variable v2 */
    if((PyObject *)capi_v1_as_array!=v1_capi) {
        Py_XDECREF(capi_v1_as_array); }
    }  /* if (capi_v1_as_array == NULL) ... else of v1 */
    /* End of cleaning variable v1 */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************** end of compute_perimeter **************************/

/****************************** three_to_one_len ******************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_three_to_one_len[] = "\
three_to_one_len = three_to_one_len(v,v_min,v_len)\n\nWrapper for ``three_to_one_len``.\
\n\nParameters\n----------\n"
"v : input rank-1 array('i') with bounds (3)\n"
"v_min : input rank-1 array('i') with bounds (3)\n"
"v_len : input rank-1 array('i') with bounds (3)\n"
"\nReturns\n-------\n"
"three_to_one_len : int";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_three_to_one_len(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int three_to_one_lenf2pywrap = 0;
    int *v = NULL;
    npy_intp v_Dims[1] = {-1};
    const int v_Rank = 1;
    PyArrayObject *capi_v_as_array = NULL;
    int capi_v_intent = 0;
    PyObject *v_capi = Py_None;
    int *v_min = NULL;
    npy_intp v_min_Dims[1] = {-1};
    const int v_min_Rank = 1;
    PyArrayObject *capi_v_min_as_array = NULL;
    int capi_v_min_intent = 0;
    PyObject *v_min_capi = Py_None;
    int *v_len = NULL;
    npy_intp v_len_Dims[1] = {-1};
    const int v_len_Rank = 1;
    PyArrayObject *capi_v_len_as_array = NULL;
    int capi_v_len_intent = 0;
    PyObject *v_len_capi = Py_None;
    static char *capi_kwlist[] = {"v","v_min","v_len",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|:thermal_conductivity.third_order_centering.three_to_one_len",\
        capi_kwlist,&v_capi,&v_min_capi,&v_len_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable v */
    v_Dims[0]=3;
    capi_v_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.three_to_one_len: failed to create array from the 1st argument `v`";
    capi_v_as_array = ndarray_from_pyobj(  NPY_INT,1,v_Dims,v_Rank,  capi_v_intent,v_capi,capi_errmess);
    if (capi_v_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v = (int *)(PyArray_DATA(capi_v_as_array));

    /* Processing variable v_min */
    v_min_Dims[0]=3;
    capi_v_min_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.three_to_one_len: failed to create array from the 2nd argument `v_min`";
    capi_v_min_as_array = ndarray_from_pyobj(  NPY_INT,1,v_min_Dims,v_min_Rank,  capi_v_min_intent,v_min_capi,capi_errmess);
    if (capi_v_min_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v_min = (int *)(PyArray_DATA(capi_v_min_as_array));

    /* Processing variable v_len */
    v_len_Dims[0]=3;
    capi_v_len_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.three_to_one_len: failed to create array from the 3rd argument `v_len`";
    capi_v_len_as_array = ndarray_from_pyobj(  NPY_INT,1,v_len_Dims,v_len_Rank,  capi_v_len_intent,v_len_capi,capi_errmess);
    if (capi_v_len_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v_len = (int *)(PyArray_DATA(capi_v_len_as_array));

    /* Processing variable three_to_one_lenf2pywrap */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(&three_to_one_lenf2pywrap,v,v_min,v_len);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("i",three_to_one_lenf2pywrap);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable three_to_one_lenf2pywrap */
    if((PyObject *)capi_v_len_as_array!=v_len_capi) {
        Py_XDECREF(capi_v_len_as_array); }
    }  /* if (capi_v_len_as_array == NULL) ... else of v_len */
    /* End of cleaning variable v_len */
    if((PyObject *)capi_v_min_as_array!=v_min_capi) {
        Py_XDECREF(capi_v_min_as_array); }
    }  /* if (capi_v_min_as_array == NULL) ... else of v_min */
    /* End of cleaning variable v_min */
    if((PyObject *)capi_v_as_array!=v_capi) {
        Py_XDECREF(capi_v_as_array); }
    }  /* if (capi_v_as_array == NULL) ... else of v */
    /* End of cleaning variable v */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************** end of three_to_one_len **************************/

/******************************** three_to_one ********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_three_to_one[] = "\
three_to_one = three_to_one(v,v_min,v_max)\n\nWrapper for ``three_to_one``.\
\n\nParameters\n----------\n"
"v : input rank-1 array('i') with bounds (3)\n"
"v_min : input rank-1 array('i') with bounds (3)\n"
"v_max : input rank-1 array('i') with bounds (3)\n"
"\nReturns\n-------\n"
"three_to_one : int";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_three_to_one(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int three_to_onef2pywrap = 0;
    int *v = NULL;
    npy_intp v_Dims[1] = {-1};
    const int v_Rank = 1;
    PyArrayObject *capi_v_as_array = NULL;
    int capi_v_intent = 0;
    PyObject *v_capi = Py_None;
    int *v_min = NULL;
    npy_intp v_min_Dims[1] = {-1};
    const int v_min_Rank = 1;
    PyArrayObject *capi_v_min_as_array = NULL;
    int capi_v_min_intent = 0;
    PyObject *v_min_capi = Py_None;
    int *v_max = NULL;
    npy_intp v_max_Dims[1] = {-1};
    const int v_max_Rank = 1;
    PyArrayObject *capi_v_max_as_array = NULL;
    int capi_v_max_intent = 0;
    PyObject *v_max_capi = Py_None;
    static char *capi_kwlist[] = {"v","v_min","v_max",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|:thermal_conductivity.third_order_centering.three_to_one",\
        capi_kwlist,&v_capi,&v_min_capi,&v_max_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable v */
    v_Dims[0]=3;
    capi_v_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.three_to_one: failed to create array from the 1st argument `v`";
    capi_v_as_array = ndarray_from_pyobj(  NPY_INT,1,v_Dims,v_Rank,  capi_v_intent,v_capi,capi_errmess);
    if (capi_v_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v = (int *)(PyArray_DATA(capi_v_as_array));

    /* Processing variable v_min */
    v_min_Dims[0]=3;
    capi_v_min_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.three_to_one: failed to create array from the 2nd argument `v_min`";
    capi_v_min_as_array = ndarray_from_pyobj(  NPY_INT,1,v_min_Dims,v_min_Rank,  capi_v_min_intent,v_min_capi,capi_errmess);
    if (capi_v_min_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v_min = (int *)(PyArray_DATA(capi_v_min_as_array));

    /* Processing variable v_max */
    v_max_Dims[0]=3;
    capi_v_max_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.three_to_one: failed to create array from the 3rd argument `v_max`";
    capi_v_max_as_array = ndarray_from_pyobj(  NPY_INT,1,v_max_Dims,v_max_Rank,  capi_v_max_intent,v_max_capi,capi_errmess);
    if (capi_v_max_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v_max = (int *)(PyArray_DATA(capi_v_max_as_array));

    /* Processing variable three_to_onef2pywrap */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(&three_to_onef2pywrap,v,v_min,v_max);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("i",three_to_onef2pywrap);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable three_to_onef2pywrap */
    if((PyObject *)capi_v_max_as_array!=v_max_capi) {
        Py_XDECREF(capi_v_max_as_array); }
    }  /* if (capi_v_max_as_array == NULL) ... else of v_max */
    /* End of cleaning variable v_max */
    if((PyObject *)capi_v_min_as_array!=v_min_capi) {
        Py_XDECREF(capi_v_min_as_array); }
    }  /* if (capi_v_min_as_array == NULL) ... else of v_min */
    /* End of cleaning variable v_min */
    if((PyObject *)capi_v_as_array!=v_capi) {
        Py_XDECREF(capi_v_as_array); }
    }  /* if (capi_v_as_array == NULL) ... else of v */
    /* End of cleaning variable v */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************************** end of three_to_one ****************************/

/****************************** one_to_three_len ******************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_one_to_three_len[] = "\
one_to_three_len = one_to_three_len(j,v_min,v_len)\n\nWrapper for ``one_to_three_len``.\
\n\nParameters\n----------\n"
"j : input int\n"
"v_min : input rank-1 array('i') with bounds (3)\n"
"v_len : input rank-1 array('i') with bounds (3)\n"
"\nReturns\n-------\n"
"one_to_three_len : rank-1 array('i') with bounds (3) and one_to_three_lenf2pywrap storage";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_one_to_three_len(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int *one_to_three_lenf2pywrap = NULL;
    npy_intp one_to_three_lenf2pywrap_Dims[1] = {-1};
    const int one_to_three_lenf2pywrap_Rank = 1;
    PyArrayObject *capi_one_to_three_lenf2pywrap_as_array = NULL;
    int capi_one_to_three_lenf2pywrap_intent = 0;
    int j = 0;
    PyObject *j_capi = Py_None;
    int *v_min = NULL;
    npy_intp v_min_Dims[1] = {-1};
    const int v_min_Rank = 1;
    PyArrayObject *capi_v_min_as_array = NULL;
    int capi_v_min_intent = 0;
    PyObject *v_min_capi = Py_None;
    int *v_len = NULL;
    npy_intp v_len_Dims[1] = {-1};
    const int v_len_Rank = 1;
    PyArrayObject *capi_v_len_as_array = NULL;
    int capi_v_len_intent = 0;
    PyObject *v_len_capi = Py_None;
    static char *capi_kwlist[] = {"j","v_min","v_len",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|:thermal_conductivity.third_order_centering.one_to_three_len",\
        capi_kwlist,&j_capi,&v_min_capi,&v_len_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable j */
        f2py_success = int_from_pyobj(&j,j_capi,"thermal_conductivity.third_order_centering.one_to_three_len() 1st argument (j) can't be converted to int");
    if (f2py_success) {
    /* Processing variable v_min */
    v_min_Dims[0]=3;
    capi_v_min_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.one_to_three_len: failed to create array from the 2nd argument `v_min`";
    capi_v_min_as_array = ndarray_from_pyobj(  NPY_INT,1,v_min_Dims,v_min_Rank,  capi_v_min_intent,v_min_capi,capi_errmess);
    if (capi_v_min_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v_min = (int *)(PyArray_DATA(capi_v_min_as_array));

    /* Processing variable v_len */
    v_len_Dims[0]=3;
    capi_v_len_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.one_to_three_len: failed to create array from the 3rd argument `v_len`";
    capi_v_len_as_array = ndarray_from_pyobj(  NPY_INT,1,v_len_Dims,v_len_Rank,  capi_v_len_intent,v_len_capi,capi_errmess);
    if (capi_v_len_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v_len = (int *)(PyArray_DATA(capi_v_len_as_array));

    /* Processing variable one_to_three_lenf2pywrap */
    one_to_three_lenf2pywrap_Dims[0]=3;
    capi_one_to_three_lenf2pywrap_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.one_to_three_len: failed to create array from the hidden `one_to_three_lenf2pywrap`";
    capi_one_to_three_lenf2pywrap_as_array = ndarray_from_pyobj(  NPY_INT,1,one_to_three_lenf2pywrap_Dims,one_to_three_lenf2pywrap_Rank,  capi_one_to_three_lenf2pywrap_intent,Py_None,capi_errmess);
    if (capi_one_to_three_lenf2pywrap_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        one_to_three_lenf2pywrap = (int *)(PyArray_DATA(capi_one_to_three_lenf2pywrap_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(one_to_three_lenf2pywrap,&j,v_min,v_len);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_one_to_three_lenf2pywrap_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_one_to_three_lenf2pywrap_as_array == NULL) ... else of one_to_three_lenf2pywrap */
    /* End of cleaning variable one_to_three_lenf2pywrap */
    if((PyObject *)capi_v_len_as_array!=v_len_capi) {
        Py_XDECREF(capi_v_len_as_array); }
    }  /* if (capi_v_len_as_array == NULL) ... else of v_len */
    /* End of cleaning variable v_len */
    if((PyObject *)capi_v_min_as_array!=v_min_capi) {
        Py_XDECREF(capi_v_min_as_array); }
    }  /* if (capi_v_min_as_array == NULL) ... else of v_min */
    /* End of cleaning variable v_min */
    } /*if (f2py_success) of j*/
    /* End of cleaning variable j */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************** end of one_to_three_len **************************/

/******************************** one_to_three ********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_one_to_three[] = "\
one_to_three = one_to_three(j,v_min,v_max)\n\nWrapper for ``one_to_three``.\
\n\nParameters\n----------\n"
"j : input int\n"
"v_min : input rank-1 array('i') with bounds (3)\n"
"v_max : input rank-1 array('i') with bounds (3)\n"
"\nReturns\n-------\n"
"one_to_three : rank-1 array('i') with bounds (3) and one_to_threef2pywrap storage";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_one_to_three(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int *one_to_threef2pywrap = NULL;
    npy_intp one_to_threef2pywrap_Dims[1] = {-1};
    const int one_to_threef2pywrap_Rank = 1;
    PyArrayObject *capi_one_to_threef2pywrap_as_array = NULL;
    int capi_one_to_threef2pywrap_intent = 0;
    int j = 0;
    PyObject *j_capi = Py_None;
    int *v_min = NULL;
    npy_intp v_min_Dims[1] = {-1};
    const int v_min_Rank = 1;
    PyArrayObject *capi_v_min_as_array = NULL;
    int capi_v_min_intent = 0;
    PyObject *v_min_capi = Py_None;
    int *v_max = NULL;
    npy_intp v_max_Dims[1] = {-1};
    const int v_max_Rank = 1;
    PyArrayObject *capi_v_max_as_array = NULL;
    int capi_v_max_intent = 0;
    PyObject *v_max_capi = Py_None;
    static char *capi_kwlist[] = {"j","v_min","v_max",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|:thermal_conductivity.third_order_centering.one_to_three",\
        capi_kwlist,&j_capi,&v_min_capi,&v_max_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable j */
        f2py_success = int_from_pyobj(&j,j_capi,"thermal_conductivity.third_order_centering.one_to_three() 1st argument (j) can't be converted to int");
    if (f2py_success) {
    /* Processing variable v_min */
    v_min_Dims[0]=3;
    capi_v_min_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.one_to_three: failed to create array from the 2nd argument `v_min`";
    capi_v_min_as_array = ndarray_from_pyobj(  NPY_INT,1,v_min_Dims,v_min_Rank,  capi_v_min_intent,v_min_capi,capi_errmess);
    if (capi_v_min_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v_min = (int *)(PyArray_DATA(capi_v_min_as_array));

    /* Processing variable v_max */
    v_max_Dims[0]=3;
    capi_v_max_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.one_to_three: failed to create array from the 3rd argument `v_max`";
    capi_v_max_as_array = ndarray_from_pyobj(  NPY_INT,1,v_max_Dims,v_max_Rank,  capi_v_max_intent,v_max_capi,capi_errmess);
    if (capi_v_max_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v_max = (int *)(PyArray_DATA(capi_v_max_as_array));

    /* Processing variable one_to_threef2pywrap */
    one_to_threef2pywrap_Dims[0]=3;
    capi_one_to_threef2pywrap_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.one_to_three: failed to create array from the hidden `one_to_threef2pywrap`";
    capi_one_to_threef2pywrap_as_array = ndarray_from_pyobj(  NPY_INT,1,one_to_threef2pywrap_Dims,one_to_threef2pywrap_Rank,  capi_one_to_threef2pywrap_intent,Py_None,capi_errmess);
    if (capi_one_to_threef2pywrap_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        one_to_threef2pywrap = (int *)(PyArray_DATA(capi_one_to_threef2pywrap_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(one_to_threef2pywrap,&j,v_min,v_max);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_one_to_threef2pywrap_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_one_to_threef2pywrap_as_array == NULL) ... else of one_to_threef2pywrap */
    /* End of cleaning variable one_to_threef2pywrap */
    if((PyObject *)capi_v_max_as_array!=v_max_capi) {
        Py_XDECREF(capi_v_max_as_array); }
    }  /* if (capi_v_max_as_array == NULL) ... else of v_max */
    /* End of cleaning variable v_max */
    if((PyObject *)capi_v_min_as_array!=v_min_capi) {
        Py_XDECREF(capi_v_min_as_array); }
    }  /* if (capi_v_min_as_array == NULL) ... else of v_min */
    /* End of cleaning variable v_min */
    } /*if (f2py_success) of j*/
    /* End of cleaning variable j */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************************** end of one_to_three ****************************/

/******************************* min_el_wise_2 *******************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_min_el_wise_2[] = "\
min_el_wise_2 = min_el_wise_2(a,b)\n\nWrapper for ``min_el_wise_2``.\
\n\nParameters\n----------\n"
"a : input rank-1 array('i') with bounds (3)\n"
"b : input rank-1 array('i') with bounds (3)\n"
"\nReturns\n-------\n"
"min_el_wise_2 : rank-1 array('i') with bounds (3) and min_el_wise_2f2pywrap storage";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_min_el_wise_2(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int *min_el_wise_2f2pywrap = NULL;
    npy_intp min_el_wise_2f2pywrap_Dims[1] = {-1};
    const int min_el_wise_2f2pywrap_Rank = 1;
    PyArrayObject *capi_min_el_wise_2f2pywrap_as_array = NULL;
    int capi_min_el_wise_2f2pywrap_intent = 0;
    int *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_as_array = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    int *b = NULL;
    npy_intp b_Dims[1] = {-1};
    const int b_Rank = 1;
    PyArrayObject *capi_b_as_array = NULL;
    int capi_b_intent = 0;
    PyObject *b_capi = Py_None;
    static char *capi_kwlist[] = {"a","b",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:thermal_conductivity.third_order_centering.min_el_wise_2",\
        capi_kwlist,&a_capi,&b_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    a_Dims[0]=3;
    capi_a_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.min_el_wise_2: failed to create array from the 1st argument `a`";
    capi_a_as_array = ndarray_from_pyobj(  NPY_INT,1,a_Dims,a_Rank,  capi_a_intent,a_capi,capi_errmess);
    if (capi_a_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        a = (int *)(PyArray_DATA(capi_a_as_array));

    /* Processing variable b */
    b_Dims[0]=3;
    capi_b_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.min_el_wise_2: failed to create array from the 2nd argument `b`";
    capi_b_as_array = ndarray_from_pyobj(  NPY_INT,1,b_Dims,b_Rank,  capi_b_intent,b_capi,capi_errmess);
    if (capi_b_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        b = (int *)(PyArray_DATA(capi_b_as_array));

    /* Processing variable min_el_wise_2f2pywrap */
    min_el_wise_2f2pywrap_Dims[0]=3;
    capi_min_el_wise_2f2pywrap_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.min_el_wise_2: failed to create array from the hidden `min_el_wise_2f2pywrap`";
    capi_min_el_wise_2f2pywrap_as_array = ndarray_from_pyobj(  NPY_INT,1,min_el_wise_2f2pywrap_Dims,min_el_wise_2f2pywrap_Rank,  capi_min_el_wise_2f2pywrap_intent,Py_None,capi_errmess);
    if (capi_min_el_wise_2f2pywrap_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        min_el_wise_2f2pywrap = (int *)(PyArray_DATA(capi_min_el_wise_2f2pywrap_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(min_el_wise_2f2pywrap,a,b);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_min_el_wise_2f2pywrap_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_min_el_wise_2f2pywrap_as_array == NULL) ... else of min_el_wise_2f2pywrap */
    /* End of cleaning variable min_el_wise_2f2pywrap */
    if((PyObject *)capi_b_as_array!=b_capi) {
        Py_XDECREF(capi_b_as_array); }
    }  /* if (capi_b_as_array == NULL) ... else of b */
    /* End of cleaning variable b */
    if((PyObject *)capi_a_as_array!=a_capi) {
        Py_XDECREF(capi_a_as_array); }
    }  /* if (capi_a_as_array == NULL) ... else of a */
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************************** end of min_el_wise_2 ****************************/

/******************************* max_el_wise_2 *******************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_max_el_wise_2[] = "\
max_el_wise_2 = max_el_wise_2(a,b)\n\nWrapper for ``max_el_wise_2``.\
\n\nParameters\n----------\n"
"a : input rank-1 array('i') with bounds (3)\n"
"b : input rank-1 array('i') with bounds (3)\n"
"\nReturns\n-------\n"
"max_el_wise_2 : rank-1 array('i') with bounds (3) and max_el_wise_2f2pywrap storage";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_max_el_wise_2(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int *max_el_wise_2f2pywrap = NULL;
    npy_intp max_el_wise_2f2pywrap_Dims[1] = {-1};
    const int max_el_wise_2f2pywrap_Rank = 1;
    PyArrayObject *capi_max_el_wise_2f2pywrap_as_array = NULL;
    int capi_max_el_wise_2f2pywrap_intent = 0;
    int *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_as_array = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    int *b = NULL;
    npy_intp b_Dims[1] = {-1};
    const int b_Rank = 1;
    PyArrayObject *capi_b_as_array = NULL;
    int capi_b_intent = 0;
    PyObject *b_capi = Py_None;
    static char *capi_kwlist[] = {"a","b",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:thermal_conductivity.third_order_centering.max_el_wise_2",\
        capi_kwlist,&a_capi,&b_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    a_Dims[0]=3;
    capi_a_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.max_el_wise_2: failed to create array from the 1st argument `a`";
    capi_a_as_array = ndarray_from_pyobj(  NPY_INT,1,a_Dims,a_Rank,  capi_a_intent,a_capi,capi_errmess);
    if (capi_a_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        a = (int *)(PyArray_DATA(capi_a_as_array));

    /* Processing variable b */
    b_Dims[0]=3;
    capi_b_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.max_el_wise_2: failed to create array from the 2nd argument `b`";
    capi_b_as_array = ndarray_from_pyobj(  NPY_INT,1,b_Dims,b_Rank,  capi_b_intent,b_capi,capi_errmess);
    if (capi_b_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        b = (int *)(PyArray_DATA(capi_b_as_array));

    /* Processing variable max_el_wise_2f2pywrap */
    max_el_wise_2f2pywrap_Dims[0]=3;
    capi_max_el_wise_2f2pywrap_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.max_el_wise_2: failed to create array from the hidden `max_el_wise_2f2pywrap`";
    capi_max_el_wise_2f2pywrap_as_array = ndarray_from_pyobj(  NPY_INT,1,max_el_wise_2f2pywrap_Dims,max_el_wise_2f2pywrap_Rank,  capi_max_el_wise_2f2pywrap_intent,Py_None,capi_errmess);
    if (capi_max_el_wise_2f2pywrap_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        max_el_wise_2f2pywrap = (int *)(PyArray_DATA(capi_max_el_wise_2f2pywrap_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(max_el_wise_2f2pywrap,a,b);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_max_el_wise_2f2pywrap_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_max_el_wise_2f2pywrap_as_array == NULL) ... else of max_el_wise_2f2pywrap */
    /* End of cleaning variable max_el_wise_2f2pywrap */
    if((PyObject *)capi_b_as_array!=b_capi) {
        Py_XDECREF(capi_b_as_array); }
    }  /* if (capi_b_as_array == NULL) ... else of b */
    /* End of cleaning variable b */
    if((PyObject *)capi_a_as_array!=a_capi) {
        Py_XDECREF(capi_a_as_array); }
    }  /* if (capi_a_as_array == NULL) ... else of a */
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************************** end of max_el_wise_2 ****************************/

/******************************* min_el_wise_3 *******************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_min_el_wise_3[] = "\
min_el_wise_3 = min_el_wise_3(a,b,c)\n\nWrapper for ``min_el_wise_3``.\
\n\nParameters\n----------\n"
"a : input rank-1 array('i') with bounds (3)\n"
"b : input rank-1 array('i') with bounds (3)\n"
"c : input rank-1 array('i') with bounds (3)\n"
"\nReturns\n-------\n"
"min_el_wise_3 : rank-1 array('i') with bounds (3) and min_el_wise_3f2pywrap storage";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_min_el_wise_3(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int *min_el_wise_3f2pywrap = NULL;
    npy_intp min_el_wise_3f2pywrap_Dims[1] = {-1};
    const int min_el_wise_3f2pywrap_Rank = 1;
    PyArrayObject *capi_min_el_wise_3f2pywrap_as_array = NULL;
    int capi_min_el_wise_3f2pywrap_intent = 0;
    int *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_as_array = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    int *b = NULL;
    npy_intp b_Dims[1] = {-1};
    const int b_Rank = 1;
    PyArrayObject *capi_b_as_array = NULL;
    int capi_b_intent = 0;
    PyObject *b_capi = Py_None;
    int *c = NULL;
    npy_intp c_Dims[1] = {-1};
    const int c_Rank = 1;
    PyArrayObject *capi_c_as_array = NULL;
    int capi_c_intent = 0;
    PyObject *c_capi = Py_None;
    static char *capi_kwlist[] = {"a","b","c",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|:thermal_conductivity.third_order_centering.min_el_wise_3",\
        capi_kwlist,&a_capi,&b_capi,&c_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    a_Dims[0]=3;
    capi_a_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.min_el_wise_3: failed to create array from the 1st argument `a`";
    capi_a_as_array = ndarray_from_pyobj(  NPY_INT,1,a_Dims,a_Rank,  capi_a_intent,a_capi,capi_errmess);
    if (capi_a_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        a = (int *)(PyArray_DATA(capi_a_as_array));

    /* Processing variable b */
    b_Dims[0]=3;
    capi_b_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.min_el_wise_3: failed to create array from the 2nd argument `b`";
    capi_b_as_array = ndarray_from_pyobj(  NPY_INT,1,b_Dims,b_Rank,  capi_b_intent,b_capi,capi_errmess);
    if (capi_b_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        b = (int *)(PyArray_DATA(capi_b_as_array));

    /* Processing variable c */
    c_Dims[0]=3;
    capi_c_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.min_el_wise_3: failed to create array from the 3rd argument `c`";
    capi_c_as_array = ndarray_from_pyobj(  NPY_INT,1,c_Dims,c_Rank,  capi_c_intent,c_capi,capi_errmess);
    if (capi_c_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        c = (int *)(PyArray_DATA(capi_c_as_array));

    /* Processing variable min_el_wise_3f2pywrap */
    min_el_wise_3f2pywrap_Dims[0]=3;
    capi_min_el_wise_3f2pywrap_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.min_el_wise_3: failed to create array from the hidden `min_el_wise_3f2pywrap`";
    capi_min_el_wise_3f2pywrap_as_array = ndarray_from_pyobj(  NPY_INT,1,min_el_wise_3f2pywrap_Dims,min_el_wise_3f2pywrap_Rank,  capi_min_el_wise_3f2pywrap_intent,Py_None,capi_errmess);
    if (capi_min_el_wise_3f2pywrap_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        min_el_wise_3f2pywrap = (int *)(PyArray_DATA(capi_min_el_wise_3f2pywrap_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(min_el_wise_3f2pywrap,a,b,c);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_min_el_wise_3f2pywrap_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_min_el_wise_3f2pywrap_as_array == NULL) ... else of min_el_wise_3f2pywrap */
    /* End of cleaning variable min_el_wise_3f2pywrap */
    if((PyObject *)capi_c_as_array!=c_capi) {
        Py_XDECREF(capi_c_as_array); }
    }  /* if (capi_c_as_array == NULL) ... else of c */
    /* End of cleaning variable c */
    if((PyObject *)capi_b_as_array!=b_capi) {
        Py_XDECREF(capi_b_as_array); }
    }  /* if (capi_b_as_array == NULL) ... else of b */
    /* End of cleaning variable b */
    if((PyObject *)capi_a_as_array!=a_capi) {
        Py_XDECREF(capi_a_as_array); }
    }  /* if (capi_a_as_array == NULL) ... else of a */
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************************** end of min_el_wise_3 ****************************/

/******************************* max_el_wise_3 *******************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_max_el_wise_3[] = "\
max_el_wise_3 = max_el_wise_3(a,b,c)\n\nWrapper for ``max_el_wise_3``.\
\n\nParameters\n----------\n"
"a : input rank-1 array('i') with bounds (3)\n"
"b : input rank-1 array('i') with bounds (3)\n"
"c : input rank-1 array('i') with bounds (3)\n"
"\nReturns\n-------\n"
"max_el_wise_3 : rank-1 array('i') with bounds (3) and max_el_wise_3f2pywrap storage";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_max_el_wise_3(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int *max_el_wise_3f2pywrap = NULL;
    npy_intp max_el_wise_3f2pywrap_Dims[1] = {-1};
    const int max_el_wise_3f2pywrap_Rank = 1;
    PyArrayObject *capi_max_el_wise_3f2pywrap_as_array = NULL;
    int capi_max_el_wise_3f2pywrap_intent = 0;
    int *a = NULL;
    npy_intp a_Dims[1] = {-1};
    const int a_Rank = 1;
    PyArrayObject *capi_a_as_array = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    int *b = NULL;
    npy_intp b_Dims[1] = {-1};
    const int b_Rank = 1;
    PyArrayObject *capi_b_as_array = NULL;
    int capi_b_intent = 0;
    PyObject *b_capi = Py_None;
    int *c = NULL;
    npy_intp c_Dims[1] = {-1};
    const int c_Rank = 1;
    PyArrayObject *capi_c_as_array = NULL;
    int capi_c_intent = 0;
    PyObject *c_capi = Py_None;
    static char *capi_kwlist[] = {"a","b","c",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|:thermal_conductivity.third_order_centering.max_el_wise_3",\
        capi_kwlist,&a_capi,&b_capi,&c_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    a_Dims[0]=3;
    capi_a_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.max_el_wise_3: failed to create array from the 1st argument `a`";
    capi_a_as_array = ndarray_from_pyobj(  NPY_INT,1,a_Dims,a_Rank,  capi_a_intent,a_capi,capi_errmess);
    if (capi_a_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        a = (int *)(PyArray_DATA(capi_a_as_array));

    /* Processing variable b */
    b_Dims[0]=3;
    capi_b_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.max_el_wise_3: failed to create array from the 2nd argument `b`";
    capi_b_as_array = ndarray_from_pyobj(  NPY_INT,1,b_Dims,b_Rank,  capi_b_intent,b_capi,capi_errmess);
    if (capi_b_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        b = (int *)(PyArray_DATA(capi_b_as_array));

    /* Processing variable c */
    c_Dims[0]=3;
    capi_c_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.max_el_wise_3: failed to create array from the 3rd argument `c`";
    capi_c_as_array = ndarray_from_pyobj(  NPY_INT,1,c_Dims,c_Rank,  capi_c_intent,c_capi,capi_errmess);
    if (capi_c_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        c = (int *)(PyArray_DATA(capi_c_as_array));

    /* Processing variable max_el_wise_3f2pywrap */
    max_el_wise_3f2pywrap_Dims[0]=3;
    capi_max_el_wise_3f2pywrap_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.max_el_wise_3: failed to create array from the hidden `max_el_wise_3f2pywrap`";
    capi_max_el_wise_3f2pywrap_as_array = ndarray_from_pyobj(  NPY_INT,1,max_el_wise_3f2pywrap_Dims,max_el_wise_3f2pywrap_Rank,  capi_max_el_wise_3f2pywrap_intent,Py_None,capi_errmess);
    if (capi_max_el_wise_3f2pywrap_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        max_el_wise_3f2pywrap = (int *)(PyArray_DATA(capi_max_el_wise_3f2pywrap_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(max_el_wise_3f2pywrap,a,b,c);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_max_el_wise_3f2pywrap_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_max_el_wise_3f2pywrap_as_array == NULL) ... else of max_el_wise_3f2pywrap */
    /* End of cleaning variable max_el_wise_3f2pywrap */
    if((PyObject *)capi_c_as_array!=c_capi) {
        Py_XDECREF(capi_c_as_array); }
    }  /* if (capi_c_as_array == NULL) ... else of c */
    /* End of cleaning variable c */
    if((PyObject *)capi_b_as_array!=b_capi) {
        Py_XDECREF(capi_b_as_array); }
    }  /* if (capi_b_as_array == NULL) ... else of b */
    /* End of cleaning variable b */
    if((PyObject *)capi_a_as_array!=a_capi) {
        Py_XDECREF(capi_a_as_array); }
    }  /* if (capi_a_as_array == NULL) ... else of a */
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************************** end of max_el_wise_3 ****************************/

/******************************* cryst_to_cart *******************************/
static char doc_f2py_rout_thermal_conductivity_third_order_centering_cryst_to_cart[] = "\
cryst_to_cart = cryst_to_cart(v,alat)\n\nWrapper for ``cryst_to_cart``.\
\n\nParameters\n----------\n"
"v : input rank-1 array('i') with bounds (3)\n"
"alat : input rank-2 array('d') with bounds (3,3)\n"
"\nReturns\n-------\n"
"cryst_to_cart : rank-1 array('d') with bounds (3) and cryst_to_cartf2pywrap storage";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_centering_cryst_to_cart(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,int*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *cryst_to_cartf2pywrap = NULL;
    npy_intp cryst_to_cartf2pywrap_Dims[1] = {-1};
    const int cryst_to_cartf2pywrap_Rank = 1;
    PyArrayObject *capi_cryst_to_cartf2pywrap_as_array = NULL;
    int capi_cryst_to_cartf2pywrap_intent = 0;
    int *v = NULL;
    npy_intp v_Dims[1] = {-1};
    const int v_Rank = 1;
    PyArrayObject *capi_v_as_array = NULL;
    int capi_v_intent = 0;
    PyObject *v_capi = Py_None;
    double *alat = NULL;
    npy_intp alat_Dims[2] = {-1, -1};
    const int alat_Rank = 2;
    PyArrayObject *capi_alat_as_array = NULL;
    int capi_alat_intent = 0;
    PyObject *alat_capi = Py_None;
    static char *capi_kwlist[] = {"v","alat",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:thermal_conductivity.third_order_centering.cryst_to_cart",\
        capi_kwlist,&v_capi,&alat_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable v */
    v_Dims[0]=3;
    capi_v_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.cryst_to_cart: failed to create array from the 1st argument `v`";
    capi_v_as_array = ndarray_from_pyobj(  NPY_INT,1,v_Dims,v_Rank,  capi_v_intent,v_capi,capi_errmess);
    if (capi_v_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        v = (int *)(PyArray_DATA(capi_v_as_array));

    /* Processing variable alat */
    alat_Dims[0]=3,alat_Dims[1]=3;
    capi_alat_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.cryst_to_cart: failed to create array from the 2nd argument `alat`";
    capi_alat_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,alat_Dims,alat_Rank,  capi_alat_intent,alat_capi,capi_errmess);
    if (capi_alat_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        alat = (double *)(PyArray_DATA(capi_alat_as_array));

    /* Processing variable cryst_to_cartf2pywrap */
    cryst_to_cartf2pywrap_Dims[0]=3;
    capi_cryst_to_cartf2pywrap_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_centering.cryst_to_cart: failed to create array from the hidden `cryst_to_cartf2pywrap`";
    capi_cryst_to_cartf2pywrap_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,cryst_to_cartf2pywrap_Dims,cryst_to_cartf2pywrap_Rank,  capi_cryst_to_cartf2pywrap_intent,Py_None,capi_errmess);
    if (capi_cryst_to_cartf2pywrap_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        cryst_to_cartf2pywrap = (double *)(PyArray_DATA(capi_cryst_to_cartf2pywrap_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(cryst_to_cartf2pywrap,v,alat);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_cryst_to_cartf2pywrap_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_cryst_to_cartf2pywrap_as_array == NULL) ... else of cryst_to_cartf2pywrap */
    /* End of cleaning variable cryst_to_cartf2pywrap */
    if((PyObject *)capi_alat_as_array!=alat_capi) {
        Py_XDECREF(capi_alat_as_array); }
    }  /* if (capi_alat_as_array == NULL) ... else of alat */
    /* End of cleaning variable alat */
    if((PyObject *)capi_v_as_array!=v_capi) {
        Py_XDECREF(capi_v_as_array); }
    }  /* if (capi_v_as_array == NULL) ... else of v */
    /* End of cleaning variable v */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************************** end of cryst_to_cart ****************************/

/******************************** interpol_v2 ********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_interpol_v2[] = "\
fc_interp = interpol_v2(fc,r2,r3,pos,q2,q3,[n_blocks,nat])\n\nWrapper for ``interpol_v2``.\
\n\nParameters\n----------\n"
"fc : input rank-4 array('d') with bounds (n_blocks,3 * nat,3 * nat,3 * nat)\n"
"r2 : input rank-2 array('d') with bounds (3,n_blocks)\n"
"r3 : input rank-2 array('d') with bounds (3,n_blocks)\n"
"pos : input rank-2 array('d') with bounds (3,nat)\n"
"q2 : input rank-1 array('d') with bounds (3)\n"
"q3 : input rank-1 array('d') with bounds (3)\n"
"\nOther Parameters\n----------------\n"
"n_blocks : input int, optional\n    Default: shape(fc, 0)\n"
"nat : input int, optional\n    Default: shape(fc, 1) / 3\n"
"\nReturns\n-------\n"
"fc_interp : rank-3 array('D') with bounds (3 * nat,3 * nat,3 * nat)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_interpol_v2(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,double*,double*,complex_double*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *fc = NULL;
    npy_intp fc_Dims[4] = {-1, -1, -1, -1};
    const int fc_Rank = 4;
    PyArrayObject *capi_fc_as_array = NULL;
    int capi_fc_intent = 0;
    PyObject *fc_capi = Py_None;
    double *r2 = NULL;
    npy_intp r2_Dims[2] = {-1, -1};
    const int r2_Rank = 2;
    PyArrayObject *capi_r2_as_array = NULL;
    int capi_r2_intent = 0;
    PyObject *r2_capi = Py_None;
    double *r3 = NULL;
    npy_intp r3_Dims[2] = {-1, -1};
    const int r3_Rank = 2;
    PyArrayObject *capi_r3_as_array = NULL;
    int capi_r3_intent = 0;
    PyObject *r3_capi = Py_None;
    double *pos = NULL;
    npy_intp pos_Dims[2] = {-1, -1};
    const int pos_Rank = 2;
    PyArrayObject *capi_pos_as_array = NULL;
    int capi_pos_intent = 0;
    PyObject *pos_capi = Py_None;
    double *q2 = NULL;
    npy_intp q2_Dims[1] = {-1};
    const int q2_Rank = 1;
    PyArrayObject *capi_q2_as_array = NULL;
    int capi_q2_intent = 0;
    PyObject *q2_capi = Py_None;
    double *q3 = NULL;
    npy_intp q3_Dims[1] = {-1};
    const int q3_Rank = 1;
    PyArrayObject *capi_q3_as_array = NULL;
    int capi_q3_intent = 0;
    PyObject *q3_capi = Py_None;
    complex_double *fc_interp = NULL;
    npy_intp fc_interp_Dims[3] = {-1, -1, -1};
    const int fc_interp_Rank = 3;
    PyArrayObject *capi_fc_interp_as_array = NULL;
    int capi_fc_interp_intent = 0;
    int n_blocks = 0;
    PyObject *n_blocks_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    static char *capi_kwlist[] = {"fc","r2","r3","pos","q2","q3","n_blocks","nat",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOO|OO:thermal_conductivity.third_order_cond.interpol_v2",\
        capi_kwlist,&fc_capi,&r2_capi,&r3_capi,&pos_capi,&q2_capi,&q3_capi,&n_blocks_capi,&nat_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable fc */
    ;
    capi_fc_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v2: failed to create array from the 1st argument `fc`";
    capi_fc_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc_Dims,fc_Rank,  capi_fc_intent,fc_capi,capi_errmess);
    if (capi_fc_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc = (double *)(PyArray_DATA(capi_fc_as_array));

    /* Processing variable q2 */
    q2_Dims[0]=3;
    capi_q2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v2: failed to create array from the 5th argument `q2`";
    capi_q2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,q2_Dims,q2_Rank,  capi_q2_intent,q2_capi,capi_errmess);
    if (capi_q2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        q2 = (double *)(PyArray_DATA(capi_q2_as_array));

    /* Processing variable q3 */
    q3_Dims[0]=3;
    capi_q3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v2: failed to create array from the 6th argument `q3`";
    capi_q3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,q3_Dims,q3_Rank,  capi_q3_intent,q3_capi,capi_errmess);
    if (capi_q3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        q3 = (double *)(PyArray_DATA(capi_q3_as_array));

    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(fc, 1) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.third_order_cond.interpol_v2() 2nd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc, 1) == 3 * nat,"shape(fc, 1) == 3 * nat","2nd keyword nat","interpol_v2:nat=%d",nat) {
    /* Processing variable n_blocks */
    if (n_blocks_capi == Py_None) n_blocks = shape(fc, 0); else
        f2py_success = int_from_pyobj(&n_blocks,n_blocks_capi,"thermal_conductivity.third_order_cond.interpol_v2() 1st keyword (n_blocks) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc, 0) == n_blocks,"shape(fc, 0) == n_blocks","1st keyword n_blocks","interpol_v2:n_blocks=%d",n_blocks) {
    /* Processing variable r2 */
    r2_Dims[0]=3,r2_Dims[1]=n_blocks;
    capi_r2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v2: failed to create array from the 2nd argument `r2`";
    capi_r2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_Dims,r2_Rank,  capi_r2_intent,r2_capi,capi_errmess);
    if (capi_r2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2 = (double *)(PyArray_DATA(capi_r2_as_array));

    /* Processing variable r3 */
    r3_Dims[0]=3,r3_Dims[1]=n_blocks;
    capi_r3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v2: failed to create array from the 3rd argument `r3`";
    capi_r3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_Dims,r3_Rank,  capi_r3_intent,r3_capi,capi_errmess);
    if (capi_r3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3 = (double *)(PyArray_DATA(capi_r3_as_array));

    /* Processing variable pos */
    pos_Dims[0]=3,pos_Dims[1]=nat;
    capi_pos_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v2: failed to create array from the 4th argument `pos`";
    capi_pos_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,pos_Dims,pos_Rank,  capi_pos_intent,pos_capi,capi_errmess);
    if (capi_pos_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pos = (double *)(PyArray_DATA(capi_pos_as_array));

    /* Processing variable fc_interp */
    fc_interp_Dims[0]=3 * nat,fc_interp_Dims[1]=3 * nat,fc_interp_Dims[2]=3 * nat;
    capi_fc_interp_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v2: failed to create array from the hidden `fc_interp`";
    capi_fc_interp_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,fc_interp_Dims,fc_interp_Rank,  capi_fc_interp_intent,Py_None,capi_errmess);
    if (capi_fc_interp_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc_interp = (complex_double *)(PyArray_DATA(capi_fc_interp_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(fc,r2,r3,pos,q2,q3,fc_interp,&n_blocks,&nat);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_fc_interp_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_fc_interp_as_array == NULL) ... else of fc_interp */
    /* End of cleaning variable fc_interp */
    if((PyObject *)capi_pos_as_array!=pos_capi) {
        Py_XDECREF(capi_pos_as_array); }
    }  /* if (capi_pos_as_array == NULL) ... else of pos */
    /* End of cleaning variable pos */
    if((PyObject *)capi_r3_as_array!=r3_capi) {
        Py_XDECREF(capi_r3_as_array); }
    }  /* if (capi_r3_as_array == NULL) ... else of r3 */
    /* End of cleaning variable r3 */
    if((PyObject *)capi_r2_as_array!=r2_capi) {
        Py_XDECREF(capi_r2_as_array); }
    }  /* if (capi_r2_as_array == NULL) ... else of r2 */
    /* End of cleaning variable r2 */
    } /*CHECKSCALAR(shape(fc, 0) == n_blocks)*/
    } /*if (f2py_success) of n_blocks*/
    /* End of cleaning variable n_blocks */
    } /*CHECKSCALAR(shape(fc, 1) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    if((PyObject *)capi_q3_as_array!=q3_capi) {
        Py_XDECREF(capi_q3_as_array); }
    }  /* if (capi_q3_as_array == NULL) ... else of q3 */
    /* End of cleaning variable q3 */
    if((PyObject *)capi_q2_as_array!=q2_capi) {
        Py_XDECREF(capi_q2_as_array); }
    }  /* if (capi_q2_as_array == NULL) ... else of q2 */
    /* End of cleaning variable q2 */
    if((PyObject *)capi_fc_as_array!=fc_capi) {
        Py_XDECREF(capi_fc_as_array); }
    }  /* if (capi_fc_as_array == NULL) ... else of fc */
    /* End of cleaning variable fc */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of interpol_v2 *****************************/

/******************************** interpol_v3 ********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_interpol_v3[] = "\
fc_interp = interpol_v3(fc,pos,r2,r3,q1,q2,q3,[n_blocks,nat])\n\nWrapper for ``interpol_v3``.\
\n\nParameters\n----------\n"
"fc : input rank-4 array('d') with bounds (n_blocks,3 * nat,3 * nat,3 * nat)\n"
"pos : input rank-2 array('d') with bounds (3,nat)\n"
"r2 : input rank-2 array('d') with bounds (3,n_blocks)\n"
"r3 : input rank-2 array('d') with bounds (3,n_blocks)\n"
"q1 : input rank-1 array('d') with bounds (3)\n"
"q2 : input rank-1 array('d') with bounds (3)\n"
"q3 : input rank-1 array('d') with bounds (3)\n"
"\nOther Parameters\n----------------\n"
"n_blocks : input int, optional\n    Default: shape(fc, 0)\n"
"nat : input int, optional\n    Default: shape(fc, 1) / 3\n"
"\nReturns\n-------\n"
"fc_interp : rank-3 array('D') with bounds (3 * nat,3 * nat,3 * nat)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_interpol_v3(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,double*,double*,double*,complex_double*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *fc = NULL;
    npy_intp fc_Dims[4] = {-1, -1, -1, -1};
    const int fc_Rank = 4;
    PyArrayObject *capi_fc_as_array = NULL;
    int capi_fc_intent = 0;
    PyObject *fc_capi = Py_None;
    double *pos = NULL;
    npy_intp pos_Dims[2] = {-1, -1};
    const int pos_Rank = 2;
    PyArrayObject *capi_pos_as_array = NULL;
    int capi_pos_intent = 0;
    PyObject *pos_capi = Py_None;
    double *r2 = NULL;
    npy_intp r2_Dims[2] = {-1, -1};
    const int r2_Rank = 2;
    PyArrayObject *capi_r2_as_array = NULL;
    int capi_r2_intent = 0;
    PyObject *r2_capi = Py_None;
    double *r3 = NULL;
    npy_intp r3_Dims[2] = {-1, -1};
    const int r3_Rank = 2;
    PyArrayObject *capi_r3_as_array = NULL;
    int capi_r3_intent = 0;
    PyObject *r3_capi = Py_None;
    double *q1 = NULL;
    npy_intp q1_Dims[1] = {-1};
    const int q1_Rank = 1;
    PyArrayObject *capi_q1_as_array = NULL;
    int capi_q1_intent = 0;
    PyObject *q1_capi = Py_None;
    double *q2 = NULL;
    npy_intp q2_Dims[1] = {-1};
    const int q2_Rank = 1;
    PyArrayObject *capi_q2_as_array = NULL;
    int capi_q2_intent = 0;
    PyObject *q2_capi = Py_None;
    double *q3 = NULL;
    npy_intp q3_Dims[1] = {-1};
    const int q3_Rank = 1;
    PyArrayObject *capi_q3_as_array = NULL;
    int capi_q3_intent = 0;
    PyObject *q3_capi = Py_None;
    complex_double *fc_interp = NULL;
    npy_intp fc_interp_Dims[3] = {-1, -1, -1};
    const int fc_interp_Rank = 3;
    PyArrayObject *capi_fc_interp_as_array = NULL;
    int capi_fc_interp_intent = 0;
    int n_blocks = 0;
    PyObject *n_blocks_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    static char *capi_kwlist[] = {"fc","pos","r2","r3","q1","q2","q3","n_blocks","nat",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOO|OO:thermal_conductivity.third_order_cond.interpol_v3",\
        capi_kwlist,&fc_capi,&pos_capi,&r2_capi,&r3_capi,&q1_capi,&q2_capi,&q3_capi,&n_blocks_capi,&nat_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable fc */
    ;
    capi_fc_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v3: failed to create array from the 1st argument `fc`";
    capi_fc_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,fc_Dims,fc_Rank,  capi_fc_intent,fc_capi,capi_errmess);
    if (capi_fc_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc = (double *)(PyArray_DATA(capi_fc_as_array));

    /* Processing variable q2 */
    q2_Dims[0]=3;
    capi_q2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v3: failed to create array from the 6th argument `q2`";
    capi_q2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,q2_Dims,q2_Rank,  capi_q2_intent,q2_capi,capi_errmess);
    if (capi_q2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        q2 = (double *)(PyArray_DATA(capi_q2_as_array));

    /* Processing variable q3 */
    q3_Dims[0]=3;
    capi_q3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v3: failed to create array from the 7th argument `q3`";
    capi_q3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,q3_Dims,q3_Rank,  capi_q3_intent,q3_capi,capi_errmess);
    if (capi_q3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        q3 = (double *)(PyArray_DATA(capi_q3_as_array));

    /* Processing variable q1 */
    q1_Dims[0]=3;
    capi_q1_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v3: failed to create array from the 5th argument `q1`";
    capi_q1_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,q1_Dims,q1_Rank,  capi_q1_intent,q1_capi,capi_errmess);
    if (capi_q1_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        q1 = (double *)(PyArray_DATA(capi_q1_as_array));

    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(fc, 1) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.third_order_cond.interpol_v3() 2nd keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc, 1) == 3 * nat,"shape(fc, 1) == 3 * nat","2nd keyword nat","interpol_v3:nat=%d",nat) {
    /* Processing variable n_blocks */
    if (n_blocks_capi == Py_None) n_blocks = shape(fc, 0); else
        f2py_success = int_from_pyobj(&n_blocks,n_blocks_capi,"thermal_conductivity.third_order_cond.interpol_v3() 1st keyword (n_blocks) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(fc, 0) == n_blocks,"shape(fc, 0) == n_blocks","1st keyword n_blocks","interpol_v3:n_blocks=%d",n_blocks) {
    /* Processing variable r2 */
    r2_Dims[0]=3,r2_Dims[1]=n_blocks;
    capi_r2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v3: failed to create array from the 3rd argument `r2`";
    capi_r2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r2_Dims,r2_Rank,  capi_r2_intent,r2_capi,capi_errmess);
    if (capi_r2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r2 = (double *)(PyArray_DATA(capi_r2_as_array));

    /* Processing variable r3 */
    r3_Dims[0]=3,r3_Dims[1]=n_blocks;
    capi_r3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v3: failed to create array from the 4th argument `r3`";
    capi_r3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,r3_Dims,r3_Rank,  capi_r3_intent,r3_capi,capi_errmess);
    if (capi_r3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        r3 = (double *)(PyArray_DATA(capi_r3_as_array));

    /* Processing variable pos */
    pos_Dims[0]=3,pos_Dims[1]=nat;
    capi_pos_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v3: failed to create array from the 2nd argument `pos`";
    capi_pos_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,pos_Dims,pos_Rank,  capi_pos_intent,pos_capi,capi_errmess);
    if (capi_pos_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pos = (double *)(PyArray_DATA(capi_pos_as_array));

    /* Processing variable fc_interp */
    fc_interp_Dims[0]=3 * nat,fc_interp_Dims[1]=3 * nat,fc_interp_Dims[2]=3 * nat;
    capi_fc_interp_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.interpol_v3: failed to create array from the hidden `fc_interp`";
    capi_fc_interp_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,fc_interp_Dims,fc_interp_Rank,  capi_fc_interp_intent,Py_None,capi_errmess);
    if (capi_fc_interp_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        fc_interp = (complex_double *)(PyArray_DATA(capi_fc_interp_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(fc,pos,r2,r3,q1,q2,q3,fc_interp,&n_blocks,&nat);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_fc_interp_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_fc_interp_as_array == NULL) ... else of fc_interp */
    /* End of cleaning variable fc_interp */
    if((PyObject *)capi_pos_as_array!=pos_capi) {
        Py_XDECREF(capi_pos_as_array); }
    }  /* if (capi_pos_as_array == NULL) ... else of pos */
    /* End of cleaning variable pos */
    if((PyObject *)capi_r3_as_array!=r3_capi) {
        Py_XDECREF(capi_r3_as_array); }
    }  /* if (capi_r3_as_array == NULL) ... else of r3 */
    /* End of cleaning variable r3 */
    if((PyObject *)capi_r2_as_array!=r2_capi) {
        Py_XDECREF(capi_r2_as_array); }
    }  /* if (capi_r2_as_array == NULL) ... else of r2 */
    /* End of cleaning variable r2 */
    } /*CHECKSCALAR(shape(fc, 0) == n_blocks)*/
    } /*if (f2py_success) of n_blocks*/
    /* End of cleaning variable n_blocks */
    } /*CHECKSCALAR(shape(fc, 1) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    if((PyObject *)capi_q1_as_array!=q1_capi) {
        Py_XDECREF(capi_q1_as_array); }
    }  /* if (capi_q1_as_array == NULL) ... else of q1 */
    /* End of cleaning variable q1 */
    if((PyObject *)capi_q3_as_array!=q3_capi) {
        Py_XDECREF(capi_q3_as_array); }
    }  /* if (capi_q3_as_array == NULL) ... else of q3 */
    /* End of cleaning variable q3 */
    if((PyObject *)capi_q2_as_array!=q2_capi) {
        Py_XDECREF(capi_q2_as_array); }
    }  /* if (capi_q2_as_array == NULL) ... else of q2 */
    /* End of cleaning variable q2 */
    if((PyObject *)capi_fc_as_array!=fc_capi) {
        Py_XDECREF(capi_fc_as_array); }
    }  /* if (capi_fc_as_array == NULL) ... else of fc */
    /* End of cleaning variable fc */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************************** end of interpol_v3 *****************************/

/********************* compute_full_dynamic_bubble_single *********************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_compute_full_dynamic_bubble_single[] = "\
bubble = compute_full_dynamic_bubble_single(energies,sigma,t,freq,is_gamma,d3,gaussian,classical,[ne,n_mod])\n\nWrapper for ``compute_full_dynamic_bubble_single``.\
\n\nParameters\n----------\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"sigma : input rank-1 array('d') with bounds (n_mod)\n"
"t : input float\n"
"freq : input rank-2 array('d') with bounds (n_mod,3)\n"
"is_gamma : input rank-1 array('i') with bounds (3)\n"
"d3 : input rank-3 array('D') with bounds (n_mod,n_mod,n_mod)\n"
"gaussian : input int\n"
"classical : input int\n"
"\nOther Parameters\n----------------\n"
"ne : input int, optional\n    Default: shape(energies, 0)\n"
"n_mod : input int, optional\n    Default: shape(sigma, 0)\n"
"\nReturns\n-------\n"
"bubble : rank-3 array('D') with bounds (ne,n_mod,n_mod)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_compute_full_dynamic_bubble_single(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,complex_double*,int*,int*,int*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    double *sigma = NULL;
    npy_intp sigma_Dims[1] = {-1};
    const int sigma_Rank = 1;
    PyArrayObject *capi_sigma_as_array = NULL;
    int capi_sigma_intent = 0;
    PyObject *sigma_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *freq = NULL;
    npy_intp freq_Dims[2] = {-1, -1};
    const int freq_Rank = 2;
    PyArrayObject *capi_freq_as_array = NULL;
    int capi_freq_intent = 0;
    PyObject *freq_capi = Py_None;
    int *is_gamma = NULL;
    npy_intp is_gamma_Dims[1] = {-1};
    const int is_gamma_Rank = 1;
    PyArrayObject *capi_is_gamma_as_array = NULL;
    int capi_is_gamma_intent = 0;
    PyObject *is_gamma_capi = Py_None;
    complex_double *d3 = NULL;
    npy_intp d3_Dims[3] = {-1, -1, -1};
    const int d3_Rank = 3;
    PyArrayObject *capi_d3_as_array = NULL;
    int capi_d3_intent = 0;
    PyObject *d3_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    int n_mod = 0;
    PyObject *n_mod_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    int classical = 0;
    PyObject *classical_capi = Py_None;
    complex_double *bubble = NULL;
    npy_intp bubble_Dims[3] = {-1, -1, -1};
    const int bubble_Rank = 3;
    PyArrayObject *capi_bubble_as_array = NULL;
    int capi_bubble_intent = 0;
    static char *capi_kwlist[] = {"energies","sigma","t","freq","is_gamma","d3","gaussian","classical","ne","n_mod",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOO|OO:thermal_conductivity.third_order_cond.compute_full_dynamic_bubble_single",\
        capi_kwlist,&energies_capi,&sigma_capi,&t_capi,&freq_capi,&is_gamma_capi,&d3_capi,&gaussian_capi,&classical_capi,&ne_capi,&n_mod_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable energies */
    ;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_full_dynamic_bubble_single: failed to create array from the 1st argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

    /* Processing variable sigma */
    ;
    capi_sigma_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_full_dynamic_bubble_single: failed to create array from the 2nd argument `sigma`";
    capi_sigma_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,sigma_Dims,sigma_Rank,  capi_sigma_intent,sigma_capi,capi_errmess);
    if (capi_sigma_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        sigma = (double *)(PyArray_DATA(capi_sigma_as_array));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.third_order_cond.compute_full_dynamic_bubble_single() 3rd argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable is_gamma */
    is_gamma_Dims[0]=3;
    capi_is_gamma_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_full_dynamic_bubble_single: failed to create array from the 5th argument `is_gamma`";
    capi_is_gamma_as_array = ndarray_from_pyobj(  NPY_INT,1,is_gamma_Dims,is_gamma_Rank,  capi_is_gamma_intent,is_gamma_capi,capi_errmess);
    if (capi_is_gamma_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        is_gamma = (int *)(PyArray_DATA(capi_is_gamma_as_array));

    /* Processing variable classical */
        classical = (int)PyObject_IsTrue(classical_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(energies, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.third_order_cond.compute_full_dynamic_bubble_single() 1st keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(energies, 0) == ne,"shape(energies, 0) == ne","1st keyword ne","compute_full_dynamic_bubble_single:ne=%d",ne) {
    /* Processing variable n_mod */
    if (n_mod_capi == Py_None) n_mod = shape(sigma, 0); else
        f2py_success = int_from_pyobj(&n_mod,n_mod_capi,"thermal_conductivity.third_order_cond.compute_full_dynamic_bubble_single() 2nd keyword (n_mod) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(sigma, 0) == n_mod,"shape(sigma, 0) == n_mod","2nd keyword n_mod","compute_full_dynamic_bubble_single:n_mod=%d",n_mod) {
    /* Processing variable bubble */
    bubble_Dims[0]=ne,bubble_Dims[1]=n_mod,bubble_Dims[2]=n_mod;
    capi_bubble_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_full_dynamic_bubble_single: failed to create array from the hidden `bubble`";
    capi_bubble_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,bubble_Dims,bubble_Rank,  capi_bubble_intent,Py_None,capi_errmess);
    if (capi_bubble_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        bubble = (complex_double *)(PyArray_DATA(capi_bubble_as_array));

    /* Processing variable freq */
    freq_Dims[0]=n_mod,freq_Dims[1]=3;
    capi_freq_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_full_dynamic_bubble_single: failed to create array from the 4th argument `freq`";
    capi_freq_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,freq_Dims,freq_Rank,  capi_freq_intent,freq_capi,capi_errmess);
    if (capi_freq_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        freq = (double *)(PyArray_DATA(capi_freq_as_array));

    /* Processing variable d3 */
    d3_Dims[0]=n_mod,d3_Dims[1]=n_mod,d3_Dims[2]=n_mod;
    capi_d3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_full_dynamic_bubble_single: failed to create array from the 6th argument `d3`";
    capi_d3_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,d3_Dims,d3_Rank,  capi_d3_intent,d3_capi,capi_errmess);
    if (capi_d3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        d3 = (complex_double *)(PyArray_DATA(capi_d3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(energies,sigma,&t,freq,is_gamma,d3,&ne,&n_mod,&gaussian,&classical,bubble);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_bubble_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_d3_as_array!=d3_capi) {
        Py_XDECREF(capi_d3_as_array); }
    }  /* if (capi_d3_as_array == NULL) ... else of d3 */
    /* End of cleaning variable d3 */
    if((PyObject *)capi_freq_as_array!=freq_capi) {
        Py_XDECREF(capi_freq_as_array); }
    }  /* if (capi_freq_as_array == NULL) ... else of freq */
    /* End of cleaning variable freq */
    }  /* if (capi_bubble_as_array == NULL) ... else of bubble */
    /* End of cleaning variable bubble */
    } /*CHECKSCALAR(shape(sigma, 0) == n_mod)*/
    } /*if (f2py_success) of n_mod*/
    /* End of cleaning variable n_mod */
    } /*CHECKSCALAR(shape(energies, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    } /*if (f2py_success) of classical*/
    /* End of cleaning variable classical */
    if((PyObject *)capi_is_gamma_as_array!=is_gamma_capi) {
        Py_XDECREF(capi_is_gamma_as_array); }
    }  /* if (capi_is_gamma_as_array == NULL) ... else of is_gamma */
    /* End of cleaning variable is_gamma */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_sigma_as_array!=sigma_capi) {
        Py_XDECREF(capi_sigma_as_array); }
    }  /* if (capi_sigma_as_array == NULL) ... else of sigma */
    /* End of cleaning variable sigma */
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************** end of compute_full_dynamic_bubble_single *****************/

/********************* compute_diag_dynamic_bubble_single *********************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_compute_diag_dynamic_bubble_single[] = "\
bubble = compute_diag_dynamic_bubble_single(energies,sigma,t,freq,is_gamma,d3,gaussian,classical,[ne,n_mod])\n\nWrapper for ``compute_diag_dynamic_bubble_single``.\
\n\nParameters\n----------\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"sigma : input rank-1 array('d') with bounds (n_mod)\n"
"t : input float\n"
"freq : input rank-2 array('d') with bounds (n_mod,3)\n"
"is_gamma : input rank-1 array('i') with bounds (3)\n"
"d3 : input rank-3 array('D') with bounds (n_mod,n_mod,n_mod)\n"
"gaussian : input int\n"
"classical : input int\n"
"\nOther Parameters\n----------------\n"
"ne : input int, optional\n    Default: shape(energies, 0)\n"
"n_mod : input int, optional\n    Default: shape(sigma, 0)\n"
"\nReturns\n-------\n"
"bubble : rank-2 array('D') with bounds (ne,n_mod)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_compute_diag_dynamic_bubble_single(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,double*,int*,complex_double*,int*,int*,int*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    double *sigma = NULL;
    npy_intp sigma_Dims[1] = {-1};
    const int sigma_Rank = 1;
    PyArrayObject *capi_sigma_as_array = NULL;
    int capi_sigma_intent = 0;
    PyObject *sigma_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *freq = NULL;
    npy_intp freq_Dims[2] = {-1, -1};
    const int freq_Rank = 2;
    PyArrayObject *capi_freq_as_array = NULL;
    int capi_freq_intent = 0;
    PyObject *freq_capi = Py_None;
    int *is_gamma = NULL;
    npy_intp is_gamma_Dims[1] = {-1};
    const int is_gamma_Rank = 1;
    PyArrayObject *capi_is_gamma_as_array = NULL;
    int capi_is_gamma_intent = 0;
    PyObject *is_gamma_capi = Py_None;
    complex_double *d3 = NULL;
    npy_intp d3_Dims[3] = {-1, -1, -1};
    const int d3_Rank = 3;
    PyArrayObject *capi_d3_as_array = NULL;
    int capi_d3_intent = 0;
    PyObject *d3_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    int n_mod = 0;
    PyObject *n_mod_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    int classical = 0;
    PyObject *classical_capi = Py_None;
    complex_double *bubble = NULL;
    npy_intp bubble_Dims[2] = {-1, -1};
    const int bubble_Rank = 2;
    PyArrayObject *capi_bubble_as_array = NULL;
    int capi_bubble_intent = 0;
    static char *capi_kwlist[] = {"energies","sigma","t","freq","is_gamma","d3","gaussian","classical","ne","n_mod",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOOO|OO:thermal_conductivity.third_order_cond.compute_diag_dynamic_bubble_single",\
        capi_kwlist,&energies_capi,&sigma_capi,&t_capi,&freq_capi,&is_gamma_capi,&d3_capi,&gaussian_capi,&classical_capi,&ne_capi,&n_mod_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable energies */
    ;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_diag_dynamic_bubble_single: failed to create array from the 1st argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

    /* Processing variable sigma */
    ;
    capi_sigma_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_diag_dynamic_bubble_single: failed to create array from the 2nd argument `sigma`";
    capi_sigma_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,sigma_Dims,sigma_Rank,  capi_sigma_intent,sigma_capi,capi_errmess);
    if (capi_sigma_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        sigma = (double *)(PyArray_DATA(capi_sigma_as_array));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.third_order_cond.compute_diag_dynamic_bubble_single() 3rd argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable is_gamma */
    is_gamma_Dims[0]=3;
    capi_is_gamma_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_diag_dynamic_bubble_single: failed to create array from the 5th argument `is_gamma`";
    capi_is_gamma_as_array = ndarray_from_pyobj(  NPY_INT,1,is_gamma_Dims,is_gamma_Rank,  capi_is_gamma_intent,is_gamma_capi,capi_errmess);
    if (capi_is_gamma_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        is_gamma = (int *)(PyArray_DATA(capi_is_gamma_as_array));

    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable classical */
        classical = (int)PyObject_IsTrue(classical_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable n_mod */
    if (n_mod_capi == Py_None) n_mod = shape(sigma, 0); else
        f2py_success = int_from_pyobj(&n_mod,n_mod_capi,"thermal_conductivity.third_order_cond.compute_diag_dynamic_bubble_single() 2nd keyword (n_mod) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(sigma, 0) == n_mod,"shape(sigma, 0) == n_mod","2nd keyword n_mod","compute_diag_dynamic_bubble_single:n_mod=%d",n_mod) {
    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(energies, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.third_order_cond.compute_diag_dynamic_bubble_single() 1st keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(energies, 0) == ne,"shape(energies, 0) == ne","1st keyword ne","compute_diag_dynamic_bubble_single:ne=%d",ne) {
    /* Processing variable bubble */
    bubble_Dims[0]=ne,bubble_Dims[1]=n_mod;
    capi_bubble_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_diag_dynamic_bubble_single: failed to create array from the hidden `bubble`";
    capi_bubble_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,bubble_Dims,bubble_Rank,  capi_bubble_intent,Py_None,capi_errmess);
    if (capi_bubble_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        bubble = (complex_double *)(PyArray_DATA(capi_bubble_as_array));

    /* Processing variable freq */
    freq_Dims[0]=n_mod,freq_Dims[1]=3;
    capi_freq_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_diag_dynamic_bubble_single: failed to create array from the 4th argument `freq`";
    capi_freq_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,freq_Dims,freq_Rank,  capi_freq_intent,freq_capi,capi_errmess);
    if (capi_freq_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        freq = (double *)(PyArray_DATA(capi_freq_as_array));

    /* Processing variable d3 */
    d3_Dims[0]=n_mod,d3_Dims[1]=n_mod,d3_Dims[2]=n_mod;
    capi_d3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_diag_dynamic_bubble_single: failed to create array from the 6th argument `d3`";
    capi_d3_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,d3_Dims,d3_Rank,  capi_d3_intent,d3_capi,capi_errmess);
    if (capi_d3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        d3 = (complex_double *)(PyArray_DATA(capi_d3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(energies,sigma,&t,freq,is_gamma,d3,&ne,&n_mod,&gaussian,&classical,bubble);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_bubble_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_d3_as_array!=d3_capi) {
        Py_XDECREF(capi_d3_as_array); }
    }  /* if (capi_d3_as_array == NULL) ... else of d3 */
    /* End of cleaning variable d3 */
    if((PyObject *)capi_freq_as_array!=freq_capi) {
        Py_XDECREF(capi_freq_as_array); }
    }  /* if (capi_freq_as_array == NULL) ... else of freq */
    /* End of cleaning variable freq */
    }  /* if (capi_bubble_as_array == NULL) ... else of bubble */
    /* End of cleaning variable bubble */
    } /*CHECKSCALAR(shape(energies, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    } /*CHECKSCALAR(shape(sigma, 0) == n_mod)*/
    } /*if (f2py_success) of n_mod*/
    /* End of cleaning variable n_mod */
    } /*if (f2py_success) of classical*/
    /* End of cleaning variable classical */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    if((PyObject *)capi_is_gamma_as_array!=is_gamma_capi) {
        Py_XDECREF(capi_is_gamma_as_array); }
    }  /* if (capi_is_gamma_as_array == NULL) ... else of is_gamma */
    /* End of cleaning variable is_gamma */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_sigma_as_array!=sigma_capi) {
        Py_XDECREF(capi_sigma_as_array); }
    }  /* if (capi_sigma_as_array == NULL) ... else of sigma */
    /* End of cleaning variable sigma */
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/***************** end of compute_diag_dynamic_bubble_single *****************/

/*********************** compute_perturb_selfnrg_single ***********************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_compute_perturb_selfnrg_single[] = "\
selfnrg = compute_perturb_selfnrg_single(sigma,t,freq,is_gamma,d3,gaussian,classical,[n_mod])\n\nWrapper for ``compute_perturb_selfnrg_single``.\
\n\nParameters\n----------\n"
"sigma : input rank-1 array('d') with bounds (n_mod)\n"
"t : input float\n"
"freq : input rank-2 array('d') with bounds (n_mod,3)\n"
"is_gamma : input rank-1 array('i') with bounds (3)\n"
"d3 : input rank-3 array('D') with bounds (n_mod,n_mod,n_mod)\n"
"gaussian : input int\n"
"classical : input int\n"
"\nOther Parameters\n----------------\n"
"n_mod : input int, optional\n    Default: shape(sigma, 0)\n"
"\nReturns\n-------\n"
"selfnrg : rank-1 array('D') with bounds (n_mod)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_compute_perturb_selfnrg_single(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,int*,complex_double*,int*,int*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *sigma = NULL;
    npy_intp sigma_Dims[1] = {-1};
    const int sigma_Rank = 1;
    PyArrayObject *capi_sigma_as_array = NULL;
    int capi_sigma_intent = 0;
    PyObject *sigma_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *freq = NULL;
    npy_intp freq_Dims[2] = {-1, -1};
    const int freq_Rank = 2;
    PyArrayObject *capi_freq_as_array = NULL;
    int capi_freq_intent = 0;
    PyObject *freq_capi = Py_None;
    int *is_gamma = NULL;
    npy_intp is_gamma_Dims[1] = {-1};
    const int is_gamma_Rank = 1;
    PyArrayObject *capi_is_gamma_as_array = NULL;
    int capi_is_gamma_intent = 0;
    PyObject *is_gamma_capi = Py_None;
    complex_double *d3 = NULL;
    npy_intp d3_Dims[3] = {-1, -1, -1};
    const int d3_Rank = 3;
    PyArrayObject *capi_d3_as_array = NULL;
    int capi_d3_intent = 0;
    PyObject *d3_capi = Py_None;
    int n_mod = 0;
    PyObject *n_mod_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    int classical = 0;
    PyObject *classical_capi = Py_None;
    complex_double *selfnrg = NULL;
    npy_intp selfnrg_Dims[1] = {-1};
    const int selfnrg_Rank = 1;
    PyArrayObject *capi_selfnrg_as_array = NULL;
    int capi_selfnrg_intent = 0;
    static char *capi_kwlist[] = {"sigma","t","freq","is_gamma","d3","gaussian","classical","n_mod",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOO|O:thermal_conductivity.third_order_cond.compute_perturb_selfnrg_single",\
        capi_kwlist,&sigma_capi,&t_capi,&freq_capi,&is_gamma_capi,&d3_capi,&gaussian_capi,&classical_capi,&n_mod_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable sigma */
    ;
    capi_sigma_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_perturb_selfnrg_single: failed to create array from the 1st argument `sigma`";
    capi_sigma_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,sigma_Dims,sigma_Rank,  capi_sigma_intent,sigma_capi,capi_errmess);
    if (capi_sigma_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        sigma = (double *)(PyArray_DATA(capi_sigma_as_array));

    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.third_order_cond.compute_perturb_selfnrg_single() 2nd argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable is_gamma */
    is_gamma_Dims[0]=3;
    capi_is_gamma_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_perturb_selfnrg_single: failed to create array from the 4th argument `is_gamma`";
    capi_is_gamma_as_array = ndarray_from_pyobj(  NPY_INT,1,is_gamma_Dims,is_gamma_Rank,  capi_is_gamma_intent,is_gamma_capi,capi_errmess);
    if (capi_is_gamma_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        is_gamma = (int *)(PyArray_DATA(capi_is_gamma_as_array));

    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable classical */
        classical = (int)PyObject_IsTrue(classical_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable n_mod */
    if (n_mod_capi == Py_None) n_mod = shape(sigma, 0); else
        f2py_success = int_from_pyobj(&n_mod,n_mod_capi,"thermal_conductivity.third_order_cond.compute_perturb_selfnrg_single() 1st keyword (n_mod) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(sigma, 0) == n_mod,"shape(sigma, 0) == n_mod","1st keyword n_mod","compute_perturb_selfnrg_single:n_mod=%d",n_mod) {
    /* Processing variable selfnrg */
    selfnrg_Dims[0]=n_mod;
    capi_selfnrg_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_perturb_selfnrg_single: failed to create array from the hidden `selfnrg`";
    capi_selfnrg_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,selfnrg_Dims,selfnrg_Rank,  capi_selfnrg_intent,Py_None,capi_errmess);
    if (capi_selfnrg_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        selfnrg = (complex_double *)(PyArray_DATA(capi_selfnrg_as_array));

    /* Processing variable freq */
    freq_Dims[0]=n_mod,freq_Dims[1]=3;
    capi_freq_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_perturb_selfnrg_single: failed to create array from the 3rd argument `freq`";
    capi_freq_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,freq_Dims,freq_Rank,  capi_freq_intent,freq_capi,capi_errmess);
    if (capi_freq_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        freq = (double *)(PyArray_DATA(capi_freq_as_array));

    /* Processing variable d3 */
    d3_Dims[0]=n_mod,d3_Dims[1]=n_mod,d3_Dims[2]=n_mod;
    capi_d3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_perturb_selfnrg_single: failed to create array from the 5th argument `d3`";
    capi_d3_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,d3_Dims,d3_Rank,  capi_d3_intent,d3_capi,capi_errmess);
    if (capi_d3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        d3 = (complex_double *)(PyArray_DATA(capi_d3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(sigma,&t,freq,is_gamma,d3,&n_mod,&gaussian,&classical,selfnrg);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_selfnrg_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_d3_as_array!=d3_capi) {
        Py_XDECREF(capi_d3_as_array); }
    }  /* if (capi_d3_as_array == NULL) ... else of d3 */
    /* End of cleaning variable d3 */
    if((PyObject *)capi_freq_as_array!=freq_capi) {
        Py_XDECREF(capi_freq_as_array); }
    }  /* if (capi_freq_as_array == NULL) ... else of freq */
    /* End of cleaning variable freq */
    }  /* if (capi_selfnrg_as_array == NULL) ... else of selfnrg */
    /* End of cleaning variable selfnrg */
    } /*CHECKSCALAR(shape(sigma, 0) == n_mod)*/
    } /*if (f2py_success) of n_mod*/
    /* End of cleaning variable n_mod */
    } /*if (f2py_success) of classical*/
    /* End of cleaning variable classical */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    if((PyObject *)capi_is_gamma_as_array!=is_gamma_capi) {
        Py_XDECREF(capi_is_gamma_as_array); }
    }  /* if (capi_is_gamma_as_array == NULL) ... else of is_gamma */
    /* End of cleaning variable is_gamma */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    if((PyObject *)capi_sigma_as_array!=sigma_capi) {
        Py_XDECREF(capi_sigma_as_array); }
    }  /* if (capi_sigma_as_array == NULL) ... else of sigma */
    /* End of cleaning variable sigma */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************* end of compute_perturb_selfnrg_single *******************/

/*********************** compute_spectralf_diag_single ***********************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_compute_spectralf_diag_single[] = "\
spectralf = compute_spectralf_diag_single(sigma,ener,d2_freq,selfnrg,[nat,ne])\n\nWrapper for ``compute_spectralf_diag_single``.\
\n\nParameters\n----------\n"
"sigma : input rank-1 array('d') with bounds (3 * nat)\n"
"ener : input rank-1 array('d') with bounds (ne)\n"
"d2_freq : input rank-1 array('d') with bounds (3 * nat)\n"
"selfnrg : input rank-2 array('D') with bounds (ne,3 * nat)\n"
"\nOther Parameters\n----------------\n"
"nat : input int, optional\n    Default: shape(sigma, 0) / 3\n"
"ne : input int, optional\n    Default: shape(ener, 0)\n"
"\nReturns\n-------\n"
"spectralf : rank-2 array('d') with bounds (ne,3 * nat)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_compute_spectralf_diag_single(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,complex_double*,int*,int*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *sigma = NULL;
    npy_intp sigma_Dims[1] = {-1};
    const int sigma_Rank = 1;
    PyArrayObject *capi_sigma_as_array = NULL;
    int capi_sigma_intent = 0;
    PyObject *sigma_capi = Py_None;
    double *ener = NULL;
    npy_intp ener_Dims[1] = {-1};
    const int ener_Rank = 1;
    PyArrayObject *capi_ener_as_array = NULL;
    int capi_ener_intent = 0;
    PyObject *ener_capi = Py_None;
    double *d2_freq = NULL;
    npy_intp d2_freq_Dims[1] = {-1};
    const int d2_freq_Rank = 1;
    PyArrayObject *capi_d2_freq_as_array = NULL;
    int capi_d2_freq_intent = 0;
    PyObject *d2_freq_capi = Py_None;
    complex_double *selfnrg = NULL;
    npy_intp selfnrg_Dims[2] = {-1, -1};
    const int selfnrg_Rank = 2;
    PyArrayObject *capi_selfnrg_as_array = NULL;
    int capi_selfnrg_intent = 0;
    PyObject *selfnrg_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    double *spectralf = NULL;
    npy_intp spectralf_Dims[2] = {-1, -1};
    const int spectralf_Rank = 2;
    PyArrayObject *capi_spectralf_as_array = NULL;
    int capi_spectralf_intent = 0;
    static char *capi_kwlist[] = {"sigma","ener","d2_freq","selfnrg","nat","ne",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOO|OO:thermal_conductivity.third_order_cond.compute_spectralf_diag_single",\
        capi_kwlist,&sigma_capi,&ener_capi,&d2_freq_capi,&selfnrg_capi,&nat_capi,&ne_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable ener */
    ;
    capi_ener_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_spectralf_diag_single: failed to create array from the 2nd argument `ener`";
    capi_ener_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,ener_Dims,ener_Rank,  capi_ener_intent,ener_capi,capi_errmess);
    if (capi_ener_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        ener = (double *)(PyArray_DATA(capi_ener_as_array));

    /* Processing variable sigma */
    ;
    capi_sigma_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_spectralf_diag_single: failed to create array from the 1st argument `sigma`";
    capi_sigma_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,sigma_Dims,sigma_Rank,  capi_sigma_intent,sigma_capi,capi_errmess);
    if (capi_sigma_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        sigma = (double *)(PyArray_DATA(capi_sigma_as_array));

    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(ener, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.third_order_cond.compute_spectralf_diag_single() 2nd keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(ener, 0) == ne,"shape(ener, 0) == ne","2nd keyword ne","compute_spectralf_diag_single:ne=%d",ne) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(sigma, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.third_order_cond.compute_spectralf_diag_single() 1st keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(sigma, 0) == 3 * nat,"shape(sigma, 0) == 3 * nat","1st keyword nat","compute_spectralf_diag_single:nat=%d",nat) {
    /* Processing variable d2_freq */
    d2_freq_Dims[0]=3 * nat;
    capi_d2_freq_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_spectralf_diag_single: failed to create array from the 3rd argument `d2_freq`";
    capi_d2_freq_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,d2_freq_Dims,d2_freq_Rank,  capi_d2_freq_intent,d2_freq_capi,capi_errmess);
    if (capi_d2_freq_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        d2_freq = (double *)(PyArray_DATA(capi_d2_freq_as_array));

    /* Processing variable selfnrg */
    selfnrg_Dims[0]=ne,selfnrg_Dims[1]=3 * nat;
    capi_selfnrg_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_spectralf_diag_single: failed to create array from the 4th argument `selfnrg`";
    capi_selfnrg_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,selfnrg_Dims,selfnrg_Rank,  capi_selfnrg_intent,selfnrg_capi,capi_errmess);
    if (capi_selfnrg_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        selfnrg = (complex_double *)(PyArray_DATA(capi_selfnrg_as_array));

    /* Processing variable spectralf */
    spectralf_Dims[0]=ne,spectralf_Dims[1]=3 * nat;
    capi_spectralf_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.compute_spectralf_diag_single: failed to create array from the hidden `spectralf`";
    capi_spectralf_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,spectralf_Dims,spectralf_Rank,  capi_spectralf_intent,Py_None,capi_errmess);
    if (capi_spectralf_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        spectralf = (double *)(PyArray_DATA(capi_spectralf_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(sigma,ener,d2_freq,selfnrg,&nat,&ne,spectralf);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_spectralf_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_spectralf_as_array == NULL) ... else of spectralf */
    /* End of cleaning variable spectralf */
    if((PyObject *)capi_selfnrg_as_array!=selfnrg_capi) {
        Py_XDECREF(capi_selfnrg_as_array); }
    }  /* if (capi_selfnrg_as_array == NULL) ... else of selfnrg */
    /* End of cleaning variable selfnrg */
    if((PyObject *)capi_d2_freq_as_array!=d2_freq_capi) {
        Py_XDECREF(capi_d2_freq_as_array); }
    }  /* if (capi_d2_freq_as_array == NULL) ... else of d2_freq */
    /* End of cleaning variable d2_freq */
    } /*CHECKSCALAR(shape(sigma, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(ener, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    if((PyObject *)capi_sigma_as_array!=sigma_capi) {
        Py_XDECREF(capi_sigma_as_array); }
    }  /* if (capi_sigma_as_array == NULL) ... else of sigma */
    /* End of cleaning variable sigma */
    if((PyObject *)capi_ener_as_array!=ener_capi) {
        Py_XDECREF(capi_ener_as_array); }
    }  /* if (capi_ener_as_array == NULL) ... else of ener */
    /* End of cleaning variable ener */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************** end of compute_spectralf_diag_single ********************/

/*************************** lambda_dynamic_single ***************************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_lambda_dynamic_single[] = "\
lambda_out = lambda_dynamic_single(energies,sigma,t,static_limit,w_q2,w_q3,gaussian,[ne])\n\nWrapper for ``lambda_dynamic_single``.\
\n\nParameters\n----------\n"
"energies : input rank-1 array('d') with bounds (ne)\n"
"sigma : input float\n"
"t : input float\n"
"static_limit : input int\n"
"w_q2 : input rank-1 array('d') with bounds (3)\n"
"w_q3 : input rank-1 array('d') with bounds (3)\n"
"gaussian : input int\n"
"\nOther Parameters\n----------------\n"
"ne : input int, optional\n    Default: shape(energies, 0)\n"
"\nReturns\n-------\n"
"lambda_out : rank-1 array('D') with bounds (ne)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_lambda_dynamic_single(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,double*,double*,double*,int*,double*,double*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int ne = 0;
    PyObject *ne_capi = Py_None;
    double *energies = NULL;
    npy_intp energies_Dims[1] = {-1};
    const int energies_Rank = 1;
    PyArrayObject *capi_energies_as_array = NULL;
    int capi_energies_intent = 0;
    PyObject *energies_capi = Py_None;
    double sigma = 0;
    PyObject *sigma_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    int static_limit = 0;
    PyObject *static_limit_capi = Py_None;
    double *w_q2 = NULL;
    npy_intp w_q2_Dims[1] = {-1};
    const int w_q2_Rank = 1;
    PyArrayObject *capi_w_q2_as_array = NULL;
    int capi_w_q2_intent = 0;
    PyObject *w_q2_capi = Py_None;
    double *w_q3 = NULL;
    npy_intp w_q3_Dims[1] = {-1};
    const int w_q3_Rank = 1;
    PyArrayObject *capi_w_q3_as_array = NULL;
    int capi_w_q3_intent = 0;
    PyObject *w_q3_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    complex_double *lambda_out = NULL;
    npy_intp lambda_out_Dims[1] = {-1};
    const int lambda_out_Rank = 1;
    PyArrayObject *capi_lambda_out_as_array = NULL;
    int capi_lambda_out_intent = 0;
    static char *capi_kwlist[] = {"energies","sigma","t","static_limit","w_q2","w_q3","gaussian","ne",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOO|O:thermal_conductivity.third_order_cond.lambda_dynamic_single",\
        capi_kwlist,&energies_capi,&sigma_capi,&t_capi,&static_limit_capi,&w_q2_capi,&w_q3_capi,&gaussian_capi,&ne_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable static_limit */
        static_limit = (int)PyObject_IsTrue(static_limit_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable energies */
    ;
    capi_energies_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.lambda_dynamic_single: failed to create array from the 1st argument `energies`";
    capi_energies_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,energies_Dims,energies_Rank,  capi_energies_intent,energies_capi,capi_errmess);
    if (capi_energies_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        energies = (double *)(PyArray_DATA(capi_energies_as_array));

    /* Processing variable sigma */
        f2py_success = double_from_pyobj(&sigma,sigma_capi,"thermal_conductivity.third_order_cond.lambda_dynamic_single() 2nd argument (sigma) can't be converted to double");
    if (f2py_success) {
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.third_order_cond.lambda_dynamic_single() 3rd argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable w_q2 */
    w_q2_Dims[0]=3;
    capi_w_q2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.lambda_dynamic_single: failed to create array from the 5th argument `w_q2`";
    capi_w_q2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,w_q2_Dims,w_q2_Rank,  capi_w_q2_intent,w_q2_capi,capi_errmess);
    if (capi_w_q2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        w_q2 = (double *)(PyArray_DATA(capi_w_q2_as_array));

    /* Processing variable w_q3 */
    w_q3_Dims[0]=3;
    capi_w_q3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.lambda_dynamic_single: failed to create array from the 6th argument `w_q3`";
    capi_w_q3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,w_q3_Dims,w_q3_Rank,  capi_w_q3_intent,w_q3_capi,capi_errmess);
    if (capi_w_q3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        w_q3 = (double *)(PyArray_DATA(capi_w_q3_as_array));

    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(energies, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.third_order_cond.lambda_dynamic_single() 1st keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(energies, 0) == ne,"shape(energies, 0) == ne","1st keyword ne","lambda_dynamic_single:ne=%d",ne) {
    /* Processing variable lambda_out */
    lambda_out_Dims[0]=ne;
    capi_lambda_out_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.lambda_dynamic_single: failed to create array from the hidden `lambda_out`";
    capi_lambda_out_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,lambda_out_Dims,lambda_out_Rank,  capi_lambda_out_intent,Py_None,capi_errmess);
    if (capi_lambda_out_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        lambda_out = (complex_double *)(PyArray_DATA(capi_lambda_out_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&ne,energies,&sigma,&t,&static_limit,w_q2,w_q3,&gaussian,lambda_out);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_lambda_out_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_lambda_out_as_array == NULL) ... else of lambda_out */
    /* End of cleaning variable lambda_out */
    } /*CHECKSCALAR(shape(energies, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    if((PyObject *)capi_w_q3_as_array!=w_q3_capi) {
        Py_XDECREF(capi_w_q3_as_array); }
    }  /* if (capi_w_q3_as_array == NULL) ... else of w_q3 */
    /* End of cleaning variable w_q3 */
    if((PyObject *)capi_w_q2_as_array!=w_q2_capi) {
        Py_XDECREF(capi_w_q2_as_array); }
    }  /* if (capi_w_q2_as_array == NULL) ... else of w_q2 */
    /* End of cleaning variable w_q2 */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    } /*if (f2py_success) of sigma*/
    /* End of cleaning variable sigma */
    if((PyObject *)capi_energies_as_array!=energies_capi) {
        Py_XDECREF(capi_energies_as_array); }
    }  /* if (capi_energies_as_array == NULL) ... else of energies */
    /* End of cleaning variable energies */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    } /*if (f2py_success) of static_limit*/
    /* End of cleaning variable static_limit */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************ end of lambda_dynamic_single ************************/

/************************ lambda_dynamic_value_single ************************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_lambda_dynamic_value_single[] = "\
lambda_out = lambda_dynamic_value_single(n_mod,value,sigma,t,w_q2,w_q3,gaussian)\n\nWrapper for ``lambda_dynamic_value_single``.\
\n\nParameters\n----------\n"
"n_mod : input int\n"
"value : input float\n"
"sigma : input float\n"
"t : input float\n"
"w_q2 : input rank-1 array('d') with bounds (3)\n"
"w_q3 : input rank-1 array('d') with bounds (3)\n"
"gaussian : input int\n"
"\nReturns\n-------\n"
"lambda_out : complex";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_lambda_dynamic_value_single(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,double*,double*,double*,double*,double*,int*,complex_double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    int n_mod = 0;
    PyObject *n_mod_capi = Py_None;
    double value = 0;
    PyObject *value_capi = Py_None;
    double sigma = 0;
    PyObject *sigma_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    double *w_q2 = NULL;
    npy_intp w_q2_Dims[1] = {-1};
    const int w_q2_Rank = 1;
    PyArrayObject *capi_w_q2_as_array = NULL;
    int capi_w_q2_intent = 0;
    PyObject *w_q2_capi = Py_None;
    double *w_q3 = NULL;
    npy_intp w_q3_Dims[1] = {-1};
    const int w_q3_Rank = 1;
    PyArrayObject *capi_w_q3_as_array = NULL;
    int capi_w_q3_intent = 0;
    PyObject *w_q3_capi = Py_None;
    int gaussian = 0;
    PyObject *gaussian_capi = Py_None;
    complex_double lambda_out;
    PyObject *lambda_out_capi = Py_None;
    static char *capi_kwlist[] = {"n_mod","value","sigma","t","w_q2","w_q3","gaussian",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOOO|:thermal_conductivity.third_order_cond.lambda_dynamic_value_single",\
        capi_kwlist,&n_mod_capi,&value_capi,&sigma_capi,&t_capi,&w_q2_capi,&w_q3_capi,&gaussian_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable lambda_out */
    /* Processing variable n_mod */
        f2py_success = int_from_pyobj(&n_mod,n_mod_capi,"thermal_conductivity.third_order_cond.lambda_dynamic_value_single() 1st argument (n_mod) can't be converted to int");
    if (f2py_success) {
    /* Processing variable gaussian */
        gaussian = (int)PyObject_IsTrue(gaussian_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable sigma */
        f2py_success = double_from_pyobj(&sigma,sigma_capi,"thermal_conductivity.third_order_cond.lambda_dynamic_value_single() 3rd argument (sigma) can't be converted to double");
    if (f2py_success) {
    /* Processing variable value */
        f2py_success = double_from_pyobj(&value,value_capi,"thermal_conductivity.third_order_cond.lambda_dynamic_value_single() 2nd argument (value) can't be converted to double");
    if (f2py_success) {
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.third_order_cond.lambda_dynamic_value_single() 4th argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable w_q2 */
    w_q2_Dims[0]=3;
    capi_w_q2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.lambda_dynamic_value_single: failed to create array from the 5th argument `w_q2`";
    capi_w_q2_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,w_q2_Dims,w_q2_Rank,  capi_w_q2_intent,w_q2_capi,capi_errmess);
    if (capi_w_q2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        w_q2 = (double *)(PyArray_DATA(capi_w_q2_as_array));

    /* Processing variable w_q3 */
    w_q3_Dims[0]=3;
    capi_w_q3_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.lambda_dynamic_value_single: failed to create array from the 6th argument `w_q3`";
    capi_w_q3_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,w_q3_Dims,w_q3_Rank,  capi_w_q3_intent,w_q3_capi,capi_errmess);
    if (capi_w_q3_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        w_q3 = (double *)(PyArray_DATA(capi_w_q3_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&n_mod,&value,&sigma,&t,w_q2,w_q3,&gaussian,&lambda_out);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
    lambda_out_capi = pyobj_from_complex_double1(lambda_out);
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",lambda_out_capi);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_w_q3_as_array!=w_q3_capi) {
        Py_XDECREF(capi_w_q3_as_array); }
    }  /* if (capi_w_q3_as_array == NULL) ... else of w_q3 */
    /* End of cleaning variable w_q3 */
    if((PyObject *)capi_w_q2_as_array!=w_q2_capi) {
        Py_XDECREF(capi_w_q2_as_array); }
    }  /* if (capi_w_q2_as_array == NULL) ... else of w_q2 */
    /* End of cleaning variable w_q2 */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    } /*if (f2py_success) of value*/
    /* End of cleaning variable value */
    } /*if (f2py_success) of sigma*/
    /* End of cleaning variable sigma */
    } /*if (f2py_success) of gaussian*/
    /* End of cleaning variable gaussian */
    } /*if (f2py_success) of n_mod*/
    /* End of cleaning variable n_mod */
    /* End of cleaning variable lambda_out */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************* end of lambda_dynamic_value_single *********************/

/************************ calculate_spectral_function ************************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_calculate_spectral_function[] = "\
spectralf = calculate_spectral_function(ener,d2_freq,selfnrg,[nat,ne])\n\nWrapper for ``calculate_spectral_function``.\
\n\nParameters\n----------\n"
"ener : input rank-1 array('d') with bounds (ne)\n"
"d2_freq : input rank-1 array('d') with bounds (3 * nat)\n"
"selfnrg : input rank-2 array('D') with bounds (ne,3 * nat)\n"
"\nOther Parameters\n----------------\n"
"nat : input int, optional\n    Default: shape(d2_freq, 0) / 3\n"
"ne : input int, optional\n    Default: shape(ener, 0)\n"
"\nReturns\n-------\n"
"spectralf : rank-2 array('d') with bounds (ne,3 * nat)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_calculate_spectral_function(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,complex_double*,int*,int*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *ener = NULL;
    npy_intp ener_Dims[1] = {-1};
    const int ener_Rank = 1;
    PyArrayObject *capi_ener_as_array = NULL;
    int capi_ener_intent = 0;
    PyObject *ener_capi = Py_None;
    double *d2_freq = NULL;
    npy_intp d2_freq_Dims[1] = {-1};
    const int d2_freq_Rank = 1;
    PyArrayObject *capi_d2_freq_as_array = NULL;
    int capi_d2_freq_intent = 0;
    PyObject *d2_freq_capi = Py_None;
    complex_double *selfnrg = NULL;
    npy_intp selfnrg_Dims[2] = {-1, -1};
    const int selfnrg_Rank = 2;
    PyArrayObject *capi_selfnrg_as_array = NULL;
    int capi_selfnrg_intent = 0;
    PyObject *selfnrg_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    double *spectralf = NULL;
    npy_intp spectralf_Dims[2] = {-1, -1};
    const int spectralf_Rank = 2;
    PyArrayObject *capi_spectralf_as_array = NULL;
    int capi_spectralf_intent = 0;
    static char *capi_kwlist[] = {"ener","d2_freq","selfnrg","nat","ne",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOO|OO:thermal_conductivity.third_order_cond.calculate_spectral_function",\
        capi_kwlist,&ener_capi,&d2_freq_capi,&selfnrg_capi,&nat_capi,&ne_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable ener */
    ;
    capi_ener_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function: failed to create array from the 1st argument `ener`";
    capi_ener_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,ener_Dims,ener_Rank,  capi_ener_intent,ener_capi,capi_errmess);
    if (capi_ener_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        ener = (double *)(PyArray_DATA(capi_ener_as_array));

    /* Processing variable d2_freq */
    ;
    capi_d2_freq_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function: failed to create array from the 2nd argument `d2_freq`";
    capi_d2_freq_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,d2_freq_Dims,d2_freq_Rank,  capi_d2_freq_intent,d2_freq_capi,capi_errmess);
    if (capi_d2_freq_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        d2_freq = (double *)(PyArray_DATA(capi_d2_freq_as_array));

    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(ener, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.third_order_cond.calculate_spectral_function() 2nd keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(ener, 0) == ne,"shape(ener, 0) == ne","2nd keyword ne","calculate_spectral_function:ne=%d",ne) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(d2_freq, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.third_order_cond.calculate_spectral_function() 1st keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(d2_freq, 0) == 3 * nat,"shape(d2_freq, 0) == 3 * nat","1st keyword nat","calculate_spectral_function:nat=%d",nat) {
    /* Processing variable selfnrg */
    selfnrg_Dims[0]=ne,selfnrg_Dims[1]=3 * nat;
    capi_selfnrg_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function: failed to create array from the 3rd argument `selfnrg`";
    capi_selfnrg_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,selfnrg_Dims,selfnrg_Rank,  capi_selfnrg_intent,selfnrg_capi,capi_errmess);
    if (capi_selfnrg_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        selfnrg = (complex_double *)(PyArray_DATA(capi_selfnrg_as_array));

    /* Processing variable spectralf */
    spectralf_Dims[0]=ne,spectralf_Dims[1]=3 * nat;
    capi_spectralf_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function: failed to create array from the hidden `spectralf`";
    capi_spectralf_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,spectralf_Dims,spectralf_Rank,  capi_spectralf_intent,Py_None,capi_errmess);
    if (capi_spectralf_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        spectralf = (double *)(PyArray_DATA(capi_spectralf_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(ener,d2_freq,selfnrg,&nat,&ne,spectralf);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_spectralf_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_spectralf_as_array == NULL) ... else of spectralf */
    /* End of cleaning variable spectralf */
    if((PyObject *)capi_selfnrg_as_array!=selfnrg_capi) {
        Py_XDECREF(capi_selfnrg_as_array); }
    }  /* if (capi_selfnrg_as_array == NULL) ... else of selfnrg */
    /* End of cleaning variable selfnrg */
    } /*CHECKSCALAR(shape(d2_freq, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(ener, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    if((PyObject *)capi_d2_freq_as_array!=d2_freq_capi) {
        Py_XDECREF(capi_d2_freq_as_array); }
    }  /* if (capi_d2_freq_as_array == NULL) ... else of d2_freq */
    /* End of cleaning variable d2_freq */
    if((PyObject *)capi_ener_as_array!=ener_capi) {
        Py_XDECREF(capi_ener_as_array); }
    }  /* if (capi_ener_as_array == NULL) ... else of ener */
    /* End of cleaning variable ener */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/********************* end of calculate_spectral_function *********************/

/****************** calculate_spectral_function_mode_mixing ******************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_calculate_spectral_function_mode_mixing[] = "\
spectralf = calculate_spectral_function_mode_mixing(ener,smear,wq,pi,notransl,mass,[nat,ne])\n\nWrapper for ``calculate_spectral_function_mode_mixing``.\
\n\nParameters\n----------\n"
"ener : input rank-1 array('d') with bounds (ne)\n"
"smear : input rank-1 array('d') with bounds (3 * nat)\n"
"wq : input rank-1 array('d') with bounds (3 * nat)\n"
"pi : input rank-3 array('D') with bounds (ne,3 * nat,3 * nat)\n"
"notransl : input int\n"
"mass : input rank-1 array('d') with bounds (nat)\n"
"\nOther Parameters\n----------------\n"
"nat : input int, optional\n    Default: shape(smear, 0) / 3\n"
"ne : input int, optional\n    Default: shape(ener, 0)\n"
"\nReturns\n-------\n"
"spectralf : rank-3 array('D') with bounds (3 * nat,3 * nat,ne)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_calculate_spectral_function_mode_mixing(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*,complex_double*,int*,complex_double*,double*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *ener = NULL;
    npy_intp ener_Dims[1] = {-1};
    const int ener_Rank = 1;
    PyArrayObject *capi_ener_as_array = NULL;
    int capi_ener_intent = 0;
    PyObject *ener_capi = Py_None;
    double *smear = NULL;
    npy_intp smear_Dims[1] = {-1};
    const int smear_Rank = 1;
    PyArrayObject *capi_smear_as_array = NULL;
    int capi_smear_intent = 0;
    PyObject *smear_capi = Py_None;
    double *wq = NULL;
    npy_intp wq_Dims[1] = {-1};
    const int wq_Rank = 1;
    PyArrayObject *capi_wq_as_array = NULL;
    int capi_wq_intent = 0;
    PyObject *wq_capi = Py_None;
    complex_double *pi = NULL;
    npy_intp pi_Dims[3] = {-1, -1, -1};
    const int pi_Rank = 3;
    PyArrayObject *capi_pi_as_array = NULL;
    int capi_pi_intent = 0;
    PyObject *pi_capi = Py_None;
    int notransl = 0;
    PyObject *notransl_capi = Py_None;
    complex_double *spectralf = NULL;
    npy_intp spectralf_Dims[3] = {-1, -1, -1};
    const int spectralf_Rank = 3;
    PyArrayObject *capi_spectralf_as_array = NULL;
    int capi_spectralf_intent = 0;
    double *mass = NULL;
    npy_intp mass_Dims[1] = {-1};
    const int mass_Rank = 1;
    PyArrayObject *capi_mass_as_array = NULL;
    int capi_mass_intent = 0;
    PyObject *mass_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    static char *capi_kwlist[] = {"ener","smear","wq","pi","notransl","mass","nat","ne",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOO|OO:thermal_conductivity.third_order_cond.calculate_spectral_function_mode_mixing",\
        capi_kwlist,&ener_capi,&smear_capi,&wq_capi,&pi_capi,&notransl_capi,&mass_capi,&nat_capi,&ne_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable ener */
    ;
    capi_ener_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function_mode_mixing: failed to create array from the 1st argument `ener`";
    capi_ener_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,ener_Dims,ener_Rank,  capi_ener_intent,ener_capi,capi_errmess);
    if (capi_ener_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        ener = (double *)(PyArray_DATA(capi_ener_as_array));

    /* Processing variable smear */
    ;
    capi_smear_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function_mode_mixing: failed to create array from the 2nd argument `smear`";
    capi_smear_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_Dims,smear_Rank,  capi_smear_intent,smear_capi,capi_errmess);
    if (capi_smear_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear = (double *)(PyArray_DATA(capi_smear_as_array));

    /* Processing variable notransl */
        notransl = (int)PyObject_IsTrue(notransl_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(ener, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.third_order_cond.calculate_spectral_function_mode_mixing() 2nd keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(ener, 0) == ne,"shape(ener, 0) == ne","2nd keyword ne","calculate_spectral_function_mode_mixing:ne=%d",ne) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(smear, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.third_order_cond.calculate_spectral_function_mode_mixing() 1st keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(smear, 0) == 3 * nat,"shape(smear, 0) == 3 * nat","1st keyword nat","calculate_spectral_function_mode_mixing:nat=%d",nat) {
    /* Processing variable wq */
    wq_Dims[0]=3 * nat;
    capi_wq_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function_mode_mixing: failed to create array from the 3rd argument `wq`";
    capi_wq_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,wq_Dims,wq_Rank,  capi_wq_intent,wq_capi,capi_errmess);
    if (capi_wq_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        wq = (double *)(PyArray_DATA(capi_wq_as_array));

    /* Processing variable pi */
    pi_Dims[0]=ne,pi_Dims[1]=3 * nat,pi_Dims[2]=3 * nat;
    capi_pi_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function_mode_mixing: failed to create array from the 4th argument `pi`";
    capi_pi_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,pi_Dims,pi_Rank,  capi_pi_intent,pi_capi,capi_errmess);
    if (capi_pi_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pi = (complex_double *)(PyArray_DATA(capi_pi_as_array));

    /* Processing variable spectralf */
    spectralf_Dims[0]=3 * nat,spectralf_Dims[1]=3 * nat,spectralf_Dims[2]=ne;
    capi_spectralf_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function_mode_mixing: failed to create array from the hidden `spectralf`";
    capi_spectralf_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,spectralf_Dims,spectralf_Rank,  capi_spectralf_intent,Py_None,capi_errmess);
    if (capi_spectralf_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        spectralf = (complex_double *)(PyArray_DATA(capi_spectralf_as_array));

    /* Processing variable mass */
    mass_Dims[0]=nat;
    capi_mass_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function_mode_mixing: failed to create array from the 6th argument `mass`";
    capi_mass_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,mass_Dims,mass_Rank,  capi_mass_intent,mass_capi,capi_errmess);
    if (capi_mass_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mass = (double *)(PyArray_DATA(capi_mass_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(ener,smear,wq,pi,&notransl,spectralf,mass,&nat,&ne);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_spectralf_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_mass_as_array!=mass_capi) {
        Py_XDECREF(capi_mass_as_array); }
    }  /* if (capi_mass_as_array == NULL) ... else of mass */
    /* End of cleaning variable mass */
    }  /* if (capi_spectralf_as_array == NULL) ... else of spectralf */
    /* End of cleaning variable spectralf */
    if((PyObject *)capi_pi_as_array!=pi_capi) {
        Py_XDECREF(capi_pi_as_array); }
    }  /* if (capi_pi_as_array == NULL) ... else of pi */
    /* End of cleaning variable pi */
    if((PyObject *)capi_wq_as_array!=wq_capi) {
        Py_XDECREF(capi_wq_as_array); }
    }  /* if (capi_wq_as_array == NULL) ... else of wq */
    /* End of cleaning variable wq */
    } /*CHECKSCALAR(shape(smear, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(ener, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    } /*if (f2py_success) of notransl*/
    /* End of cleaning variable notransl */
    if((PyObject *)capi_smear_as_array!=smear_capi) {
        Py_XDECREF(capi_smear_as_array); }
    }  /* if (capi_smear_as_array == NULL) ... else of smear */
    /* End of cleaning variable smear */
    if((PyObject *)capi_ener_as_array!=ener_capi) {
        Py_XDECREF(capi_ener_as_array); }
    }  /* if (capi_ener_as_array == NULL) ... else of ener */
    /* End of cleaning variable ener */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/*************** end of calculate_spectral_function_mode_mixing ***************/

/******************* calculate_spectral_function_cartesian *******************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_calculate_spectral_function_cartesian[] = "\
spectralf = calculate_spectral_function_cartesian(ener,smear,d2,pi,notransl,mass,[nat,ne])\n\nWrapper for ``calculate_spectral_function_cartesian``.\
\n\nParameters\n----------\n"
"ener : input rank-1 array('d') with bounds (ne)\n"
"smear : input rank-1 array('d') with bounds (3 * nat)\n"
"d2 : input rank-2 array('D') with bounds (3 * nat,3 * nat)\n"
"pi : input rank-3 array('D') with bounds (ne,3 * nat,3 * nat)\n"
"notransl : input int\n"
"mass : input rank-1 array('d') with bounds (nat)\n"
"\nOther Parameters\n----------------\n"
"nat : input int, optional\n    Default: shape(smear, 0) / 3\n"
"ne : input int, optional\n    Default: shape(ener, 0)\n"
"\nReturns\n-------\n"
"spectralf : rank-3 array('D') with bounds (3 * nat,3 * nat,ne)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_calculate_spectral_function_cartesian(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,complex_double*,complex_double*,int*,complex_double*,double*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double *ener = NULL;
    npy_intp ener_Dims[1] = {-1};
    const int ener_Rank = 1;
    PyArrayObject *capi_ener_as_array = NULL;
    int capi_ener_intent = 0;
    PyObject *ener_capi = Py_None;
    double *smear = NULL;
    npy_intp smear_Dims[1] = {-1};
    const int smear_Rank = 1;
    PyArrayObject *capi_smear_as_array = NULL;
    int capi_smear_intent = 0;
    PyObject *smear_capi = Py_None;
    complex_double *d2 = NULL;
    npy_intp d2_Dims[2] = {-1, -1};
    const int d2_Rank = 2;
    PyArrayObject *capi_d2_as_array = NULL;
    int capi_d2_intent = 0;
    PyObject *d2_capi = Py_None;
    complex_double *pi = NULL;
    npy_intp pi_Dims[3] = {-1, -1, -1};
    const int pi_Rank = 3;
    PyArrayObject *capi_pi_as_array = NULL;
    int capi_pi_intent = 0;
    PyObject *pi_capi = Py_None;
    int notransl = 0;
    PyObject *notransl_capi = Py_None;
    complex_double *spectralf = NULL;
    npy_intp spectralf_Dims[3] = {-1, -1, -1};
    const int spectralf_Rank = 3;
    PyArrayObject *capi_spectralf_as_array = NULL;
    int capi_spectralf_intent = 0;
    double *mass = NULL;
    npy_intp mass_Dims[1] = {-1};
    const int mass_Rank = 1;
    PyArrayObject *capi_mass_as_array = NULL;
    int capi_mass_intent = 0;
    PyObject *mass_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    int ne = 0;
    PyObject *ne_capi = Py_None;
    static char *capi_kwlist[] = {"ener","smear","d2","pi","notransl","mass","nat","ne",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OOOOOO|OO:thermal_conductivity.third_order_cond.calculate_spectral_function_cartesian",\
        capi_kwlist,&ener_capi,&smear_capi,&d2_capi,&pi_capi,&notransl_capi,&mass_capi,&nat_capi,&ne_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable ener */
    ;
    capi_ener_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function_cartesian: failed to create array from the 1st argument `ener`";
    capi_ener_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,ener_Dims,ener_Rank,  capi_ener_intent,ener_capi,capi_errmess);
    if (capi_ener_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        ener = (double *)(PyArray_DATA(capi_ener_as_array));

    /* Processing variable smear */
    ;
    capi_smear_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function_cartesian: failed to create array from the 2nd argument `smear`";
    capi_smear_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,smear_Dims,smear_Rank,  capi_smear_intent,smear_capi,capi_errmess);
    if (capi_smear_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        smear = (double *)(PyArray_DATA(capi_smear_as_array));

    /* Processing variable notransl */
        notransl = (int)PyObject_IsTrue(notransl_capi);
        f2py_success = 1;
    if (f2py_success) {
    /* Processing variable ne */
    if (ne_capi == Py_None) ne = shape(ener, 0); else
        f2py_success = int_from_pyobj(&ne,ne_capi,"thermal_conductivity.third_order_cond.calculate_spectral_function_cartesian() 2nd keyword (ne) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(ener, 0) == ne,"shape(ener, 0) == ne","2nd keyword ne","calculate_spectral_function_cartesian:ne=%d",ne) {
    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(smear, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.third_order_cond.calculate_spectral_function_cartesian() 1st keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(smear, 0) == 3 * nat,"shape(smear, 0) == 3 * nat","1st keyword nat","calculate_spectral_function_cartesian:nat=%d",nat) {
    /* Processing variable d2 */
    d2_Dims[0]=3 * nat,d2_Dims[1]=3 * nat;
    capi_d2_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function_cartesian: failed to create array from the 3rd argument `d2`";
    capi_d2_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,d2_Dims,d2_Rank,  capi_d2_intent,d2_capi,capi_errmess);
    if (capi_d2_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        d2 = (complex_double *)(PyArray_DATA(capi_d2_as_array));

    /* Processing variable pi */
    pi_Dims[0]=ne,pi_Dims[1]=3 * nat,pi_Dims[2]=3 * nat;
    capi_pi_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function_cartesian: failed to create array from the 4th argument `pi`";
    capi_pi_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,pi_Dims,pi_Rank,  capi_pi_intent,pi_capi,capi_errmess);
    if (capi_pi_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        pi = (complex_double *)(PyArray_DATA(capi_pi_as_array));

    /* Processing variable spectralf */
    spectralf_Dims[0]=3 * nat,spectralf_Dims[1]=3 * nat,spectralf_Dims[2]=ne;
    capi_spectralf_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function_cartesian: failed to create array from the hidden `spectralf`";
    capi_spectralf_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,spectralf_Dims,spectralf_Rank,  capi_spectralf_intent,Py_None,capi_errmess);
    if (capi_spectralf_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        spectralf = (complex_double *)(PyArray_DATA(capi_spectralf_as_array));

    /* Processing variable mass */
    mass_Dims[0]=nat;
    capi_mass_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.calculate_spectral_function_cartesian: failed to create array from the 6th argument `mass`";
    capi_mass_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,mass_Dims,mass_Rank,  capi_mass_intent,mass_capi,capi_errmess);
    if (capi_mass_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mass = (double *)(PyArray_DATA(capi_mass_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(ener,smear,d2,pi,&notransl,spectralf,mass,&nat,&ne);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_spectralf_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_mass_as_array!=mass_capi) {
        Py_XDECREF(capi_mass_as_array); }
    }  /* if (capi_mass_as_array == NULL) ... else of mass */
    /* End of cleaning variable mass */
    }  /* if (capi_spectralf_as_array == NULL) ... else of spectralf */
    /* End of cleaning variable spectralf */
    if((PyObject *)capi_pi_as_array!=pi_capi) {
        Py_XDECREF(capi_pi_as_array); }
    }  /* if (capi_pi_as_array == NULL) ... else of pi */
    /* End of cleaning variable pi */
    if((PyObject *)capi_d2_as_array!=d2_capi) {
        Py_XDECREF(capi_d2_as_array); }
    }  /* if (capi_d2_as_array == NULL) ... else of d2 */
    /* End of cleaning variable d2 */
    } /*CHECKSCALAR(shape(smear, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    } /*CHECKSCALAR(shape(ener, 0) == ne)*/
    } /*if (f2py_success) of ne*/
    /* End of cleaning variable ne */
    } /*if (f2py_success) of notransl*/
    /* End of cleaning variable notransl */
    if((PyObject *)capi_smear_as_array!=smear_capi) {
        Py_XDECREF(capi_smear_as_array); }
    }  /* if (capi_smear_as_array == NULL) ... else of smear */
    /* End of cleaning variable smear */
    if((PyObject *)capi_ener_as_array!=ener_capi) {
        Py_XDECREF(capi_ener_as_array); }
    }  /* if (capi_ener_as_array == NULL) ... else of ener */
    /* End of cleaning variable ener */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/**************** end of calculate_spectral_function_cartesian ****************/

/********************************* bose_freq *********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_bose_freq[] = "\
bose = bose_freq(t,freq,[n_mod])\n\nWrapper for ``bose_freq``.\
\n\nParameters\n----------\n"
"t : input float\n"
"freq : input rank-1 array('d') with bounds (n_mod)\n"
"\nOther Parameters\n----------------\n"
"n_mod : input int, optional\n    Default: shape(freq, 0)\n"
"\nReturns\n-------\n"
"bose : rank-1 array('d') with bounds (n_mod)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_bose_freq(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,int*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double t = 0;
    PyObject *t_capi = Py_None;
    int n_mod = 0;
    PyObject *n_mod_capi = Py_None;
    double *freq = NULL;
    npy_intp freq_Dims[1] = {-1};
    const int freq_Rank = 1;
    PyArrayObject *capi_freq_as_array = NULL;
    int capi_freq_intent = 0;
    PyObject *freq_capi = Py_None;
    double *bose = NULL;
    npy_intp bose_Dims[1] = {-1};
    const int bose_Rank = 1;
    PyArrayObject *capi_bose_as_array = NULL;
    int capi_bose_intent = 0;
    static char *capi_kwlist[] = {"t","freq","n_mod",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|O:thermal_conductivity.third_order_cond.bose_freq",\
        capi_kwlist,&t_capi,&freq_capi,&n_mod_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.third_order_cond.bose_freq() 1st argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable freq */
    ;
    capi_freq_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.bose_freq: failed to create array from the 2nd argument `freq`";
    capi_freq_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,freq_Dims,freq_Rank,  capi_freq_intent,freq_capi,capi_errmess);
    if (capi_freq_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        freq = (double *)(PyArray_DATA(capi_freq_as_array));

    /* Processing variable n_mod */
    if (n_mod_capi == Py_None) n_mod = shape(freq, 0); else
        f2py_success = int_from_pyobj(&n_mod,n_mod_capi,"thermal_conductivity.third_order_cond.bose_freq() 1st keyword (n_mod) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(freq, 0) == n_mod,"shape(freq, 0) == n_mod","1st keyword n_mod","bose_freq:n_mod=%d",n_mod) {
    /* Processing variable bose */
    bose_Dims[0]=n_mod;
    capi_bose_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.bose_freq: failed to create array from the hidden `bose`";
    capi_bose_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,bose_Dims,bose_Rank,  capi_bose_intent,Py_None,capi_errmess);
    if (capi_bose_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        bose = (double *)(PyArray_DATA(capi_bose_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&t,&n_mod,freq,bose);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_bose_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_bose_as_array == NULL) ... else of bose */
    /* End of cleaning variable bose */
    } /*CHECKSCALAR(shape(freq, 0) == n_mod)*/
    } /*if (f2py_success) of n_mod*/
    /* End of cleaning variable n_mod */
    if((PyObject *)capi_freq_as_array!=freq_capi) {
        Py_XDECREF(capi_freq_as_array); }
    }  /* if (capi_freq_as_array == NULL) ... else of freq */
    /* End of cleaning variable freq */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/****************************** end of bose_freq ******************************/

/********************************** eq_freq **********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_eq_freq[] = "\
bose = eq_freq(t,freq,[n_mod])\n\nWrapper for ``eq_freq``.\
\n\nParameters\n----------\n"
"t : input float\n"
"freq : input rank-1 array('d') with bounds (n_mod)\n"
"\nOther Parameters\n----------------\n"
"n_mod : input int, optional\n    Default: shape(freq, 0)\n"
"\nReturns\n-------\n"
"bose : rank-1 array('d') with bounds (n_mod)";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_eq_freq(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,int*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double t = 0;
    PyObject *t_capi = Py_None;
    int n_mod = 0;
    PyObject *n_mod_capi = Py_None;
    double *freq = NULL;
    npy_intp freq_Dims[1] = {-1};
    const int freq_Rank = 1;
    PyArrayObject *capi_freq_as_array = NULL;
    int capi_freq_intent = 0;
    PyObject *freq_capi = Py_None;
    double *bose = NULL;
    npy_intp bose_Dims[1] = {-1};
    const int bose_Rank = 1;
    PyArrayObject *capi_bose_as_array = NULL;
    int capi_bose_intent = 0;
    static char *capi_kwlist[] = {"t","freq","n_mod",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|O:thermal_conductivity.third_order_cond.eq_freq",\
        capi_kwlist,&t_capi,&freq_capi,&n_mod_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.third_order_cond.eq_freq() 1st argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable freq */
    ;
    capi_freq_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.eq_freq: failed to create array from the 2nd argument `freq`";
    capi_freq_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,freq_Dims,freq_Rank,  capi_freq_intent,freq_capi,capi_errmess);
    if (capi_freq_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        freq = (double *)(PyArray_DATA(capi_freq_as_array));

    /* Processing variable n_mod */
    if (n_mod_capi == Py_None) n_mod = shape(freq, 0); else
        f2py_success = int_from_pyobj(&n_mod,n_mod_capi,"thermal_conductivity.third_order_cond.eq_freq() 1st keyword (n_mod) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(freq, 0) == n_mod,"shape(freq, 0) == n_mod","1st keyword n_mod","eq_freq:n_mod=%d",n_mod) {
    /* Processing variable bose */
    bose_Dims[0]=n_mod;
    capi_bose_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.eq_freq: failed to create array from the hidden `bose`";
    capi_bose_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,bose_Dims,bose_Rank,  capi_bose_intent,Py_None,capi_errmess);
    if (capi_bose_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        bose = (double *)(PyArray_DATA(capi_bose_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(&t,&n_mod,freq,bose);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_bose_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    }  /* if (capi_bose_as_array == NULL) ... else of bose */
    /* End of cleaning variable bose */
    } /*CHECKSCALAR(shape(freq, 0) == n_mod)*/
    } /*if (f2py_success) of n_mod*/
    /* End of cleaning variable n_mod */
    if((PyObject *)capi_freq_as_array!=freq_capi) {
        Py_XDECREF(capi_freq_as_array); }
    }  /* if (capi_freq_as_array == NULL) ... else of freq */
    /* End of cleaning variable freq */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************* end of eq_freq *******************************/

/*********************************** f_bose ***********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_f_bose[] = "\
f_bose = f_bose(freq,t)\n\nWrapper for ``f_bose``.\
\n\nParameters\n----------\n"
"freq : input float\n"
"t : input float\n"
"\nReturns\n-------\n"
"f_bose : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_f_bose(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double f_bosef2pywrap = 0;
    double freq = 0;
    PyObject *freq_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    static char *capi_kwlist[] = {"freq","t",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:thermal_conductivity.third_order_cond.f_bose",\
        capi_kwlist,&freq_capi,&t_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable freq */
        f2py_success = double_from_pyobj(&freq,freq_capi,"thermal_conductivity.third_order_cond.f_bose() 1st argument (freq) can't be converted to double");
    if (f2py_success) {
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.third_order_cond.f_bose() 2nd argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable f_bosef2pywrap */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(&f_bosef2pywrap,&freq,&t);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("d",f_bosef2pywrap);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f_bosef2pywrap */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    } /*if (f2py_success) of freq*/
    /* End of cleaning variable freq */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************* end of f_bose *******************************/

/********************************** df_bose **********************************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_df_bose[] = "\
df_bose = df_bose(freq,t)\n\nWrapper for ``df_bose``.\
\n\nParameters\n----------\n"
"freq : input float\n"
"t : input float\n"
"\nReturns\n-------\n"
"df_bose : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_df_bose(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double df_bosef2pywrap = 0;
    double freq = 0;
    PyObject *freq_capi = Py_None;
    double t = 0;
    PyObject *t_capi = Py_None;
    static char *capi_kwlist[] = {"freq","t",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:thermal_conductivity.third_order_cond.df_bose",\
        capi_kwlist,&freq_capi,&t_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable freq */
        f2py_success = double_from_pyobj(&freq,freq_capi,"thermal_conductivity.third_order_cond.df_bose() 1st argument (freq) can't be converted to double");
    if (f2py_success) {
    /* Processing variable t */
        f2py_success = double_from_pyobj(&t,t_capi,"thermal_conductivity.third_order_cond.df_bose() 2nd argument (t) can't be converted to double");
    if (f2py_success) {
    /* Processing variable df_bosef2pywrap */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(&df_bosef2pywrap,&freq,&t);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("d",df_bosef2pywrap);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable df_bosef2pywrap */
    } /*if (f2py_success) of t*/
    /* End of cleaning variable t */
    } /*if (f2py_success) of freq*/
    /* End of cleaning variable freq */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************* end of df_bose *******************************/

/***************************** gaussian_function *****************************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_gaussian_function[] = "\
gaussian_function = gaussian_function(x,sigma)\n\nWrapper for ``gaussian_function``.\
\n\nParameters\n----------\n"
"x : input float\n"
"sigma : input float\n"
"\nReturns\n-------\n"
"gaussian_function : float";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_gaussian_function(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(double*,double*,double*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    double gaussian_functionf2pywrap = 0;
    double x = 0;
    PyObject *x_capi = Py_None;
    double sigma = 0;
    PyObject *sigma_capi = Py_None;
    static char *capi_kwlist[] = {"x","sigma",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|:thermal_conductivity.third_order_cond.gaussian_function",\
        capi_kwlist,&x_capi,&sigma_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable x */
        f2py_success = double_from_pyobj(&x,x_capi,"thermal_conductivity.third_order_cond.gaussian_function() 1st argument (x) can't be converted to double");
    if (f2py_success) {
    /* Processing variable sigma */
        f2py_success = double_from_pyobj(&sigma,sigma_capi,"thermal_conductivity.third_order_cond.gaussian_function() 2nd argument (sigma) can't be converted to double");
    if (f2py_success) {
    /* Processing variable gaussian_functionf2pywrap */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(&gaussian_functionf2pywrap,&x,&sigma);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("d",gaussian_functionf2pywrap);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable gaussian_functionf2pywrap */
    } /*if (f2py_success) of sigma*/
    /* End of cleaning variable sigma */
    } /*if (f2py_success) of x*/
    /* End of cleaning variable x */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************** end of gaussian_function **************************/

/****************************** eliminate_transl ******************************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_eliminate_transl[] = "\
eliminate_transl(a,mass,[nat])\n\nWrapper for ``eliminate_transl``.\
\n\nParameters\n----------\n"
"a : in/output rank-2 array('D') with bounds (3 * nat,3 * nat)\n"
"mass : input rank-1 array('d') with bounds (nat)\n"
"\nOther Parameters\n----------------\n"
"nat : input int, optional\n    Default: shape(a, 0) / 3";
/*  */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_eliminate_transl(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(complex_double*,double*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    complex_double *a = NULL;
    npy_intp a_Dims[2] = {-1, -1};
    const int a_Rank = 2;
    PyArrayObject *capi_a_as_array = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    double *mass = NULL;
    npy_intp mass_Dims[1] = {-1};
    const int mass_Rank = 1;
    PyArrayObject *capi_mass_as_array = NULL;
    int capi_mass_intent = 0;
    PyObject *mass_capi = Py_None;
    int nat = 0;
    PyObject *nat_capi = Py_None;
    static char *capi_kwlist[] = {"a","mass","nat",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "OO|O:thermal_conductivity.third_order_cond.eliminate_transl",\
        capi_kwlist,&a_capi,&mass_capi,&nat_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    ;
    capi_a_intent |= F2PY_INTENT_INOUT;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.eliminate_transl: failed to create array from the 1st argument `a`";
    capi_a_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,a_Dims,a_Rank,  capi_a_intent,a_capi,capi_errmess);
    if (capi_a_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        a = (complex_double *)(PyArray_DATA(capi_a_as_array));

    /* Processing variable nat */
    if (nat_capi == Py_None) nat = shape(a, 0) / 3; else
        f2py_success = int_from_pyobj(&nat,nat_capi,"thermal_conductivity.third_order_cond.eliminate_transl() 1st keyword (nat) can't be converted to int");
    if (f2py_success) {
    CHECKSCALAR(shape(a, 0) == 3 * nat,"shape(a, 0) == 3 * nat","1st keyword nat","eliminate_transl:nat=%d",nat) {
    /* Processing variable mass */
    mass_Dims[0]=nat;
    capi_mass_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.eliminate_transl: failed to create array from the 2nd argument `mass`";
    capi_mass_as_array = ndarray_from_pyobj(  NPY_DOUBLE,1,mass_Dims,mass_Rank,  capi_mass_intent,mass_capi,capi_errmess);
    if (capi_mass_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        mass = (double *)(PyArray_DATA(capi_mass_as_array));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
                (*f2py_func)(a,mass,&nat);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    if((PyObject *)capi_mass_as_array!=mass_capi) {
        Py_XDECREF(capi_mass_as_array); }
    }  /* if (capi_mass_as_array == NULL) ... else of mass */
    /* End of cleaning variable mass */
    } /*CHECKSCALAR(shape(a, 0) == 3 * nat)*/
    } /*if (f2py_success) of nat*/
    /* End of cleaning variable nat */
    if((PyObject *)capi_a_as_array!=a_capi) {
        Py_XDECREF(capi_a_as_array); }
    }  /* if (capi_a_as_array == NULL) ... else of a */
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/************************** end of eliminate_transl **************************/

/************************************ cinv ************************************/
static char doc_f2py_rout_thermal_conductivity_third_order_cond_cinv[] = "\
ainv = cinv(a)\n\nWrapper for ``cinv``.\
\n\nParameters\n----------\n"
"a : input rank-2 array('D') with bounds (f2py_a_d0,f2py_a_d1)\n"
"\nReturns\n-------\n"
"ainv : rank-2 array('D') with bounds (size(a, 1),size(a, 2)) and cinvf2pywrap storage";
/* #declfortranroutine# */
static PyObject *f2py_rout_thermal_conductivity_third_order_cond_cinv(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(complex_double*,complex_double*,int*,int*)) {
    PyObject * volatile capi_buildvalue = NULL;
    volatile int f2py_success = 1;
/*decl*/

    complex_double *cinvf2pywrap = NULL;
    npy_intp cinvf2pywrap_Dims[2] = {-1, -1};
    const int cinvf2pywrap_Rank = 2;
    PyArrayObject *capi_cinvf2pywrap_as_array = NULL;
    int capi_cinvf2pywrap_intent = 0;
    complex_double *a = NULL;
    npy_intp a_Dims[2] = {-1, -1};
    const int a_Rank = 2;
    PyArrayObject *capi_a_as_array = NULL;
    int capi_a_intent = 0;
    PyObject *a_capi = Py_None;
    int f2py_a_d0 = 0;
    int f2py_a_d1 = 0;
    static char *capi_kwlist[] = {"a",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
    if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
        "O|:thermal_conductivity.third_order_cond.cinv",\
        capi_kwlist,&a_capi))
        return NULL;
/*frompyobj*/
    /* Processing variable a */
    ;
    capi_a_intent |= F2PY_INTENT_IN;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.cinv: failed to create array from the 1st argument `a`";
    capi_a_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,a_Dims,a_Rank,  capi_a_intent,a_capi,capi_errmess);
    if (capi_a_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        a = (complex_double *)(PyArray_DATA(capi_a_as_array));

    /* Processing variable cinvf2pywrap */
    cinvf2pywrap_Dims[0]=size(a, 1),cinvf2pywrap_Dims[1]=size(a, 2);
    capi_cinvf2pywrap_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
    const char * capi_errmess = "thermal_conductivity.thermal_conductivity.third_order_cond.cinv: failed to create array from the hidden `cinvf2pywrap`";
    capi_cinvf2pywrap_as_array = ndarray_from_pyobj(  NPY_CDOUBLE,1,cinvf2pywrap_Dims,cinvf2pywrap_Rank,  capi_cinvf2pywrap_intent,Py_None,capi_errmess);
    if (capi_cinvf2pywrap_as_array == NULL) {
        PyObject* capi_err = PyErr_Occurred();
        if (capi_err == NULL) {
            capi_err = thermal_conductivity_error;
            PyErr_SetString(capi_err, capi_errmess);
        }
    } else {
        cinvf2pywrap = (complex_double *)(PyArray_DATA(capi_cinvf2pywrap_as_array));

    /* Processing variable f2py_a_d0 */
    f2py_a_d0 = shape(a, 0);
    /* Processing variable f2py_a_d1 */
    f2py_a_d1 = shape(a, 1);
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
    (*f2py_func)(cinvf2pywrap,a,&f2py_a_d0,&f2py_a_d1);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
        if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
        CFUNCSMESS("Building return value.\n");
        capi_buildvalue = Py_BuildValue("N",capi_cinvf2pywrap_as_array);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
        } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
    /* End of cleaning variable f2py_a_d1 */
    /* End of cleaning variable f2py_a_d0 */
    }  /* if (capi_cinvf2pywrap_as_array == NULL) ... else of cinvf2pywrap */
    /* End of cleaning variable cinvf2pywrap */
    if((PyObject *)capi_a_as_array!=a_capi) {
        Py_XDECREF(capi_a_as_array); }
    }  /* if (capi_a_as_array == NULL) ... else of a */
    /* End of cleaning variable a */
/*end of cleanupfrompyobj*/
    if (capi_buildvalue == NULL) {
/*routdebugfailure*/
    } else {
/*routdebugleave*/
    }
    CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
    return capi_buildvalue;
}
/******************************** end of cinv ********************************/
/*eof body*/

/******************* See f2py2e/f90mod_rules.py: buildhooks *******************/

static FortranDataDef f2py_get_lf_def[] = {
  {"calculate_lineshapes",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_calculate_lineshapes,doc_f2py_rout_thermal_conductivity_get_lf_calculate_lineshapes},
  {"calculate_lineshapes_mode_mixing",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_calculate_lineshapes_mode_mixing,doc_f2py_rout_thermal_conductivity_get_lf_calculate_lineshapes_mode_mixing},
  {"calculate_lineshapes_cartesian",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_calculate_lineshapes_cartesian,doc_f2py_rout_thermal_conductivity_get_lf_calculate_lineshapes_cartesian},
  {"calculate_lifetimes_selfconsistently",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_calculate_lifetimes_selfconsistently,doc_f2py_rout_thermal_conductivity_get_lf_calculate_lifetimes_selfconsistently},
  {"solve_selfconsistent_equation",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_solve_selfconsistent_equation,doc_f2py_rout_thermal_conductivity_get_lf_solve_selfconsistent_equation},
  {"calculate_correlation_function",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_calculate_correlation_function,doc_f2py_rout_thermal_conductivity_get_lf_calculate_correlation_function},
  {"calculate_lifetimes_perturbative",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_calculate_lifetimes_perturbative,doc_f2py_rout_thermal_conductivity_get_lf_calculate_lifetimes_perturbative},
  {"calculate_lifetimes",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_calculate_lifetimes,doc_f2py_rout_thermal_conductivity_get_lf_calculate_lifetimes},
  {"calculate_self_energy_la",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_calculate_self_energy_la,doc_f2py_rout_thermal_conductivity_get_lf_calculate_self_energy_la},
  {"calculate_self_energy_p",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_calculate_self_energy_p,doc_f2py_rout_thermal_conductivity_get_lf_calculate_self_energy_p},
  {"calculate_self_energy_full",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_calculate_self_energy_full,doc_f2py_rout_thermal_conductivity_get_lf_calculate_self_energy_full},
  {"check_if_gamma",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_check_if_gamma,doc_f2py_rout_thermal_conductivity_get_lf_check_if_gamma},
  {"vec_dot_mat",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_vec_dot_mat,doc_f2py_rout_thermal_conductivity_get_lf_vec_dot_mat},
  {"calculate_real_part_via_kramers_kronig",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_calculate_real_part_via_kramers_kronig,doc_f2py_rout_thermal_conductivity_get_lf_calculate_real_part_via_kramers_kronig},
  {"calculate_real_part_via_kramers_kronig_2d",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_calculate_real_part_via_kramers_kronig_2d,doc_f2py_rout_thermal_conductivity_get_lf_calculate_real_part_via_kramers_kronig_2d},
  {"hilbert_transform_via_fft",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_hilbert_transform_via_fft,doc_f2py_rout_thermal_conductivity_get_lf_hilbert_transform_via_fft},
  {"ht",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_ht,doc_f2py_rout_thermal_conductivity_get_lf_ht},
  {"cfft",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_cfft,doc_f2py_rout_thermal_conductivity_get_lf_cfft},
  {"inv",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_inv,doc_f2py_rout_thermal_conductivity_get_lf_inv},
  {"interpolate_fc2",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_get_lf_interpolate_fc2,doc_f2py_rout_thermal_conductivity_get_lf_interpolate_fc2},
  {NULL}
};

static void f2py_setup_get_lf(char *calculate_lineshapes,char *calculate_lineshapes_mode_mixing,char *calculate_lineshapes_cartesian,char *calculate_lifetimes_selfconsistently,char *solve_selfconsistent_equation,char *calculate_correlation_function,char *calculate_lifetimes_perturbative,char *calculate_lifetimes,char *calculate_self_energy_la,char *calculate_self_energy_p,char *calculate_self_energy_full,char *check_if_gamma,char *vec_dot_mat,char *calculate_real_part_via_kramers_kronig,char *calculate_real_part_via_kramers_kronig_2d,char *hilbert_transform_via_fft,char *ht,char *cfft,char *inv,char *interpolate_fc2) {
  int i_f2py=0;
  f2py_get_lf_def[i_f2py++].data = calculate_lineshapes;
  f2py_get_lf_def[i_f2py++].data = calculate_lineshapes_mode_mixing;
  f2py_get_lf_def[i_f2py++].data = calculate_lineshapes_cartesian;
  f2py_get_lf_def[i_f2py++].data = calculate_lifetimes_selfconsistently;
  f2py_get_lf_def[i_f2py++].data = solve_selfconsistent_equation;
  f2py_get_lf_def[i_f2py++].data = calculate_correlation_function;
  f2py_get_lf_def[i_f2py++].data = calculate_lifetimes_perturbative;
  f2py_get_lf_def[i_f2py++].data = calculate_lifetimes;
  f2py_get_lf_def[i_f2py++].data = calculate_self_energy_la;
  f2py_get_lf_def[i_f2py++].data = calculate_self_energy_p;
  f2py_get_lf_def[i_f2py++].data = calculate_self_energy_full;
  f2py_get_lf_def[i_f2py++].data = check_if_gamma;
  f2py_get_lf_def[i_f2py++].data = vec_dot_mat;
  f2py_get_lf_def[i_f2py++].data = calculate_real_part_via_kramers_kronig;
  f2py_get_lf_def[i_f2py++].data = calculate_real_part_via_kramers_kronig_2d;
  f2py_get_lf_def[i_f2py++].data = hilbert_transform_via_fft;
  f2py_get_lf_def[i_f2py++].data = ht;
  f2py_get_lf_def[i_f2py++].data = cfft;
  f2py_get_lf_def[i_f2py++].data = inv;
  f2py_get_lf_def[i_f2py++].data = interpolate_fc2;
}
extern void F_FUNC_US(f2pyinitget_lf,F2PYINITGET_LF)(void (*)(char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *));
static void f2py_init_get_lf(void) {
  F_FUNC_US(f2pyinitget_lf,F2PYINITGET_LF)(f2py_setup_get_lf);
}


static FortranDataDef f2py_scattering_grids_def[] = {
  {"get_scattering_q_grid",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_scattering_grids_get_scattering_q_grid,doc_f2py_rout_thermal_conductivity_scattering_grids_get_scattering_q_grid},
  {"same_vector",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_scattering_grids_same_vector,doc_f2py_rout_thermal_conductivity_scattering_grids_same_vector},
  {"same_vector_nopbc",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_scattering_grids_same_vector_nopbc,doc_f2py_rout_thermal_conductivity_scattering_grids_same_vector_nopbc},
  {NULL}
};

static void f2py_setup_scattering_grids(char *get_scattering_q_grid,char *same_vector,char *same_vector_nopbc) {
  int i_f2py=0;
  f2py_scattering_grids_def[i_f2py++].data = get_scattering_q_grid;
  f2py_scattering_grids_def[i_f2py++].data = same_vector;
  f2py_scattering_grids_def[i_f2py++].data = same_vector_nopbc;
}
extern void F_FUNC_US(f2pyinitscattering_grids,F2PYINITSCATTERING_GRIDS)(void (*)(char *,char *,char *));
static void f2py_init_scattering_grids(void) {
  F_FUNC_US(f2pyinitscattering_grids,F2PYINITSCATTERING_GRIDS)(f2py_setup_scattering_grids);
}


static FortranDataDef f2py_third_order_centering_def[] = {
  {"analysis",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_analysis,doc_f2py_rout_thermal_conductivity_third_order_centering_analysis},
  {"center",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_center,doc_f2py_rout_thermal_conductivity_third_order_centering_center},
  {"center_sparse",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_center_sparse,doc_f2py_rout_thermal_conductivity_third_order_centering_center_sparse},
  {"pre_center",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_pre_center,doc_f2py_rout_thermal_conductivity_third_order_centering_pre_center},
  {"assign",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_assign,doc_f2py_rout_thermal_conductivity_third_order_centering_assign},
  {"within_dmax",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_within_dmax,doc_f2py_rout_thermal_conductivity_third_order_centering_within_dmax},
  {"compute_perimeter",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_compute_perimeter,doc_f2py_rout_thermal_conductivity_third_order_centering_compute_perimeter},
  {"three_to_one_len",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_three_to_one_len,doc_f2py_rout_thermal_conductivity_third_order_centering_three_to_one_len},
  {"three_to_one",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_three_to_one,doc_f2py_rout_thermal_conductivity_third_order_centering_three_to_one},
  {"one_to_three_len",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_one_to_three_len,doc_f2py_rout_thermal_conductivity_third_order_centering_one_to_three_len},
  {"one_to_three",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_one_to_three,doc_f2py_rout_thermal_conductivity_third_order_centering_one_to_three},
  {"min_el_wise_2",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_min_el_wise_2,doc_f2py_rout_thermal_conductivity_third_order_centering_min_el_wise_2},
  {"max_el_wise_2",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_max_el_wise_2,doc_f2py_rout_thermal_conductivity_third_order_centering_max_el_wise_2},
  {"min_el_wise_3",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_min_el_wise_3,doc_f2py_rout_thermal_conductivity_third_order_centering_min_el_wise_3},
  {"max_el_wise_3",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_max_el_wise_3,doc_f2py_rout_thermal_conductivity_third_order_centering_max_el_wise_3},
  {"cryst_to_cart",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_centering_cryst_to_cart,doc_f2py_rout_thermal_conductivity_third_order_centering_cryst_to_cart},
  {NULL}
};

static void f2py_setup_third_order_centering(char *analysis,char *center,char *center_sparse,char *pre_center,char *assign,char *within_dmax,char *compute_perimeter,char *three_to_one_len,char *three_to_one,char *one_to_three_len,char *one_to_three,char *min_el_wise_2,char *max_el_wise_2,char *min_el_wise_3,char *max_el_wise_3,char *cryst_to_cart) {
  int i_f2py=0;
  f2py_third_order_centering_def[i_f2py++].data = analysis;
  f2py_third_order_centering_def[i_f2py++].data = center;
  f2py_third_order_centering_def[i_f2py++].data = center_sparse;
  f2py_third_order_centering_def[i_f2py++].data = pre_center;
  f2py_third_order_centering_def[i_f2py++].data = assign;
  f2py_third_order_centering_def[i_f2py++].data = within_dmax;
  f2py_third_order_centering_def[i_f2py++].data = compute_perimeter;
  f2py_third_order_centering_def[i_f2py++].data = three_to_one_len;
  f2py_third_order_centering_def[i_f2py++].data = three_to_one;
  f2py_third_order_centering_def[i_f2py++].data = one_to_three_len;
  f2py_third_order_centering_def[i_f2py++].data = one_to_three;
  f2py_third_order_centering_def[i_f2py++].data = min_el_wise_2;
  f2py_third_order_centering_def[i_f2py++].data = max_el_wise_2;
  f2py_third_order_centering_def[i_f2py++].data = min_el_wise_3;
  f2py_third_order_centering_def[i_f2py++].data = max_el_wise_3;
  f2py_third_order_centering_def[i_f2py++].data = cryst_to_cart;
}
extern void F_FUNC_US(f2pyinitthird_order_centering,F2PYINITTHIRD_ORDER_CENTERING)(void (*)(char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *));
static void f2py_init_third_order_centering(void) {
  F_FUNC_US(f2pyinitthird_order_centering,F2PYINITTHIRD_ORDER_CENTERING)(f2py_setup_third_order_centering);
}


static FortranDataDef f2py_third_order_cond_def[] = {
  {"interpol_v2",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_interpol_v2,doc_f2py_rout_thermal_conductivity_third_order_cond_interpol_v2},
  {"interpol_v3",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_interpol_v3,doc_f2py_rout_thermal_conductivity_third_order_cond_interpol_v3},
  {"compute_full_dynamic_bubble_single",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_compute_full_dynamic_bubble_single,doc_f2py_rout_thermal_conductivity_third_order_cond_compute_full_dynamic_bubble_single},
  {"compute_diag_dynamic_bubble_single",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_compute_diag_dynamic_bubble_single,doc_f2py_rout_thermal_conductivity_third_order_cond_compute_diag_dynamic_bubble_single},
  {"compute_perturb_selfnrg_single",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_compute_perturb_selfnrg_single,doc_f2py_rout_thermal_conductivity_third_order_cond_compute_perturb_selfnrg_single},
  {"compute_spectralf_diag_single",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_compute_spectralf_diag_single,doc_f2py_rout_thermal_conductivity_third_order_cond_compute_spectralf_diag_single},
  {"lambda_dynamic_single",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_lambda_dynamic_single,doc_f2py_rout_thermal_conductivity_third_order_cond_lambda_dynamic_single},
  {"lambda_dynamic_value_single",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_lambda_dynamic_value_single,doc_f2py_rout_thermal_conductivity_third_order_cond_lambda_dynamic_value_single},
  {"calculate_spectral_function",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_calculate_spectral_function,doc_f2py_rout_thermal_conductivity_third_order_cond_calculate_spectral_function},
  {"calculate_spectral_function_mode_mixing",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_calculate_spectral_function_mode_mixing,doc_f2py_rout_thermal_conductivity_third_order_cond_calculate_spectral_function_mode_mixing},
  {"calculate_spectral_function_cartesian",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_calculate_spectral_function_cartesian,doc_f2py_rout_thermal_conductivity_third_order_cond_calculate_spectral_function_cartesian},
  {"bose_freq",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_bose_freq,doc_f2py_rout_thermal_conductivity_third_order_cond_bose_freq},
  {"eq_freq",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_eq_freq,doc_f2py_rout_thermal_conductivity_third_order_cond_eq_freq},
  {"f_bose",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_f_bose,doc_f2py_rout_thermal_conductivity_third_order_cond_f_bose},
  {"df_bose",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_df_bose,doc_f2py_rout_thermal_conductivity_third_order_cond_df_bose},
  {"gaussian_function",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_gaussian_function,doc_f2py_rout_thermal_conductivity_third_order_cond_gaussian_function},
  {"eliminate_transl",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_eliminate_transl,doc_f2py_rout_thermal_conductivity_third_order_cond_eliminate_transl},
  {"cinv",-1,{{-1}},0,0,NULL,(void *)f2py_rout_thermal_conductivity_third_order_cond_cinv,doc_f2py_rout_thermal_conductivity_third_order_cond_cinv},
  {NULL}
};

static void f2py_setup_third_order_cond(char *interpol_v2,char *interpol_v3,char *compute_full_dynamic_bubble_single,char *compute_diag_dynamic_bubble_single,char *compute_perturb_selfnrg_single,char *compute_spectralf_diag_single,char *lambda_dynamic_single,char *lambda_dynamic_value_single,char *calculate_spectral_function,char *calculate_spectral_function_mode_mixing,char *calculate_spectral_function_cartesian,char *bose_freq,char *eq_freq,char *f_bose,char *df_bose,char *gaussian_function,char *eliminate_transl,char *cinv) {
  int i_f2py=0;
  f2py_third_order_cond_def[i_f2py++].data = interpol_v2;
  f2py_third_order_cond_def[i_f2py++].data = interpol_v3;
  f2py_third_order_cond_def[i_f2py++].data = compute_full_dynamic_bubble_single;
  f2py_third_order_cond_def[i_f2py++].data = compute_diag_dynamic_bubble_single;
  f2py_third_order_cond_def[i_f2py++].data = compute_perturb_selfnrg_single;
  f2py_third_order_cond_def[i_f2py++].data = compute_spectralf_diag_single;
  f2py_third_order_cond_def[i_f2py++].data = lambda_dynamic_single;
  f2py_third_order_cond_def[i_f2py++].data = lambda_dynamic_value_single;
  f2py_third_order_cond_def[i_f2py++].data = calculate_spectral_function;
  f2py_third_order_cond_def[i_f2py++].data = calculate_spectral_function_mode_mixing;
  f2py_third_order_cond_def[i_f2py++].data = calculate_spectral_function_cartesian;
  f2py_third_order_cond_def[i_f2py++].data = bose_freq;
  f2py_third_order_cond_def[i_f2py++].data = eq_freq;
  f2py_third_order_cond_def[i_f2py++].data = f_bose;
  f2py_third_order_cond_def[i_f2py++].data = df_bose;
  f2py_third_order_cond_def[i_f2py++].data = gaussian_function;
  f2py_third_order_cond_def[i_f2py++].data = eliminate_transl;
  f2py_third_order_cond_def[i_f2py++].data = cinv;
}
extern void F_FUNC_US(f2pyinitthird_order_cond,F2PYINITTHIRD_ORDER_COND)(void (*)(char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *,char *));
static void f2py_init_third_order_cond(void) {
  F_FUNC_US(f2pyinitthird_order_cond,F2PYINITTHIRD_ORDER_COND)(f2py_setup_third_order_cond);
}

/*need_f90modhooks*/

/************** See f2py2e/rules.py: module_rules['modulebody'] **************/

/******************* See f2py2e/common_rules.py: buildhooks *******************/

/*need_commonhooks*/

/**************************** See f2py2e/rules.py ****************************/

static FortranDataDef f2py_routine_defs[] = {

/*eof routine_defs*/
    {NULL}
};

static PyMethodDef f2py_module_methods[] = {

    {NULL,NULL}
};

static struct PyModuleDef moduledef = {
    PyModuleDef_HEAD_INIT,
    "thermal_conductivity",
    NULL,
    -1,
    f2py_module_methods,
    NULL,
    NULL,
    NULL,
    NULL
};

PyMODINIT_FUNC PyInit_thermal_conductivity(void) {
    int i;
    PyObject *m,*d, *s, *tmp;
    m = thermal_conductivity_module = PyModule_Create(&moduledef);
    Py_SET_TYPE(&PyFortran_Type, &PyType_Type);
    import_array();
    if (PyErr_Occurred())
        {PyErr_SetString(PyExc_ImportError, "can't initialize module thermal_conductivity (failed to import numpy)"); return m;}
    d = PyModule_GetDict(m);
    s = PyUnicode_FromString("1.26.4");
    PyDict_SetItemString(d, "__version__", s);
    Py_DECREF(s);
    s = PyUnicode_FromString(
        "This module 'thermal_conductivity' is auto-generated with f2py (version:1.26.4).\nFunctions:\n"
"Fortran 90/95 modules:\n""  get_lf --- calculate_lineshapes(),calculate_lineshapes_mode_mixing(),calculate_lineshapes_cartesian(),calculate_lifetimes_selfconsistently(),solve_selfconsistent_equation(),calculate_correlation_function(),calculate_lifetimes_perturbative(),calculate_lifetimes(),calculate_self_energy_la(),calculate_self_energy_p(),calculate_self_energy_full(),check_if_gamma(),vec_dot_mat(),calculate_real_part_via_kramers_kronig(),calculate_real_part_via_kramers_kronig_2d(),hilbert_transform_via_fft(),ht(),cfft(),inv(),interpolate_fc2()""  scattering_grids --- get_scattering_q_grid(),same_vector(),same_vector_nopbc()""  third_order_centering --- analysis(),center(),center_sparse(),pre_center(),assign(),within_dmax(),compute_perimeter(),three_to_one_len(),three_to_one(),one_to_three_len(),one_to_three(),min_el_wise_2(),max_el_wise_2(),min_el_wise_3(),max_el_wise_3(),cryst_to_cart()""  third_order_cond --- interpol_v2(),interpol_v3(),compute_full_dynamic_bubble_single(),compute_diag_dynamic_bubble_single(),compute_perturb_selfnrg_single(),compute_spectralf_diag_single(),lambda_dynamic_single(),lambda_dynamic_value_single(),calculate_spectral_function(),calculate_spectral_function_mode_mixing(),calculate_spectral_function_cartesian(),bose_freq(),eq_freq(),f_bose(),df_bose(),gaussian_function(),eliminate_transl(),cinv()"".");
    PyDict_SetItemString(d, "__doc__", s);
    Py_DECREF(s);
    s = PyUnicode_FromString("1.26.4");
    PyDict_SetItemString(d, "__f2py_numpy_version__", s);
    Py_DECREF(s);
    thermal_conductivity_error = PyErr_NewException ("thermal_conductivity.error", NULL, NULL);
    /*
     * Store the error object inside the dict, so that it could get deallocated.
     * (in practice, this is a module, so it likely will not and cannot.)
     */
    PyDict_SetItemString(d, "_thermal_conductivity_error", thermal_conductivity_error);
    Py_DECREF(thermal_conductivity_error);
    for(i=0;f2py_routine_defs[i].name!=NULL;i++) {
        tmp = PyFortranObject_NewAsAttr(&f2py_routine_defs[i]);
        PyDict_SetItemString(d, f2py_routine_defs[i].name, tmp);
        Py_DECREF(tmp);
    }

























































/*eof initf2pywraphooks*/
  PyDict_SetItemString(d, "third_order_cond", PyFortranObject_New(f2py_third_order_cond_def,f2py_init_third_order_cond));
  PyDict_SetItemString(d, "third_order_centering", PyFortranObject_New(f2py_third_order_centering_def,f2py_init_third_order_centering));
  PyDict_SetItemString(d, "scattering_grids", PyFortranObject_New(f2py_scattering_grids_def,f2py_init_scattering_grids));
  PyDict_SetItemString(d, "get_lf", PyFortranObject_New(f2py_get_lf_def,f2py_init_get_lf));
/*eof initf90modhooks*/

/*eof initcommonhooks*/


#ifdef F2PY_REPORT_ATEXIT
    if (! PyErr_Occurred())
        on_exit(f2py_report_on_exit,(void*)"thermal_conductivity");
#endif
    return m;
}
#ifdef __cplusplus
}
#endif
